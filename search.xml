<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>WebRTC 开发（三）架构设计剖析</title>
      <link href="/2019/05/04/webrtc-development-3-analysis-of-architectural-design/"/>
      <url>/2019/05/04/webrtc-development-3-analysis-of-architectural-design/</url>
      
        <content type="html"><![CDATA[<a id="more"></a>]]></content>
      
      
      
        <tags>
            
            <tag> 音视频处理 </tag>
            
            <tag> WebRTC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WebRTC 开发（二）源码下载与编译</title>
      <link href="/2019/05/02/webrtc-development-2-source-code-download-and-build/"/>
      <url>/2019/05/02/webrtc-development-2-source-code-download-and-build/</url>
      
        <content type="html"><![CDATA[<p>在使用任何工具之前，我们都有必要对工具做大概地的了解，做到粗犷但不失偏颇，这对我们选用工具和切入点是很关键的。本节的标题虽然是 WebRTC 源码下载与编译，但在这之前，我们有必要大概地了解 WebRTC，比如开发机构、免费性、支持的平台、功能亮点。</p><p>WebRTC 是一个免费开源的跨平台项目，由 Google，Mozilla，Opera 等支持，支持 Chrome，Firefox，Opera 以及 Android 和 iOS 平台，能够给浏览器、手机应用和物联网设备提供了实时互动能力。</p><p>WebRTC 是一组协议和 API。WebRTC 的起源可追溯到 2011年，经过六年多的时间的发展，在 2017年底 WebRTC 1.0 标准正式出炉。通过 WebRTC 的 <a href="https://webrtc.org/release-notes/" target="_blank" rel="noopener">Release Notes</a> 可以看到现在最新的 release 版本是 <a href="https://groups.google.com/forum/#!msg/discuss-webrtc/cXEtXIIYrQs/R7y0yIK2AQAJ" target="_blank" rel="noopener">M74 Release Noted</a>。</p><p>2015年移动端直播的兴起，观众可以在手机端实时看主播的直播，但是观众与主播之间的沟通需要通过发弹幕来进行，这种交流的实时性较差，沟通不便利，观众参与感较差。2016年初移动端上出现了主播与观众之间可以通过实时视频聊天这种方式来沟通，即，视频连麦。那我们想实现这种视频连麦的功能该怎么做呢？</p><p>现在通过 WebRTC 以及其它一些音视频工具，我们就可以搭建一个视频聊天工具，做到视频连麦，也能做到类似于微信视频群聊。关于各种实现视频连麦的方式，这里就不细说了，放到后面的章节来解说。</p><p>了解到 WebRTC 是个什么东西后，通常人的心里就会产生一种跃跃欲试的冲动，想试试，那试试就试试呗。“磨刀不误砍柴工”这句话是有道理的，当我们没有经验和没有人传授经验的时候，那我们就要琢磨这句“磨刀不误砍柴工”了。我们要砍柴做饭，找到一把刀拿起就跑到树林里去砍柴，结果发现刀太钝，砍柴真费劲。这个时候，我们就意识到砍柴刀要用磨刀石磨一磨，磨锋利了，就能提升砍柴的效率。我举这个例子，就想说明两点：</p><a id="more"></a><p>第一，先尝试可以加深理解，获取自己的经验。</p><p>第二，通过获取的经验，重新调整，比如调整做事步骤，加深理论学习等。</p><p>WebRTC 支持 Windows, Mac OS X, Linux, Android 和 iOS 平台，这里以 iOS 平台为例来描述 WebRTC 的源码下载和编译过程。</p><blockquote><h1 id="一、选择-Release-版本"><a href="#一、选择-Release-版本" class="headerlink" title="一、选择 Release 版本"></a>一、选择 Release 版本</h1></blockquote><h2 id="step-1"><a href="#step-1" class="headerlink" title="step 1"></a>step 1</h2><p>从 WebRTC 的 <a href="https://webrtc.org/release-notes/" target="_blank" rel="noopener">Release Notes</a> 的 release 版本中选择最新的版本，当前最新版为 <a href="https://groups.google.com/forum/#!msg/discuss-webrtc/cXEtXIIYrQs/R7y0yIK2AQAJ" target="_blank" rel="noopener">M74 Release Noted</a> </p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">WebRTC M74 Release Notes</span><br><span class="line"></span><br><span class="line">WebRTC M74 branch (cut <span class="keyword">at</span> r26981)</span><br><span class="line"></span><br><span class="line">Summary</span><br><span class="line"></span><br><span class="line">WebRTC M74, currently available <span class="keyword">in</span> Chrome's beta channel <span class="keyword">and</span> <span class="keyword">as</span> native libraries <span class="keyword">for</span> Android <span class="keyword">and</span> iOS, <span class="keyword">contains</span> feature additions like RID/MID based Simulcast, multiple bug fixes, enhancements <span class="keyword">and</span> stability/performance improvements. As <span class="keyword">with</span> previous releases, we encourage all developers <span class="keyword">to</span> <span class="built_in">run</span> versions <span class="keyword">of</span> Chrome <span class="keyword">on</span> <span class="keyword">the</span> Canary, Dev, <span class="keyword">and</span> Beta channels frequently <span class="keyword">and</span> quickly report any issues found. Please take a look <span class="keyword">at</span> this page, <span class="keyword">for</span> <span class="keyword">some</span> pointers <span class="keyword">on</span> how <span class="keyword">to</span> <span class="built_in">file</span> a good bug report. The help we have received has been invaluable! </span><br><span class="line"></span><br><span class="line">The Chrome release schedule can be found here. Native libraries <span class="keyword">for</span> Android <span class="keyword">and</span> iOS are built <span class="keyword">on</span> a weekly basis <span class="keyword">and</span> are available <span class="keyword">on</span> JCenter <span class="keyword">and</span> CocoaPods; <span class="keyword">the</span> Changelog <span class="keyword">is</span> available here.</span><br></pre></td></tr></table></figure><h2 id="step-2"><a href="#step-2" class="headerlink" title="step 2"></a>step 2</h2><p>进入分支 <a href="https://chromium.googlesource.com/external/webrtc/+log/branch-heads/m74" target="_blank" rel="noopener">WebRTC M74 branch</a> (cut at r26981)</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">chromium / external / webrtc / branch-heads/m74</span><br><span class="line"></span><br><span class="line">741f9a0 Ignore duplicate sent packets <span class="keyword">in</span> TransportFeedbackAdapter by Erik Språng · 2 weeks ago</span><br><span class="line"></span><br><span class="line">e6d5f62 Merge <span class="keyword">to</span> M74: Allow setting ALR values <span class="keyword">for</span><span class="built_in"> screen </span>content again by Erik Språng · 4 weeks ago</span><br><span class="line"></span><br><span class="line">9c745ae Revert <span class="string">"Disable DTLS 1.0, TLS 1.0 and TLS 1.1 downgrade in WebRTC."</span> by Benjamin Wright · 5 weeks ago</span><br><span class="line"></span><br><span class="line">1c9bf93 Merge <span class="keyword">to</span> M74: Fix bug <span class="keyword">in</span> vp8 FrameDropThreshold by Erik Språng · 5 weeks ago</span><br><span class="line"></span><br><span class="line"><span class="built_in">..</span>.</span><br></pre></td></tr></table></figure><h2 id="step-3"><a href="#step-3" class="headerlink" title="step 3"></a>step 3</h2><p>选择第一条提交记录 [741f9a0 Ignore duplicate sent packets in TransportFeedbackAdapter by Erik Språng · 2 weeks ago] 进入详情页 <a href="https://chromium.googlesource.com/external/webrtc/+/741f9a0679bc70682b056004f8421879352d1a8d" target="_blank" rel="noopener">chromium / external / webrtc / 741f9a0679bc70682b056004f8421879352d1a8d</a></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">chromium / external / webrtc / 741f9a0679bc70682b056004f8421879352d1a8d</span><br><span class="line"></span><br><span class="line"><span class="keyword">commit</span><span class="number">741</span>f9a0679bc70682b056004f8421879352d1a8d[<span class="keyword">log</span>] [tgz]</span><br><span class="line">authorErik Språng &lt;sprang@webrtc.org&gt;Thu Apr <span class="number">18</span> <span class="number">12</span>:<span class="number">28</span>:<span class="number">02</span> <span class="number">2019</span></span><br><span class="line">committerErik Språng &lt;sprang@webrtc.org&gt;Fri Apr <span class="number">19</span> <span class="number">17</span>:<span class="number">51</span>:<span class="number">34</span> <span class="number">2019</span></span><br><span class="line">tree<span class="number">36</span>ee311fa41a5d60ab98d87273f210ac90ed3fdf</span><br><span class="line"><span class="keyword">parent</span>e6d5f62d010d7f6284504af1c7898894851b238c [diff]</span><br><span class="line"></span><br><span class="line"><span class="keyword">Ignore</span> <span class="keyword">duplicate</span> sent packets <span class="keyword">in</span> TransportFeedbackAdapter</span><br><span class="line"></span><br><span class="line">Bug: webrtc:<span class="number">10564</span>, chromium:<span class="number">954139</span>, webrtc:<span class="number">10509</span></span><br><span class="line"><span class="keyword">Change</span>-<span class="keyword">Id</span>: I617b58ef8cf5858d7a81aaa39884c5cc1ac2af6e</span><br><span class="line">Reviewed-<span class="keyword">on</span>: https://webrtc-review.googlesource.com/c/src/+/<span class="number">133564</span></span><br><span class="line"><span class="keyword">Commit</span>-Queue: Erik Språng &lt;sprang@webrtc.org&gt;</span><br><span class="line">Reviewed-<span class="keyword">by</span>: Sebastian Jansson &lt;srte@webrtc.org&gt;</span><br><span class="line">Cr-Original-<span class="keyword">Commit</span>-<span class="keyword">Position</span>: refs/heads/<span class="keyword">master</span>@&#123;#<span class="number">27689</span>&#125;(cherry picked <span class="keyword">from</span> <span class="keyword">commit</span> d50947ab516ec404b100752617fb828d05cf0e3d)</span><br><span class="line">Reviewed-<span class="keyword">on</span>: https://webrtc-review.googlesource.com/c/src/+/<span class="number">133579</span></span><br><span class="line">Cr-<span class="keyword">Commit</span>-<span class="keyword">Position</span>: refs/branch-heads/m74@&#123;#<span class="number">20</span>&#125;</span><br><span class="line">Cr-Branched-<span class="keyword">From</span>: be7af9399ceb88171bf60b50419ff2dec8184fb9-refs/heads/<span class="keyword">master</span>@&#123;#<span class="number">26981</span>&#125;</span><br><span class="line"></span><br><span class="line">modules/congestion_controller/rtp/BUILD.gn[diff]</span><br><span class="line">modules/congestion_controller/rtp/send_time_history.cc[diff]</span><br><span class="line">modules/congestion_controller/rtp/send_time_history.h[diff]</span><br><span class="line">modules/congestion_controller/rtp/transport_feedback_adapter.cc[diff]</span><br><span class="line">modules/congestion_controller/rtp/transport_feedback_adapter.h[diff]</span><br><span class="line">modules/congestion_controller/rtp/transport_feedback_adapter_unittest.cc[diff]</span><br><span class="line"><span class="number">6</span> files <span class="keyword">changed</span></span><br><span class="line"></span><br><span class="line">tree: <span class="number">36</span>ee311fa41a5d60ab98d87273f210ac90ed3fdf</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>获取到该分支的最新提交记录：<strong>commit    741f9a0679bc70682b056004f8421879352d1a8d</strong>。后面下载源码的时候要用到这个 commit 编号。</p><blockquote><h1 id="二、安装-depot-tools-工具包"><a href="#二、安装-depot-tools-工具包" class="headerlink" title="二、安装 depot_tools 工具包"></a>二、安装 depot_tools 工具包</h1></blockquote><p>下载源码的时候，要用到 depot_tools 工具包，这是 Chromium 官方推荐的工具包，具备下载、同步、编译、上传代码等功能。depot_tools 的详细介绍见 <a href="https://www.chromium.org/developers/how-tos/depottools" target="_blank" rel="noopener">Using depot_tools</a>。depot_tools 包含如下工具包：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">gclient</span><br><span class="line">gcl</span><br><span class="line">git-cl</span><br><span class="line">svn [只在 Windows 上使用]</span><br><span class="line">drover</span><br><span class="line">cpplint.py</span><br><span class="line">pylint</span><br><span class="line">presubmit_support.py</span><br><span class="line">repo</span><br><span class="line">wtf</span><br><span class="line">weekly</span><br><span class="line">git-gs</span><br><span class="line">zsh-goodies</span><br></pre></td></tr></table></figure><h2 id="step-1-1"><a href="#step-1-1" class="headerlink" title="step 1"></a>step 1</h2><p>depot_tools 源码属于 Google 的服务，即墙外资源，在获取 depot_tools 源码前，先需要开启 VPN 服务，然后在终端执行命令</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="keyword">clone</span> <span class="title">https</span>://chromium.googlesource.com/chromium/tools/depot_tools.git</span><br></pre></td></tr></table></figure><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">suntongmiandeMacBook-<span class="string">Pro:</span>~ suntongmian$ cd <span class="regexp">/Users/</span>suntongmian<span class="regexp">/Documents/</span>develop/webrtc </span><br><span class="line">suntongmiandeMacBook-<span class="string">Pro:</span>webrtc suntongmian$</span><br><span class="line">suntongmiandeMacBook-<span class="string">Pro:</span>webrtc suntongmian$ git clone <span class="string">https:</span><span class="comment">//chromium.googlesource.com/chromium/tools/depot_tools.git</span></span><br><span class="line">正克隆到 <span class="string">'depot_tools'</span>...</span><br><span class="line"><span class="string">fatal:</span> unable to access <span class="string">'https://chromium.googlesource.com/chromium/tools/depot_tools.git/'</span>: Failed to connect to chromium.googlesource.com port <span class="number">443</span>: Operation timed out</span><br><span class="line">suntongmiandeMacBook-<span class="string">Pro:</span>webrtc suntongmian$</span><br></pre></td></tr></table></figure><p><strong>出现 “Failed to connect to chromium.googlesource.com port 443: Operation timed out” 问题后，需要检查 VPN 服务是否开启，网络状况是否良好。如果在 VPN 服务开启和网络状况良好的情况下，仍然不能 clone 代码成功，那就需要检查终端能否成功访问墙外的资源。</strong></p><p>我开启了 VPN 服务，网络状况也很好，也能通过 Google 浏览器访问资源，但就是不能 clone depot_tools 源码成功。这个时候，我通过命令 <strong>curl</strong> 来检查终端是否具备翻墙功能。</p><p>首先，在终端执行命令 </p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl www<span class="selector-class">.baidu</span><span class="selector-class">.com</span></span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">suntongmiandeMacBook-Pro:webrtc suntongmian$ curl www.baidu.com</span><br><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="comment">&lt;!--STATUS OK--&gt;</span><span class="tag">&lt;<span class="name">html</span>&gt;</span> <span class="tag">&lt;<span class="name">head</span>&gt;</span><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">content-type</span> <span class="attr">content</span>=<span class="string">text/html;charset</span>=<span class="string">utf-8</span>&gt;</span><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">X-UA-Compatible</span> <span class="attr">content</span>=<span class="string">IE</span>=<span class="string">Edge</span>&gt;</span><span class="tag">&lt;<span class="name">meta</span> <span class="attr">content</span>=<span class="string">always</span> <span class="attr">name</span>=<span class="string">referrer</span>&gt;</span><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">stylesheet</span> <span class="attr">type</span>=<span class="string">text/css</span> <span class="attr">href</span>=<span class="string">http://s1.bdstatic.com/r/www/cache/bdorz/baidu.min.css</span>&gt;</span><span class="tag">&lt;<span class="name">title</span>&gt;</span>百度一下，你就知道<span class="tag">&lt;/<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">head</span>&gt;</span> <span class="tag">&lt;<span class="name">body</span> <span class="attr">link</span>=<span class="string">#0000cc</span>&gt;</span> <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">wrapper</span>&gt;</span> <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">head</span>&gt;</span> <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">head_wrapper</span>&gt;</span> <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">s_form</span>&gt;</span> <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">s_form_wrapper</span>&gt;</span> <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">lg</span>&gt;</span> <span class="tag">&lt;<span class="name">img</span> <span class="attr">hidefocus</span>=<span class="string">true</span> <span class="attr">src</span>=<span class="string">//www.baidu.com/img/bd_logo1.png</span> <span class="attr">width</span>=<span class="string">270</span> <span class="attr">height</span>=<span class="string">129</span>&gt;</span> <span class="tag">&lt;/<span class="name">div</span>&gt;</span> <span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">form</span> <span class="attr">name</span>=<span class="string">f</span> <span class="attr">action</span>=<span class="string">//www.baidu.com/s</span> <span class="attr">class</span>=<span class="string">fm</span>&gt;</span> <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">hidden</span> <span class="attr">name</span>=<span class="string">bdorz_come</span> <span class="attr">value</span>=<span class="string">1</span>&gt;</span> <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">hidden</span> <span class="attr">name</span>=<span class="string">ie</span> <span class="attr">value</span>=<span class="string">utf-8</span>&gt;</span> <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">hidden</span> <span class="attr">name</span>=<span class="string">f</span> <span class="attr">value</span>=<span class="string">8</span>&gt;</span> <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">hidden</span> <span class="attr">name</span>=<span class="string">rsv_bp</span> <span class="attr">value</span>=<span class="string">1</span>&gt;</span> <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">hidden</span> <span class="attr">name</span>=<span class="string">rsv_idx</span> <span class="attr">value</span>=<span class="string">1</span>&gt;</span> <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">hidden</span> <span class="attr">name</span>=<span class="string">tn</span> <span class="attr">value</span>=<span class="string">baidu</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"bg s_ipt_wr"</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">kw</span> <span class="attr">name</span>=<span class="string">wd</span> <span class="attr">class</span>=<span class="string">s_ipt</span> <span class="attr">value</span> <span class="attr">maxlength</span>=<span class="string">255</span> <span class="attr">autocomplete</span>=<span class="string">off</span> <span class="attr">autofocus</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"bg s_btn_wr"</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">submit</span> <span class="attr">id</span>=<span class="string">su</span> <span class="attr">value</span>=<span class="string">百度一下</span> <span class="attr">class</span>=<span class="string">"bg s_btn"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;/<span class="name">form</span>&gt;</span> <span class="tag">&lt;/<span class="name">div</span>&gt;</span> <span class="tag">&lt;/<span class="name">div</span>&gt;</span> <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">u1</span>&gt;</span> <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">http://news.baidu.com</span> <span class="attr">name</span>=<span class="string">tj_trnews</span> <span class="attr">class</span>=<span class="string">mnav</span>&gt;</span>新闻<span class="tag">&lt;/<span class="name">a</span>&gt;</span> <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">http://www.hao123.com</span> <span class="attr">name</span>=<span class="string">tj_trhao123</span> <span class="attr">class</span>=<span class="string">mnav</span>&gt;</span>hao123<span class="tag">&lt;/<span class="name">a</span>&gt;</span> <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">http://map.baidu.com</span> <span class="attr">name</span>=<span class="string">tj_trmap</span> <span class="attr">class</span>=<span class="string">mnav</span>&gt;</span>地图<span class="tag">&lt;/<span class="name">a</span>&gt;</span> <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">http://v.baidu.com</span> <span class="attr">name</span>=<span class="string">tj_trvideo</span> <span class="attr">class</span>=<span class="string">mnav</span>&gt;</span>视频<span class="tag">&lt;/<span class="name">a</span>&gt;</span> <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">http://tieba.baidu.com</span> <span class="attr">name</span>=<span class="string">tj_trtieba</span> <span class="attr">class</span>=<span class="string">mnav</span>&gt;</span>贴吧<span class="tag">&lt;/<span class="name">a</span>&gt;</span> <span class="tag">&lt;<span class="name">noscript</span>&gt;</span> <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">http://www.baidu.com/bdorz/login.gif?login&amp;amp;tpl</span>=<span class="string">mn&amp;amp;u</span>=<span class="string">http%3A%2F%2Fwww.baidu.com%2f%3fbdorz_come%3d1</span> <span class="attr">name</span>=<span class="string">tj_login</span> <span class="attr">class</span>=<span class="string">lb</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">a</span>&gt;</span> <span class="tag">&lt;/<span class="name">noscript</span>&gt;</span> <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"><span class="built_in">document</span>.write(<span class="string">'&lt;a href="http://www.baidu.com/bdorz/login.gif?login&amp;tpl=mn&amp;u='</span>+ <span class="built_in">encodeURIComponent</span>(<span class="built_in">window</span>.location.href+ (<span class="built_in">window</span>.location.search === <span class="string">""</span> ? <span class="string">"?"</span> : <span class="string">"&amp;"</span>)+ <span class="string">"bdorz_come=1"</span>)+ <span class="string">'" name="tj_login" class="lb"&gt;登录&lt;/a&gt;'</span>);</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span> <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">//www.baidu.com/more/</span> <span class="attr">name</span>=<span class="string">tj_briicon</span> <span class="attr">class</span>=<span class="string">bri</span> <span class="attr">style</span>=<span class="string">"display: block;"</span>&gt;</span>更多产品<span class="tag">&lt;/<span class="name">a</span>&gt;</span> <span class="tag">&lt;/<span class="name">div</span>&gt;</span> <span class="tag">&lt;/<span class="name">div</span>&gt;</span> <span class="tag">&lt;/<span class="name">div</span>&gt;</span> <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">ftCon</span>&gt;</span> <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">ftConw</span>&gt;</span> <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">lh</span>&gt;</span> <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">http://home.baidu.com</span>&gt;</span>关于百度<span class="tag">&lt;/<span class="name">a</span>&gt;</span> <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">http://ir.baidu.com</span>&gt;</span>About Baidu<span class="tag">&lt;/<span class="name">a</span>&gt;</span> <span class="tag">&lt;/<span class="name">p</span>&gt;</span> <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">cp</span>&gt;</span>&amp;copy;2017&amp;nbsp;Baidu&amp;nbsp;<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">http://www.baidu.com/duty/</span>&gt;</span>使用百度前必读<span class="tag">&lt;/<span class="name">a</span>&gt;</span>&amp;nbsp; <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">http://jianyi.baidu.com/</span> <span class="attr">class</span>=<span class="string">cp-feedback</span>&gt;</span>意见反馈<span class="tag">&lt;/<span class="name">a</span>&gt;</span>&amp;nbsp;京ICP证030173号&amp;nbsp; <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">//www.baidu.com/img/gs.gif</span>&gt;</span> <span class="tag">&lt;/<span class="name">p</span>&gt;</span> <span class="tag">&lt;/<span class="name">div</span>&gt;</span> <span class="tag">&lt;/<span class="name">div</span>&gt;</span> <span class="tag">&lt;/<span class="name">div</span>&gt;</span> <span class="tag">&lt;/<span class="name">body</span>&gt;</span> <span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line">suntongmiandeMacBook-Pro:webrtc suntongmian$</span><br></pre></td></tr></table></figure><p>可以看到，能很快获取到 <a href="http://www.baidu.com" target="_blank" rel="noopener">www.baidu.com</a> 的资源。说明网络是正常的。</p><p>其次，在终端执行命令</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl www<span class="selector-class">.google</span><span class="selector-class">.com</span></span><br></pre></td></tr></table></figure><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">suntongmiandeMacBook-Pro:webrtc suntongmian$ curl www.google.com</span><br><span class="line">curl: (7) Failed <span class="keyword">to</span> connect <span class="keyword">to</span> www.google.com<span class="built_in"> port </span>80: Operation timed out</span><br><span class="line">suntongmiandeMacBook-Pro:webrtc suntongmian$</span><br></pre></td></tr></table></figure><p>可以看到，出现了请求超时的问题。说明通过终端不能访问 Google 服务。那该怎么解决呢？</p><p>我的 MacBook 电脑上使用了 ShadowsocksX 客户端来启动 VPN 服务，但只支持浏览器能使用 VPN 服务。我参考了 <a href="https://blog.csdn.net/jiajiayouba/article/details/81453398" target="_blank" rel="noopener">MAC 终端走代理服务器</a> 一文中提到的方法来解决这个问题。</p><p>我的 ShadowsocksX 客户端中 Socks5 配置信息如下</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">本地Socks5监听地址：<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span></span><br><span class="line">本地Socks5监听端口：<span class="number">10808</span></span><br><span class="line">连接超时：<span class="number">60</span></span><br></pre></td></tr></table></figure><p>通过 Socks5 的配置信息，在终端中执行命令</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="builtin-name">export</span> <span class="attribute">http_proxy</span>=socks5://127.0.0.1:10808</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">https_proxy</span>=socks5://127.0.0.1:10808</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">all_proxy</span>=socks5://127.0.0.1:10808</span><br></pre></td></tr></table></figure><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">suntongmiandeMacBook-<span class="string">Pro:</span>webrtc suntongmian$ export http_proxy=<span class="string">socks5:</span><span class="comment">//127.0.0.1:10808</span></span><br><span class="line">suntongmiandeMacBook-<span class="string">Pro:</span>webrtc suntongmian$ </span><br><span class="line">suntongmiandeMacBook-<span class="string">Pro:</span>webrtc suntongmian$ export https_proxy=<span class="string">socks5:</span><span class="comment">//127.0.0.1:10808</span></span><br><span class="line">suntongmiandeMacBook-<span class="string">Pro:</span>webrtc suntongmian$ </span><br><span class="line">suntongmiandeMacBook-<span class="string">Pro:</span>~ suntongmian$ export all_proxy=<span class="string">socks5:</span><span class="comment">//127.0.0.1:10808</span></span><br><span class="line">suntongmiandeMacBook-<span class="string">Pro:</span>~ suntongmian$</span><br></pre></td></tr></table></figure><p><strong>提示：执行后，只对当前终端起作用。重启终端后，默认失效。</strong></p><p>启动了终端代理，然后再次执行命令</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl www<span class="selector-class">.google</span><span class="selector-class">.com</span></span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">suntongmiandeMacBook-Pro:webrtc suntongmian$ curl www.google.com</span><br><span class="line"><span class="meta">&lt;!doctype html&gt;</span><span class="tag">&lt;<span class="name">html</span> <span class="attr">itemscope</span>=<span class="string">""</span> <span class="attr">itemtype</span>=<span class="string">"http://schema.org/WebPage"</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span><span class="tag">&lt;<span class="name">head</span>&gt;</span><span class="tag">&lt;<span class="name">meta</span> <span class="attr">content</span>=<span class="string">"Search the world's information, including webpages, images, videos and more. Google has many special features to help you find exactly what you're looking for."</span> <span class="attr">name</span>=<span class="string">"description"</span>&gt;</span><span class="tag">&lt;<span class="name">meta</span> <span class="attr">content</span>=<span class="string">"noodp"</span> <span class="attr">name</span>=<span class="string">"robots"</span>&gt;</span><span class="tag">&lt;<span class="name">meta</span> <span class="attr">content</span>=<span class="string">"text/html; charset=UTF-8"</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span>&gt;</span><span class="tag">&lt;<span class="name">meta</span> <span class="attr">content</span>=<span class="string">"/logos/doodles/2019/us-teacher-appreciation-week-2019-begins-4994791740801024-l.png"</span> <span class="attr">itemprop</span>=<span class="string">"image"</span>&gt;</span><span class="tag">&lt;<span class="name">meta</span> <span class="attr">content</span>=<span class="string">"Happy US Teacher Appreciation Week 2019!"</span> <span class="attr">property</span>=<span class="string">"twitter:title"</span>&gt;</span><span class="tag">&lt;<span class="name">meta</span> <span class="attr">content</span>=<span class="string">"Happy US Teacher Appreciation Week 2019! #GoogleDoodle"</span> <span class="attr">property</span>=<span class="string">"twitter:description"</span>&gt;</span><span class="tag">&lt;<span class="name">meta</span> <span class="attr">content</span>=<span class="string">"Happy US Teacher Appreciation Week 2019! #GoogleDoodle"</span> <span class="attr">property</span>=<span class="string">"og:description"</span>&gt;</span><span class="tag">&lt;<span class="name">meta</span> <span class="attr">content</span>=<span class="string">"summary_large_image"</span> <span class="attr">property</span>=<span class="string">"twitter:card"</span>&gt;</span><span class="tag">&lt;<span class="name">meta</span> <span class="attr">content</span>=<span class="string">"@GoogleDoodles"</span> <span class="attr">property</span>=<span class="string">"twitter:site"</span>&gt;</span><span class="tag">&lt;<span class="name">meta</span> <span class="attr">content</span>=<span class="string">"https://www.google.com/logos/doodles/2019/us-teacher-appreciation-week-2019-begins-4994791740801024-2x.jpg"</span> <span class="attr">property</span>=<span class="string">"twitter:image"</span>&gt;</span><span class="tag">&lt;<span class="name">meta</span> <span class="attr">content</span>=<span class="string">"https://www.google.com/logos/doodles/2019/us-teacher-appreciation-week-2019-begins-4994791740801024-2x.jpg"</span> <span class="attr">property</span>=<span class="string">"og:image"</span>&gt;</span><span class="tag">&lt;<span class="name">meta</span> <span class="attr">content</span>=<span class="string">"782"</span> <span class="attr">property</span>=<span class="string">"og:image:width"</span>&gt;</span><span class="tag">&lt;<span class="name">meta</span> <span class="attr">content</span>=<span class="string">"400"</span> <span class="attr">property</span>=<span class="string">"og:image:height"</span>&gt;</span><span class="tag">&lt;<span class="name">title</span>&gt;</span>Google<span class="tag">&lt;/<span class="name">title</span>&gt;</span><span class="tag">&lt;<span class="name">script</span> <span class="attr">nonce</span>=<span class="string">"1cF5wiybAk0ZW7RYxuJPNw=="</span>&gt;</span><span class="javascript">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="built_in">window</span>.google=&#123;<span class="attr">kEI</span>:<span class="string">'NETQXJuTBIqw0wLW9pvwDA'</span>,<span class="attr">kEXPI</span>:<span class="string">'0,1353747,57,1958,2422,697,528,591,139,224,756,819,1258,1893,57,528,144,206,441,226,138,17,482,2332972,322,329193,1294,12383,4855,32691,15248,867,12163,6381,854,2481,2,2,6801,364,3319,1263,4242,224,2209,269,4203,904,575,835,284,2,578,728,2432,58,2,1,3,1297,4323,3700,1267,774,2248,1409,3337,1146,5,2,2,1745,218,2595,3601,669,1050,1808,1397,81,7,1,2,488,620,29,1395,978,2632,5299,1288,2,622,3385,796,1221,37,622,298,753,120,1217,1364,1611,2736,1558,1503,2,631,2562,2,4,2,461,209,46,1764,1979,403,510,125,1594,1013,12,620,2228,655,19,91,228,1593,389,866,326,197,777,1,2,151,215,1017,300,608,97,756,98,392,29,400,992,1107,10,168,9,84,24,187,831,235,78,365,367,450,174,563,167,237,48,553,11,14,10,573,1089,856,37,5,394,141,5,371,10,25,177,130,193,5,55,1110,87,67,89,385,155,144,324,165,28,532,277,93,86,84,103,24,160,68,39,18,21,18,326,276,1226,84,143,291,39,11,59,15,10,112,226,415,183,23,713,213,152,123,105,433,526,1,3,7,7,1,2,185,565,394,11,4,236,97,23,490,646,639,57,45,55,23,22,293,370,327,39,19,163,359,35,82,62,6,452,886,74,337,5937571,2920,5997516,40,2799864,4,1572,549,333,444,1,2,80,1,900,583,1,312,1,8,1,2,2132,1,1,1,1,1,414,1,748,141,59,726,3,7,563,1,1907,6,3,11,84,4,8,8,2,4,4,22,22305075'</span>,<span class="attr">authuser</span>:<span class="number">0</span>,<span class="attr">kscs</span>:<span class="string">'c9c918f0_NETQXJuTBIqw0wLW9pvwDA'</span>,<span class="attr">kGL</span>:<span class="string">'US'</span>&#125;;google.sn=<span class="string">'webhp'</span>;google.kHL=<span class="string">'en'</span>;&#125;)();(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;google.lc=[];google.li=<span class="number">0</span>;google.getEI=<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b;a&amp;&amp;(!a.getAttribute||!(b=a.getAttribute(<span class="string">"eid"</span>)));)a=a.parentNode;<span class="keyword">return</span> b||google.kEI&#125;;google.getLEI=<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="literal">null</span>;a&amp;&amp;(!a.getAttribute||!(b=a.getAttribute(<span class="string">"leid"</span>)));)a=a.parentNode;<span class="keyword">return</span> b&#125;;google.https=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span><span class="string">"https:"</span>==<span class="built_in">window</span>.location.protocol&#125;;google.ml=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="literal">null</span>&#125;;google.time=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span>(<span class="keyword">new</span> <span class="built_in">Date</span>).getTime()&#125;;google.log=<span class="function"><span class="keyword">function</span>(<span class="params">a,b,e,c,g</span>)</span>&#123;<span class="keyword">if</span>(a=google.logUrl(a,b,e,c,g))&#123;b=<span class="keyword">new</span> Image;<span class="keyword">var</span> d=google.lc,f=google.li;d[f]=b;b.onerror=b.onload=b.onabort=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">delete</span> d[f]&#125;;google.vel&amp;&amp;google.vel.lu&amp;&amp;google.vel.lu(a);b.src=a;google.li=f+<span class="number">1</span>&#125;&#125;;google.logUrl=<span class="function"><span class="keyword">function</span>(<span class="params">a,b,e,c,g</span>)</span>&#123;<span class="keyword">var</span> d=<span class="string">""</span>,f=google.ls||<span class="string">""</span>;e||<span class="number">-1</span>!=b.search(<span class="string">"&amp;ei="</span>)||(d=<span class="string">"&amp;ei="</span>+google.getEI(c),<span class="number">-1</span>==b.search(<span class="string">"&amp;lei="</span>)&amp;&amp;(c=google.getLEI(c))&amp;&amp;(d+=<span class="string">"&amp;lei="</span>+c));c=<span class="string">""</span>;!e&amp;&amp;google.cshid&amp;&amp;<span class="number">-1</span>==b.search(<span class="string">"&amp;cshid="</span>)&amp;&amp;<span class="string">"slh"</span>!=a&amp;&amp;(c=<span class="string">"&amp;cshid="</span>+google.cshid);a=e||<span class="string">"/"</span>+(g||<span class="string">"gen_204"</span>)+<span class="string">"?atyp=i&amp;ct="</span>+a+<span class="string">"&amp;cad="</span>+b+d+f+<span class="string">"&amp;zx="</span>+google.time()+c;<span class="regexp">/^http:/i</span>.test(a)&amp;&amp;google.https()&amp;&amp;(google.ml(<span class="built_in">Error</span>(<span class="string">"a"</span>),!<span class="number">1</span>,&#123;<span class="attr">src</span>:a,<span class="attr">glmm</span>:<span class="number">1</span>&#125;),a=<span class="string">""</span>);<span class="keyword">return</span> a&#125;;&#125;).call(<span class="keyword">this</span>);(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;google.y=&#123;&#125;;google.x=<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">if</span>(a)<span class="keyword">var</span> c=a.id;<span class="keyword">else</span>&#123;<span class="keyword">do</span> c=<span class="built_in">Math</span>.random();<span class="keyword">while</span>(google.y[c])&#125;google.y[c]=[a,b];<span class="keyword">return</span>!<span class="number">1</span>&#125;;google.lm=[];google.plm=<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;google.lm.push.apply(google.lm,a)&#125;;google.lq=[];google.load=<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;google.lq.push([[a],b,c])&#125;;google.loadAll=<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;google.lq.push([a,b])&#125;;&#125;).call(<span class="keyword">this</span>);google.f=&#123;&#125;;<span class="keyword">var</span> a=<span class="built_in">window</span>.location,b=a.href.indexOf(<span class="string">"#"</span>);<span class="keyword">if</span>(<span class="number">0</span>&lt;=b)&#123;<span class="keyword">var</span> c=a.href.substring(b+<span class="number">1</span>);<span class="regexp">/(^|&amp;)q=/</span>.test(c)&amp;&amp;<span class="number">-1</span>==c.indexOf(<span class="string">"#"</span>)&amp;&amp;a.replace(<span class="string">"/search?"</span>+c.replace(<span class="regexp">/(^|&amp;)fp=[^&amp;]*/g</span>,<span class="string">""</span>)+<span class="string">"&amp;cad=h"</span>)&#125;;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"><span class="selector-id">#gbar</span>,<span class="selector-id">#guser</span>&#123;<span class="attribute">font-size</span>:<span class="number">13px</span>;<span class="attribute">padding-top</span>:<span class="number">1px</span> <span class="meta">!important</span>;&#125;<span class="selector-id">#gbar</span>&#123;<span class="attribute">height</span>:<span class="number">22px</span>&#125;<span class="selector-id">#guser</span>&#123;<span class="attribute">padding-bottom</span>:<span class="number">7px</span> <span class="meta">!important</span>;<span class="attribute">text-align</span>:right&#125;<span class="selector-class">.gbh</span>,<span class="selector-class">.gbd</span>&#123;<span class="attribute">border-top</span>:<span class="number">1px</span> solid <span class="number">#c9d7f1</span>;<span class="attribute">font-size</span>:<span class="number">1px</span>&#125;<span class="selector-class">.gbh</span>&#123;<span class="attribute">height</span>:<span class="number">0</span>;<span class="attribute">position</span>:absolute;<span class="attribute">top</span>:<span class="number">24px</span>;<span class="attribute">width</span>:<span class="number">100%</span>&#125;@<span class="keyword">media</span> all&#123;<span class="selector-class">.gb1</span>&#123;<span class="attribute">height</span>:<span class="number">22px</span>;<span class="attribute">margin-right</span>:.<span class="number">5em</span>;<span class="attribute">vertical-align</span>:top&#125;<span class="selector-id">#gbar</span>&#123;<span class="attribute">float</span>:left&#125;&#125;<span class="selector-tag">a</span><span class="selector-class">.gb1</span>,<span class="selector-tag">a</span><span class="selector-class">.gb4</span>&#123;<span class="attribute">text-decoration</span>:underline <span class="meta">!important</span>&#125;<span class="selector-tag">a</span><span class="selector-class">.gb1</span>,<span class="selector-tag">a</span><span class="selector-class">.gb4</span>&#123;<span class="attribute">color</span>:<span class="number">#00c</span> <span class="meta">!important</span>&#125;<span class="selector-class">.gbi</span> <span class="selector-class">.gb4</span>&#123;<span class="attribute">color</span>:<span class="number">#dd8e27</span> <span class="meta">!important</span>&#125;<span class="selector-class">.gbf</span> <span class="selector-class">.gb4</span>&#123;<span class="attribute">color</span>:<span class="number">#900</span> <span class="meta">!important</span>&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"><span class="selector-tag">body</span>,<span class="selector-tag">td</span>,<span class="selector-tag">a</span>,<span class="selector-tag">p</span>,<span class="selector-class">.h</span>&#123;<span class="attribute">font-family</span>:arial,sans-serif&#125;<span class="selector-tag">body</span>&#123;<span class="attribute">margin</span>:<span class="number">0</span>;<span class="attribute">overflow-y</span>:scroll&#125;<span class="selector-id">#gog</span>&#123;<span class="attribute">padding</span>:<span class="number">3px</span> <span class="number">8px</span> <span class="number">0</span>&#125;<span class="selector-tag">td</span>&#123;<span class="attribute">line-height</span>:.<span class="number">8em</span>&#125;<span class="selector-class">.gac_m</span> <span class="selector-tag">td</span>&#123;<span class="attribute">line-height</span>:<span class="number">17px</span>&#125;<span class="selector-tag">form</span>&#123;<span class="attribute">margin-bottom</span>:<span class="number">20px</span>&#125;<span class="selector-class">.h</span>&#123;<span class="attribute">color</span>:<span class="number">#36c</span>&#125;<span class="selector-class">.q</span>&#123;<span class="attribute">color</span>:<span class="number">#00c</span>&#125;<span class="selector-class">.ts</span> <span class="selector-tag">td</span>&#123;<span class="attribute">padding</span>:<span class="number">0</span>&#125;<span class="selector-class">.ts</span>&#123;<span class="attribute">border-collapse</span>:collapse&#125;<span class="selector-tag">em</span>&#123;<span class="attribute">font-weight</span>:bold;<span class="attribute">font-style</span>:normal&#125;<span class="selector-class">.lst</span>&#123;<span class="attribute">height</span>:<span class="number">25px</span>;<span class="attribute">width</span>:<span class="number">496px</span>&#125;<span class="selector-class">.gsfi</span>,<span class="selector-class">.lst</span>&#123;<span class="attribute">font</span>:<span class="number">18px</span> arial,sans-serif&#125;<span class="selector-class">.gsfs</span>&#123;<span class="attribute">font</span>:<span class="number">17px</span> arial,sans-serif&#125;<span class="selector-class">.ds</span>&#123;<span class="attribute">display</span>:inline-box;<span class="attribute">display</span>:inline-block;<span class="attribute">margin</span>:<span class="number">3px</span> <span class="number">0</span> <span class="number">4px</span>;<span class="attribute">margin-left</span>:<span class="number">4px</span>&#125;<span class="selector-tag">input</span>&#123;<span class="attribute">font-family</span>:inherit&#125;<span class="selector-tag">a</span><span class="selector-class">.gb1</span>,<span class="selector-tag">a</span><span class="selector-class">.gb2</span>,<span class="selector-tag">a</span><span class="selector-class">.gb3</span>,<span class="selector-tag">a</span><span class="selector-class">.gb4</span>&#123;<span class="attribute">color</span>:<span class="number">#11c</span> <span class="meta">!important</span>&#125;<span class="selector-tag">body</span>&#123;<span class="attribute">background</span>:<span class="number">#fff</span>;<span class="attribute">color</span>:black&#125;<span class="selector-tag">a</span>&#123;<span class="attribute">color</span>:<span class="number">#11c</span>;<span class="attribute">text-decoration</span>:none&#125;<span class="selector-tag">a</span><span class="selector-pseudo">:hover</span>,<span class="selector-tag">a</span><span class="selector-pseudo">:active</span>&#123;<span class="attribute">text-decoration</span>:underline&#125;<span class="selector-class">.fl</span> <span class="selector-tag">a</span>&#123;<span class="attribute">color</span>:<span class="number">#36c</span>&#125;<span class="selector-tag">a</span><span class="selector-pseudo">:visited</span>&#123;<span class="attribute">color</span>:<span class="number">#551a8b</span>&#125;<span class="selector-tag">a</span><span class="selector-class">.gb1</span>,<span class="selector-tag">a</span><span class="selector-class">.gb4</span>&#123;<span class="attribute">text-decoration</span>:underline&#125;<span class="selector-tag">a</span><span class="selector-class">.gb3</span><span class="selector-pseudo">:hover</span>&#123;<span class="attribute">text-decoration</span>:none&#125;<span class="selector-id">#ghead</span> <span class="selector-tag">a</span><span class="selector-class">.gb2</span><span class="selector-pseudo">:hover</span>&#123;<span class="attribute">color</span>:<span class="number">#fff</span> <span class="meta">!important</span>&#125;<span class="selector-class">.sblc</span>&#123;<span class="attribute">padding-top</span>:<span class="number">5px</span>&#125;<span class="selector-class">.sblc</span> <span class="selector-tag">a</span>&#123;<span class="attribute">display</span>:block;<span class="attribute">margin</span>:<span class="number">2px</span> <span class="number">0</span>;<span class="attribute">margin-left</span>:<span class="number">13px</span>;<span class="attribute">font-size</span>:<span class="number">11px</span>&#125;<span class="selector-class">.lsbb</span>&#123;<span class="attribute">background</span>:<span class="number">#eee</span>;<span class="attribute">border</span>:solid <span class="number">1px</span>;<span class="attribute">border-color</span>:<span class="number">#ccc</span> <span class="number">#999</span> <span class="number">#999</span> <span class="number">#ccc</span>;<span class="attribute">height</span>:<span class="number">30px</span>&#125;<span class="selector-class">.lsbb</span>&#123;<span class="attribute">display</span>:block&#125;<span class="selector-class">.ftl</span>,<span class="selector-id">#fll</span> <span class="selector-tag">a</span>&#123;<span class="attribute">display</span>:inline-block;<span class="attribute">margin</span>:<span class="number">0</span> <span class="number">12px</span>&#125;<span class="selector-class">.lsb</span>&#123;<span class="attribute">background</span>:<span class="built_in">url</span>(/images/nav_logo229.png) <span class="number">0</span> -<span class="number">261px</span> repeat-x;<span class="attribute">border</span>:none;<span class="attribute">color</span>:<span class="number">#000</span>;<span class="attribute">cursor</span>:pointer;<span class="attribute">height</span>:<span class="number">30px</span>;<span class="attribute">margin</span>:<span class="number">0</span>;<span class="attribute">outline</span>:<span class="number">0</span>;<span class="attribute">font</span>:<span class="number">15px</span> arial,sans-serif;<span class="attribute">vertical-align</span>:top&#125;<span class="selector-class">.lsb</span><span class="selector-pseudo">:active</span>&#123;<span class="attribute">background</span>:<span class="number">#ccc</span>&#125;<span class="selector-class">.lst</span><span class="selector-pseudo">:focus</span>&#123;<span class="attribute">outline</span>:none&#125;</span><span class="tag">&lt;/<span class="name">style</span>&gt;</span><span class="tag">&lt;<span class="name">script</span> <span class="attr">nonce</span>=<span class="string">"1cF5wiybAk0ZW7RYxuJPNw=="</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span><span class="tag">&lt;/<span class="name">head</span>&gt;</span><span class="tag">&lt;<span class="name">body</span> <span class="attr">bgcolor</span>=<span class="string">"#fff"</span>&gt;</span><span class="tag">&lt;<span class="name">script</span> <span class="attr">nonce</span>=<span class="string">"1cF5wiybAk0ZW7RYxuJPNw=="</span>&gt;</span><span class="javascript">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> src=<span class="string">'/images/nav_logo229.png'</span>;<span class="keyword">var</span> iesg=<span class="literal">false</span>;<span class="built_in">document</span>.body.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="built_in">window</span>.n &amp;&amp; <span class="built_in">window</span>.n();<span class="keyword">if</span> (<span class="built_in">document</span>.images)&#123;<span class="keyword">new</span> Image().src=src;&#125;</span></span><br><span class="line"><span class="javascript"><span class="keyword">if</span> (!iesg)&#123;<span class="built_in">document</span>.f&amp;&amp;<span class="built_in">document</span>.f.q.focus();<span class="built_in">document</span>.gbqf&amp;&amp;<span class="built_in">document</span>.gbqf.q.focus();&#125;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined">&#125;)();</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"mngb"</span>&gt;</span> <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">gbar</span>&gt;</span><span class="tag">&lt;<span class="name">nobr</span>&gt;</span><span class="tag">&lt;<span class="name">b</span> <span class="attr">class</span>=<span class="string">gb1</span>&gt;</span>Search<span class="tag">&lt;/<span class="name">b</span>&gt;</span> <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">gb1</span> <span class="attr">href</span>=<span class="string">"http://www.google.com/imghp?hl=en&amp;tab=wi"</span>&gt;</span>Images<span class="tag">&lt;/<span class="name">a</span>&gt;</span> <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">gb1</span> <span class="attr">href</span>=<span class="string">"http://maps.google.com/maps?hl=en&amp;tab=wl"</span>&gt;</span>Maps<span class="tag">&lt;/<span class="name">a</span>&gt;</span> <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">gb1</span> <span class="attr">href</span>=<span class="string">"https://play.google.com/?hl=en&amp;tab=w8"</span>&gt;</span>Play<span class="tag">&lt;/<span class="name">a</span>&gt;</span> <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">gb1</span> <span class="attr">href</span>=<span class="string">"http://www.youtube.com/?gl=US&amp;tab=w1"</span>&gt;</span>YouTube<span class="tag">&lt;/<span class="name">a</span>&gt;</span> <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">gb1</span> <span class="attr">href</span>=<span class="string">"http://news.google.com/nwshp?hl=en&amp;tab=wn"</span>&gt;</span>News<span class="tag">&lt;/<span class="name">a</span>&gt;</span> <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">gb1</span> <span class="attr">href</span>=<span class="string">"https://mail.google.com/mail/?tab=wm"</span>&gt;</span>Gmail<span class="tag">&lt;/<span class="name">a</span>&gt;</span> <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">gb1</span> <span class="attr">href</span>=<span class="string">"https://drive.google.com/?tab=wo"</span>&gt;</span>Drive<span class="tag">&lt;/<span class="name">a</span>&gt;</span> <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">gb1</span> <span class="attr">style</span>=<span class="string">"text-decoration:none"</span> <span class="attr">href</span>=<span class="string">"https://www.google.com/intl/en/about/products?tab=wh"</span>&gt;</span><span class="tag">&lt;<span class="name">u</span>&gt;</span>More<span class="tag">&lt;/<span class="name">u</span>&gt;</span> &amp;raquo;<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">nobr</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">guser</span> <span class="attr">width</span>=<span class="string">100%</span>&gt;</span><span class="tag">&lt;<span class="name">nobr</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">gbn</span> <span class="attr">class</span>=<span class="string">gbi</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">gbf</span> <span class="attr">class</span>=<span class="string">gbf</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">gbe</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"http://www.google.com/history/optout?hl=en"</span> <span class="attr">class</span>=<span class="string">gb4</span>&gt;</span>Web History<span class="tag">&lt;/<span class="name">a</span>&gt;</span> | <span class="tag">&lt;<span class="name">a</span>  <span class="attr">href</span>=<span class="string">"/preferences?hl=en"</span> <span class="attr">class</span>=<span class="string">gb4</span>&gt;</span>Settings<span class="tag">&lt;/<span class="name">a</span>&gt;</span> | <span class="tag">&lt;<span class="name">a</span> <span class="attr">target</span>=<span class="string">_top</span> <span class="attr">id</span>=<span class="string">gb_70</span> <span class="attr">href</span>=<span class="string">"https://accounts.google.com/ServiceLogin?hl=en&amp;passive=true&amp;continue=http://www.google.com/"</span> <span class="attr">class</span>=<span class="string">gb4</span>&gt;</span>Sign in<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">nobr</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">gbh</span> <span class="attr">style</span>=<span class="string">left:0</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">gbh</span> <span class="attr">style</span>=<span class="string">right:0</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span> <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">center</span>&gt;</span><span class="tag">&lt;<span class="name">br</span> <span class="attr">clear</span>=<span class="string">"all"</span> <span class="attr">id</span>=<span class="string">"lgpd"</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"lga"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/search?ie=UTF-8&amp;amp;q=teacher+appreciation+week&amp;amp;oi=ddle&amp;amp;ct=120236436&amp;amp;hl=en&amp;amp;kgmid=/m/0_m0g58&amp;amp;sa=X&amp;amp;ved=0ahUKEwib_c2ljofiAhUK2FQKHVb7Bs4QPQgD"</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">alt</span>=<span class="string">"Happy US Teacher Appreciation Week 2019!"</span> <span class="attr">border</span>=<span class="string">"0"</span> <span class="attr">height</span>=<span class="string">"220"</span> <span class="attr">src</span>=<span class="string">"/logos/doodles/2019/us-teacher-appreciation-week-2019-begins-4994791740801024-l.png"</span> <span class="attr">title</span>=<span class="string">"Happy US Teacher Appreciation Week 2019!"</span> <span class="attr">width</span>=<span class="string">"430"</span> <span class="attr">id</span>=<span class="string">"hplogo"</span> <span class="attr">onload</span>=<span class="string">"window.lol&amp;&amp;lol()"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"/search"</span> <span class="attr">name</span>=<span class="string">"f"</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">cellpadding</span>=<span class="string">"0"</span> <span class="attr">cellspacing</span>=<span class="string">"0"</span>&gt;</span><span class="tag">&lt;<span class="name">tr</span> <span class="attr">valign</span>=<span class="string">"top"</span>&gt;</span><span class="tag">&lt;<span class="name">td</span> <span class="attr">width</span>=<span class="string">"25%"</span>&gt;</span>&amp;nbsp;<span class="tag">&lt;/<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">td</span> <span class="attr">align</span>=<span class="string">"center"</span> <span class="attr">nowrap</span>=<span class="string">""</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"ie"</span> <span class="attr">value</span>=<span class="string">"ISO-8859-1"</span> <span class="attr">type</span>=<span class="string">"hidden"</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">value</span>=<span class="string">"en"</span> <span class="attr">name</span>=<span class="string">"hl"</span> <span class="attr">type</span>=<span class="string">"hidden"</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"source"</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">value</span>=<span class="string">"hp"</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"biw"</span> <span class="attr">type</span>=<span class="string">"hidden"</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"bih"</span> <span class="attr">type</span>=<span class="string">"hidden"</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"ds"</span> <span class="attr">style</span>=<span class="string">"height:32px;margin:4px 0"</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">style</span>=<span class="string">"color:#000;margin:0;padding:5px 8px 0 6px;vertical-align:top"</span> <span class="attr">autocomplete</span>=<span class="string">"off"</span> <span class="attr">class</span>=<span class="string">"lst"</span> <span class="attr">value</span>=<span class="string">""</span> <span class="attr">title</span>=<span class="string">"Google Search"</span> <span class="attr">maxlength</span>=<span class="string">"2048"</span> <span class="attr">name</span>=<span class="string">"q"</span> <span class="attr">size</span>=<span class="string">"57"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">br</span> <span class="attr">style</span>=<span class="string">"line-height:0"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"ds"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"lsbb"</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">"lsb"</span> <span class="attr">value</span>=<span class="string">"Google Search"</span> <span class="attr">name</span>=<span class="string">"btnG"</span> <span class="attr">type</span>=<span class="string">"submit"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"ds"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"lsbb"</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">"lsb"</span> <span class="attr">value</span>=<span class="string">"I'm Feeling Lucky"</span> <span class="attr">name</span>=<span class="string">"btnI"</span> <span class="attr">onclick</span>=<span class="string">"if(this.form.q.value)this.checked=1; else top.location='/doodles/'"</span> <span class="attr">type</span>=<span class="string">"submit"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">"fl sblc"</span> <span class="attr">align</span>=<span class="string">"left"</span> <span class="attr">nowrap</span>=<span class="string">""</span> <span class="attr">width</span>=<span class="string">"25%"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/advanced_search?hl=en&amp;amp;authuser=0"</span>&gt;</span>Advanced search<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/language_tools?hl=en&amp;amp;authuser=0"</span>&gt;</span>Language tools<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">tr</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"gbv"</span> <span class="attr">name</span>=<span class="string">"gbv"</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">value</span>=<span class="string">"1"</span>&gt;</span><span class="tag">&lt;<span class="name">script</span> <span class="attr">nonce</span>=<span class="string">"1cF5wiybAk0ZW7RYxuJPNw=="</span>&gt;</span><span class="javascript">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a,b=<span class="string">"1"</span>;<span class="keyword">if</span>(<span class="built_in">document</span>&amp;&amp;<span class="built_in">document</span>.getElementById)<span class="keyword">if</span>(<span class="string">"undefined"</span>!=<span class="keyword">typeof</span> XMLHttpRequest)b=<span class="string">"2"</span>;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">"undefined"</span>!=<span class="keyword">typeof</span> ActiveXObject)&#123;<span class="keyword">var</span> c,d,e=[<span class="string">"MSXML2.XMLHTTP.6.0"</span>,<span class="string">"MSXML2.XMLHTTP.3.0"</span>,<span class="string">"MSXML2.XMLHTTP"</span>,<span class="string">"Microsoft.XMLHTTP"</span>];<span class="keyword">for</span>(c=<span class="number">0</span>;d=e[c++];)<span class="keyword">try</span>&#123;<span class="keyword">new</span> ActiveXObject(d),b=<span class="string">"2"</span>&#125;<span class="keyword">catch</span>(h)&#123;&#125;&#125;a=b;<span class="keyword">if</span>(<span class="string">"2"</span>==a&amp;&amp;<span class="number">-1</span>==location.search.indexOf(<span class="string">"&amp;gbv=2"</span>))&#123;<span class="keyword">var</span> f=google.gbvu,g=<span class="built_in">document</span>.getElementById(<span class="string">"gbv"</span>);g&amp;&amp;(g.value=a);f&amp;&amp;<span class="built_in">window</span>.setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;location.href=f&#125;,<span class="number">0</span>)&#125;;&#125;).call(<span class="keyword">this</span>);</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span><span class="tag">&lt;/<span class="name">form</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"gac_scont"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"font-size:83%;min-height:3.5em"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"prm"</span>&gt;</span><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"><span class="selector-class">.szppmdbYutt__middle-slot-promo</span>&#123;<span class="attribute">font-size</span>:small;<span class="attribute">margin-bottom</span>:<span class="number">32px</span>&#125;<span class="selector-class">.szppmdbYutt__middle-slot-promo</span> <span class="selector-tag">a</span><span class="selector-class">.ZIeIlb</span>&#123;<span class="attribute">display</span>:inline-block;<span class="attribute">text-decoration</span>:none&#125;<span class="selector-class">.szppmdbYutt__middle-slot-promo</span> <span class="selector-tag">img</span>&#123;<span class="attribute">border</span>:none;<span class="attribute">margin-right</span>:<span class="number">5px</span>;<span class="attribute">vertical-align</span>:middle&#125;</span><span class="tag">&lt;/<span class="name">style</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"szppmdbYutt__middle-slot-promo"</span> <span class="attr">data-ved</span>=<span class="string">"0ahUKEwib_c2ljofiAhUK2FQKHVb7Bs4QnIcBCAQ"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"NKcBbd"</span> <span class="attr">href</span>=<span class="string">"https://www.google.com/url?q=https://www.blog.google/outreach-initiatives/education/teacher-appreciation-week-2019/%3Futm_source%3Dgoogle%26utm_medium%3Dhpp%26utm_campaign%3Dtaw_2019&amp;amp;source=hpp&amp;amp;id=19012032&amp;amp;ct=3&amp;amp;usg=AFQjCNEqnJb2uHoMjg2Wud6MtvKcn2ILpg&amp;amp;sa=X&amp;amp;ved=0ahUKEwib_c2ljofiAhUK2FQKHVb7Bs4Q8IcBCAU"</span> <span class="attr">rel</span>=<span class="string">"nofollow"</span>&gt;</span>We&amp;#8217;re supporting teachers inspiring the next generation<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"footer"</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"font-size:10pt"</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"margin:19px auto;text-align:center"</span> <span class="attr">id</span>=<span class="string">"fll"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/intl/en/ads/"</span>&gt;</span>Advertising?Programs<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/services/"</span>&gt;</span>Business Solutions<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/intl/en/about.html"</span>&gt;</span>About Google<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">"color:#767676;font-size:8pt"</span>&gt;</span>&amp;copy; 2019 - <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/intl/en/policies/privacy/"</span>&gt;</span>Privacy<span class="tag">&lt;/<span class="name">a</span>&gt;</span> - <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/intl/en/policies/terms/"</span>&gt;</span>Terms<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">center</span>&gt;</span><span class="tag">&lt;<span class="name">script</span> <span class="attr">nonce</span>=<span class="string">"1cF5wiybAk0ZW7RYxuJPNw=="</span>&gt;</span><span class="javascript">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="built_in">window</span>.google.cdo=&#123;<span class="attr">height</span>:<span class="number">0</span>,<span class="attr">width</span>:<span class="number">0</span>&#125;;(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="built_in">window</span>.innerWidth,b=<span class="built_in">window</span>.innerHeight;<span class="keyword">if</span>(!a||!b)&#123;<span class="keyword">var</span> c=<span class="built_in">window</span>.document,d=<span class="string">"CSS1Compat"</span>==c.compatMode?c.documentElement:c.body;a=d.clientWidth;b=d.clientHeight&#125;a&amp;&amp;b&amp;&amp;(a!=google.cdo.width||b!=google.cdo.height)&amp;&amp;google.log(<span class="string">""</span>,<span class="string">""</span>,<span class="string">"/client_204?&amp;atyp=i&amp;biw="</span>+a+<span class="string">"&amp;bih="</span>+b+<span class="string">"&amp;ei="</span>+google.kEI);&#125;).call(<span class="keyword">this</span>);&#125;)();(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> u=<span class="string">'/xjs/_/js/k\x3dxjs.hp.en_US.Yv_bmieVcKQ.O/m\x3dsb_he,d/am\x3dwKAW/rt\x3dj/d\x3d1/rs\x3dACT90oG3DzwVTl5n4Q_0THsxrUHGQsAO3g'</span>;setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="built_in">document</span>.createElement(<span class="string">"script"</span>);a.src=u;google.timers&amp;&amp;google.timers.load&amp;&amp;google.tick&amp;&amp;google.tick(<span class="string">"load"</span>,<span class="string">"xjsls"</span>);<span class="built_in">document</span>.body.appendChild(a)&#125;,<span class="number">0</span>);&#125;)();(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="built_in">window</span>.google.xjsu=<span class="string">'/xjs/_/js/k\x3dxjs.hp.en_US.Yv_bmieVcKQ.O/m\x3dsb_he,d/am\x3dwKAW/rt\x3dj/d\x3d1/rs\x3dACT90oG3DzwVTl5n4Q_0THsxrUHGQsAO3g'</span>;&#125;)();<span class="function"><span class="keyword">function</span> <span class="title">_DumpException</span>(<span class="params">e</span>)</span>&#123;<span class="keyword">throw</span> e;&#125;</span></span><br><span class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">_F_installCss</span>(<span class="params">c</span>)</span>&#123;&#125;</span></span><br><span class="line"><span class="javascript">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;google.spjs=<span class="literal">false</span>;&#125;)();google.sm=<span class="number">1</span>;(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> pmc=<span class="string">'&#123;\x22Qnk92g\x22:&#123;&#125;,\x22RWGcrA\x22:&#123;&#125;,\x22U5B21g\x22:&#123;&#125;,\x22YFCs/g\x22:&#123;&#125;,\x22ZI/YVQ\x22:&#123;&#125;,\x22d\x22:&#123;&#125;,\x22sb_he\x22:&#123;\x22agen\x22:true,\x22cgen\x22:true,\x22client\x22:\x22heirloom-hp\x22,\x22dh\x22:true,\x22dhqt\x22:true,\x22ds\x22:\x22\x22,\x22ffql\x22:\x22en\x22,\x22fl\x22:true,\x22host\x22:\x22google.com\x22,\x22isbh\x22:28,\x22jsonp\x22:true,\x22msgs\x22:&#123;\x22cibl\x22:\x22Clear Search\x22,\x22dym\x22:\x22Did you mean:\x22,\x22lcky\x22:\x22I\\u0026#39;m Feeling Lucky\x22,\x22lml\x22:\x22Learn more\x22,\x22oskt\x22:\x22Input tools\x22,\x22psrc\x22:\x22This search was removed from your \\u003Ca href\x3d\\\x22/history\\\x22\\u003EWeb History\\u003C/a\\u003E\x22,\x22psrl\x22:\x22Remove\x22,\x22sbit\x22:\x22Search by image\x22,\x22srch\x22:\x22Google Search\x22&#125;,\x22ovr\x22:&#123;&#125;,\x22pq\x22:\x22\x22,\x22refpd\x22:true,\x22rfs\x22:[],\x22sbpl\x22:24,\x22sbpr\x22:24,\x22scd\x22:10,\x22sce\x22:5,\x22stok\x22:\x22s4ND7ehgr2lcHpcv5T93UySs4ho\x22,\x22uhde\x22:false&#125;&#125;'</span>;google.pmc=<span class="built_in">JSON</span>.parse(pmc);&#125;)();</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span>        <span class="tag">&lt;/<span class="name">body</span>&gt;</span><span class="tag">&lt;/<span class="name">html</span>&gt;</span>suntongmiandeMacBook-Pro:webrtc suntongmian$ </span><br><span class="line">suntongmiandeMacBook-Pro:webrtc suntongmian$</span><br></pre></td></tr></table></figure><p>发现可以正常访问 <a href="http://www.google.com" target="_blank" rel="noopener">www.google.com</a> 的资源了。</p><p>解决了终端的代理问题后，再次执行命令</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="keyword">clone</span> <span class="title">https</span>://chromium.googlesource.com/chromium/tools/depot_tools.git</span><br></pre></td></tr></table></figure><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">suntongmiandeMacBook-<span class="string">Pro:</span>webrtc suntongmian$ git clone <span class="string">https:</span><span class="comment">//chromium.googlesource.com/chromium/tools/depot_tools.git</span></span><br><span class="line">正克隆到 <span class="string">'depot_tools'</span>...</span><br><span class="line"><span class="string">remote:</span> Sending approximately <span class="number">24.21</span> MiB ...</span><br><span class="line"><span class="string">remote:</span> Total <span class="number">31833</span> (delta <span class="number">22312</span>), reused <span class="number">31833</span> (delta <span class="number">22312</span>)</span><br><span class="line">接收对象中: <span class="number">100</span>% (<span class="number">31833</span><span class="regexp">/31833), 24.21 MiB | 1.25 MiB/</span>s, 完成.</span><br><span class="line">处理 delta 中: <span class="number">100</span>% (<span class="number">22312</span>/<span class="number">22312</span>), 完成.</span><br><span class="line">suntongmiandeMacBook-<span class="string">Pro:</span>webrtc suntongmian$ </span><br><span class="line">suntongmiandeMacBook-<span class="string">Pro:</span>webrtc suntongmian$ ls</span><br><span class="line">depot_tools</span><br><span class="line">suntongmiandeMacBook-<span class="string">Pro:</span>webrtc suntongmian$</span><br></pre></td></tr></table></figure><p>到此，可以看到 depot_tools 源码已经下载成功了。</p><h2 id="step-2-1"><a href="#step-2-1" class="headerlink" title="step 2"></a>step 2</h2><p>获取 depot_tools 文件夹所在的目录，在终端执行命令 </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">pwd</span></span><br></pre></td></tr></table></figure><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">suntongmiandeMacBook-<span class="string">Pro:</span>webrtc suntongmian$ ls</span><br><span class="line">depot_tools</span><br><span class="line">suntongmiandeMacBook-<span class="string">Pro:</span>webrtc suntongmian$ </span><br><span class="line">suntongmiandeMacBook-<span class="string">Pro:</span>webrtc suntongmian$ pwd</span><br><span class="line"><span class="regexp">/Users/</span>suntongmian<span class="regexp">/Documents/</span>develop/webrtc</span><br><span class="line">suntongmiandeMacBook-<span class="string">Pro:</span>webrtc suntongmian$</span><br></pre></td></tr></table></figure><h2 id="step-3-1"><a href="#step-3-1" class="headerlink" title="step 3"></a>step 3</h2><p>添加环境变量，命令格式为</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export PATH=<span class="variable">$PATH</span><span class="symbol">:/path/depot_tools</span></span><br></pre></td></tr></table></figure><p>其中，path 为上一步通过 pwd 命令获取的 depot_tools 文件夹所在目录。</p><p>在终端执行命令</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export PATH=<span class="variable">$PATH</span><span class="symbol">:/Users/suntongmian/Documents/develop/webrtc/depot_tools</span></span><br></pre></td></tr></table></figure><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">suntongmiandeMacBook-<span class="symbol">Pro:</span>webrtc suntongmian<span class="variable">$ </span>export PATH=<span class="variable">$PATH</span><span class="symbol">:/Users/suntongmian/Documents/develop/webrtc/depot_tools</span></span><br><span class="line">suntongmiandeMacBook-<span class="symbol">Pro:</span>webrtc suntongmian$</span><br></pre></td></tr></table></figure><p><strong>提示：执行后，只对当前终端起作用。重启终端后，默认失效。</strong></p><h2 id="step-4"><a href="#step-4" class="headerlink" title="step 4"></a>step 4</h2><p>到此，depot_tools 的配置已经完成。想知道 depot_tools 是否成功安装，在终端执行命令</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fetch <span class="comment">--help</span></span><br></pre></td></tr></table></figure><figure class="highlight dsconfig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">suntongmiandeMacBook-Pro:webrtc </span><span class="string">suntongmian$</span> <span class="string">fetch </span><span class="built_in">--help</span></span><br><span class="line"><span class="built_in">usage:</span> <span class="string">fetch.</span><span class="string">py </span>[<span class="string">options]</span> &lt;<span class="string">config&gt;</span> [<span class="built_in">--property=value</span> [<span class="built_in">--property2=value2</span> ...]]</span><br><span class="line"></span><br><span class="line"><span class="string">This </span><span class="string">script </span><span class="string">can </span><span class="string">be </span><span class="string">used </span><span class="string">to </span><span class="string">download </span><span class="string">the </span><span class="string">Chromium </span><span class="string">sources.</span> <span class="string">See</span></span><br><span class="line"><span class="string">http:</span>//<span class="string">www.</span><span class="string">chromium.</span><span class="string">org/</span><span class="string">developers/</span><span class="string">how-tos/</span><span class="built_in">get-the-code</span></span><br><span class="line"><span class="built_in">for</span> <span class="string">full </span><span class="string">usage </span><span class="string">instructions.</span></span><br><span class="line"></span><br><span class="line"><span class="string">Valid </span><span class="string">options:</span></span><br><span class="line">   -h, <span class="built_in">--help,</span> <span class="string">help </span>  <span class="string">Print </span><span class="string">this </span><span class="string">message.</span></span><br><span class="line">   <span class="built_in">--nohooks</span>          <span class="string">Don'</span>t <span class="string">run </span><span class="string">hooks </span><span class="string">after </span><span class="string">checkout.</span></span><br><span class="line">   <span class="built_in">--force</span>            (<span class="string">dangerous)</span> <span class="string">Don'</span>t <span class="string">look </span><span class="string">for </span><span class="string">existing </span>.<span class="string">gclient </span><span class="string">file.</span></span><br><span class="line">   -n, <span class="built_in">--dry-run</span>      <span class="string">Don'</span>t <span class="string">run </span><span class="string">commands,</span> <span class="string">only </span><span class="string">print </span><span class="string">them.</span></span><br><span class="line">   <span class="built_in">--no-history</span>       <span class="string">Perform </span><span class="string">shallow </span><span class="string">clones,</span> <span class="string">don'</span>t <span class="string">fetch </span><span class="string">the </span><span class="string">full </span><span class="string">git </span><span class="string">history.</span></span><br><span class="line"></span><br><span class="line"><span class="string">Valid </span><span class="string">fetch </span><span class="string">configs:</span></span><br><span class="line">  <span class="string">android</span></span><br><span class="line"><span class="string"> </span> <span class="string">android_internal</span></span><br><span class="line"><span class="string"> </span> <span class="string">breakpad</span></span><br><span class="line"><span class="string"> </span> <span class="string">chromium</span></span><br><span class="line"><span class="string"> </span> <span class="string">config_util</span></span><br><span class="line"><span class="string"> </span> <span class="string">crashpad</span></span><br><span class="line"><span class="string"> </span> <span class="string">dart</span></span><br><span class="line"><span class="string"> </span> <span class="string">depot_tools</span></span><br><span class="line"><span class="string"> </span> <span class="string">goma_client</span></span><br><span class="line"><span class="string"> </span> <span class="string">gyp</span></span><br><span class="line"><span class="string"> </span> <span class="string">infra</span></span><br><span class="line"><span class="string"> </span> <span class="string">infra_internal</span></span><br><span class="line"><span class="string"> </span> <span class="string">inspector_protocol</span></span><br><span class="line"><span class="string"> </span> <span class="string">ios</span></span><br><span class="line"><span class="string"> </span> <span class="string">ios_internal</span></span><br><span class="line"><span class="string"> </span> <span class="string">nacl</span></span><br><span class="line"><span class="string"> </span> <span class="string">naclports</span></span><br><span class="line"><span class="string"> </span> <span class="string">node-ci</span></span><br><span class="line"><span class="string"> </span> <span class="string">pdfium</span></span><br><span class="line"><span class="string"> </span> <span class="string">skia</span></span><br><span class="line"><span class="string"> </span> <span class="string">skia_buildbot</span></span><br><span class="line"><span class="string"> </span> <span class="string">syzygy</span></span><br><span class="line"><span class="string"> </span> <span class="string">v8</span></span><br><span class="line"><span class="string"> </span> <span class="string">webrtc</span></span><br><span class="line"><span class="string"> </span> <span class="string">webrtc_android</span></span><br><span class="line"><span class="string"> </span> <span class="string">webrtc_ios</span></span><br><span class="line"><span class="string">suntongmiandeMacBook-</span><span class="string">Pro:webrtc </span><span class="string">suntongmian$</span></span><br></pre></td></tr></table></figure><p>打印上面的信息，说明 depot_tools 工具包已经成功安装。接下来就可以通过 depot_tools 工具下载 WebRTC 源码了。</p><blockquote><h1 id="三、下载-WebRTC-源码"><a href="#三、下载-WebRTC-源码" class="headerlink" title="三、下载 WebRTC 源码"></a>三、下载 WebRTC 源码</h1></blockquote><p>WebRTC 文件量较大，在下载之前，磁盘的剩余可用容量要满足：</p><p>Linux: 6.4 GB.<br>Linux (with Android): 16 GB (of which ~8 GB is Android SDK+NDK images).<br>Mac (with iOS support): 5.6GB</p><p>我使用的是 MacBook Pro 2015款机器：</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">macOS Mojave</span><br><span class="line">版本 <span class="number">10.14</span><span class="number">.4</span></span><br><span class="line"></span><br><span class="line">MacBook Pro (Retina, <span class="number">13</span>-inch, Early <span class="number">2015</span>)</span><br><span class="line">处理器 <span class="number">2.7</span> GHz Intel Core i5</span><br><span class="line">内存 <span class="number">8</span> GB <span class="number">1867</span> MHz DDR3</span><br><span class="line">启动磁盘 Macintosh HD</span><br><span class="line">图形卡 Intel Iris Graphics <span class="number">6100</span> <span class="number">1536</span> MB</span><br><span class="line">磁盘空间 <span class="number">128</span> GB</span><br><span class="line">可用磁盘空间 <span class="number">17.11</span> GB</span><br></pre></td></tr></table></figure><p>我的 Mac 电脑可用磁盘空间 17.11 GB，是足以装的下 5.6 GB 文件的，好了，接下来就可以放心下载源码了。</p><h2 id="step-1-2"><a href="#step-1-2" class="headerlink" title="step 1"></a>step 1</h2><p>下载所需要的工程，在终端执行命令</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fetch <span class="comment">--nohooks webrtc_ios</span></span><br></pre></td></tr></table></figure><p>在 “安装 depot_tools 工具包” 的步骤中，通过 <strong>fetch –help</strong>，可以看到代码目录 webrtc，webrtc_android，webrtc_ios 等。我要在 iOS 平台上使用，就选择了 webrtc_ios。选择依据见 <a href="https://webrtc.org/native-code/ios/" target="_blank" rel="noopener">WebRTC Native Code, iOS</a> 中提到的 “This will fetch a regular WebRTC checkout with the iOS-specific parts added.”</p><p>这条命令执行时，要下载的文件比较多，需要耐心等待命令的执行结果。</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">suntongmiandeMacBook-Pro:webrtc suntongmian$ fetch --nohooks webrtc_ios</span></span><br><span class="line"><span class="section">Running: gclient root</span></span><br><span class="line"><span class="section">WARNING: Your metrics.cfg file was invalid or nonexistent. A new one will be created.</span></span><br><span class="line"><span class="section">Running: gclient config --spec 'solutions = [</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="string">"url"</span>: <span class="string">"https://webrtc.googlesource.com/src.git"</span>,</span><br><span class="line">    <span class="string">"managed"</span>: False,</span><br><span class="line">    <span class="string">"name"</span>: <span class="string">"src"</span>,</span><br><span class="line">    <span class="string">"deps_file"</span>: <span class="string">"DEPS"</span>,</span><br><span class="line">    <span class="string">"custom_deps"</span>: &#123;&#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">]</span><br><span class="line">target_os = [<span class="string">"ios"</span>, <span class="string">"mac"</span>]</span><br><span class="line">'</span><br><span class="line"><span class="section">Running: gclient sync --nohooks --with_branch_heads</span></span><br><span class="line"></span><br><span class="line">________ running 'git -c core.deltaBaseCacheLimit=2g clone --no-checkout --progress https://webrtc.googlesource.com/src.git /Users/suntongmian/Documents/develop/webrtc/_gclient_src_twA2Fg' in '/Users/suntongmian/Documents/develop/webrtc'</span><br><span class="line">Cloning into '/Users/suntongmian/Documents/develop/webrtc/_gclient_src_twA2Fg'...</span><br><span class="line"><span class="section">remote: Sending approximately 253.71 MiB ...        </span></span><br><span class="line"><span class="section">remote: Counting objects: 22, done        </span></span><br><span class="line"><span class="section">remote: Finding sources: 100% (22/22)           </span></span><br><span class="line">Receiving objects:  57% (183907/320504), 74.04 MiB | 1.88 MiB/s    </span><br><span class="line"><span class="section">[0:01:00] Still working on:</span></span><br><span class="line"><span class="section">[0:01:00]   src</span></span><br><span class="line">Receiving objects:  60% (192303/320504), 88.48 MiB | 1.35 MiB/s   </span><br><span class="line"><span class="section">[0:01:10] Still working on:</span></span><br><span class="line"><span class="section">[0:01:10]   src</span></span><br><span class="line">Receiving objects:  62% (198983/320504), 99.53 MiB | 1.15 MiB/s   </span><br><span class="line"><span class="section">[0:01:20] Still working on:</span></span><br><span class="line"><span class="section">[0:01:20]   src</span></span><br><span class="line">Receiving objects:  64% (205195/320504), 112.59 MiB | 1.25 MiB/s     </span><br><span class="line"><span class="section">[0:01:30] Still working on:</span></span><br><span class="line"><span class="section">[0:01:30]   src</span></span><br><span class="line">Receiving objects:  64% (206287/320504), 127.59 MiB | 1.64 MiB/s   </span><br><span class="line"><span class="section">[0:01:40] Still working on:</span></span><br><span class="line"><span class="section">[0:01:40]   src</span></span><br><span class="line">Receiving objects:  66% (211727/320504), 138.71 MiB | 1.17 MiB/s     </span><br><span class="line"><span class="section">[0:01:50] Still working on:</span></span><br><span class="line"><span class="section">[0:01:50]   src</span></span><br><span class="line">Receiving objects:  66% (212334/320504), 144.40 MiB | 573.00 KiB/s   </span><br><span class="line"><span class="section">[0:02:00] Still working on:</span></span><br><span class="line"><span class="section">[0:02:00]   src</span></span><br><span class="line">Receiving objects:  67% (214856/320504), 151.96 MiB | 815.00 KiB/s   </span><br><span class="line"><span class="section">[0:02:10] Still working on:</span></span><br><span class="line"><span class="section">[0:02:10]   src</span></span><br><span class="line">Receiving objects:  69% (221994/320504), 163.95 MiB | 1.41 MiB/s   </span><br><span class="line"><span class="section">[0:02:20] Still working on:</span></span><br><span class="line"><span class="section">[0:02:20]   src</span></span><br><span class="line">Receiving objects:  71% (230570/320504), 174.51 MiB | 997.00 KiB/s    </span><br><span class="line"><span class="section">[0:02:30] Still working on:</span></span><br><span class="line"><span class="section">[0:02:30]   src</span></span><br><span class="line">Receiving objects:  80% (256404/320504), 184.07 MiB | 1.43 MiB/s     </span><br><span class="line"><span class="section">[0:02:40] Still working on:</span></span><br><span class="line"><span class="section">[0:02:40]   src</span></span><br><span class="line">Receiving objects:  86% (276405/320504), 197.69 MiB | 1.40 MiB/s   </span><br><span class="line"><span class="section">[0:02:50] Still working on:</span></span><br><span class="line"><span class="section">[0:02:50]   src</span></span><br><span class="line">Receiving objects:  95% (304479/320504), 210.75 MiB | 1.38 MiB/s   </span><br><span class="line"><span class="section">[0:03:00] Still working on:</span></span><br><span class="line"><span class="section">[0:03:00]   src</span></span><br><span class="line">Receiving objects:  98% (315231/320504), 224.59 MiB | 1.18 MiB/s   </span><br><span class="line"><span class="section">[0:03:10] Still working on:</span></span><br><span class="line"><span class="section">[0:03:10]   src</span></span><br><span class="line">Receiving objects:  98% (315246/320504), 234.05 MiB | 929.00 KiB/s   </span><br><span class="line"><span class="section">[0:03:20] Still working on:</span></span><br><span class="line"><span class="section">[0:03:20]   src</span></span><br><span class="line">Receiving objects:  99% (320126/320504), 244.74 MiB | 1.02 MiB/s     </span><br><span class="line"><span class="section">[0:03:30] Still working on:</span></span><br><span class="line"><span class="section">[0:03:30]   src</span></span><br><span class="line"><span class="section">remote: Total 320504 (delta 243613), reused 320495 (delta 243613)        </span></span><br><span class="line">Receiving objects: 100% (320504/320504), 253.18 MiB | 1.20 MiB/s, done.</span><br><span class="line">Resolving deltas:  75% (184825/243613)   </span><br><span class="line"><span class="section">[0:03:40] Still working on:</span></span><br><span class="line"><span class="section">[0:03:40]   src</span></span><br><span class="line">Resolving deltas: 100% (243613/243613), done.</span><br><span class="line"></span><br><span class="line"><span class="section">[0:03:50] Still working on:</span></span><br><span class="line"><span class="section">[0:03:50]   src</span></span><br><span class="line">Syncing projects:   0% ( 0/ 2) </span><br><span class="line"><span class="section">[0:03:59] Still working on:</span></span><br><span class="line"><span class="section">[0:03:59]   src</span></span><br><span class="line">Syncing projects:  15% ( 6/38) src/buildtools/third_party/libunwind/trunk</span><br><span class="line"><span class="section">[0:05:50] Still working on:</span></span><br><span class="line"><span class="section">[0:05:50]   src/base</span></span><br><span class="line"><span class="section">[0:05:50]   src/build</span></span><br><span class="line"><span class="section">[0:05:50]   src/ios</span></span><br><span class="line"><span class="section">[0:05:50]   src/testing</span></span><br><span class="line"><span class="section">[0:05:50]   src/third_party</span></span><br><span class="line"><span class="section">[0:05:50]   src/tools</span></span><br><span class="line"><span class="section">[0:05:50]   src/buildtools/third_party/libc++/trunk</span></span><br><span class="line"></span><br><span class="line"><span class="section">[0:05:52] Still working on:</span></span><br><span class="line"><span class="section">[0:05:52]   src/base</span></span><br><span class="line"><span class="section">[0:05:52]   src/build</span></span><br><span class="line"><span class="section">[0:05:52]   src/ios</span></span><br><span class="line"><span class="section">[0:05:52]   src/testing</span></span><br><span class="line"><span class="section">[0:05:52]   src/third_party</span></span><br><span class="line"><span class="section">[0:05:52]   src/tools</span></span><br><span class="line"><span class="section">[0:05:52]   src/buildtools/third_party/libc++/trunk</span></span><br><span class="line">Syncing projects:  18% ( 7/38) src/buildtools/third_party/libc++/trunk   </span><br><span class="line"><span class="section">[0:06:52] Still working on:</span></span><br><span class="line"><span class="section">[0:06:52]   src/base</span></span><br><span class="line"><span class="section">[0:06:52]   src/build</span></span><br><span class="line"><span class="section">[0:06:52]   src/ios</span></span><br><span class="line"><span class="section">[0:06:52]   src/testing</span></span><br><span class="line"><span class="section">[0:06:52]   src/third_party</span></span><br><span class="line"><span class="section">[0:06:52]   src/tools</span></span><br><span class="line"></span><br><span class="line"><span class="section">[0:07:02] Still working on:</span></span><br><span class="line"><span class="section">[0:07:02]   src/base</span></span><br><span class="line"><span class="section">[0:07:02]   src/build</span></span><br><span class="line"><span class="section">[0:07:02]   src/ios</span></span><br><span class="line"><span class="section">[0:07:02]   src/testing</span></span><br><span class="line"><span class="section">[0:07:02]   src/third_party</span></span><br><span class="line"><span class="section">[0:07:02]   src/tools</span></span><br><span class="line"></span><br><span class="line"><span class="section">[0:07:12] Still working on:</span></span><br><span class="line"><span class="section">[0:07:12]   src/base</span></span><br><span class="line"><span class="section">[0:07:12]   src/build</span></span><br><span class="line"><span class="section">[0:07:12]   src/ios</span></span><br><span class="line"><span class="section">[0:07:12]   src/testing</span></span><br><span class="line"><span class="section">[0:07:12]   src/third_party</span></span><br><span class="line"><span class="section">[0:07:12]   src/tools</span></span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="section">[2:03:16] Still working on:</span></span><br><span class="line"><span class="section">[2:03:16]   src/third_party/icu</span></span><br><span class="line"></span><br><span class="line"><span class="section">[2:03:26] Still working on:</span></span><br><span class="line"><span class="section">[2:03:26]   src/third_party/icu</span></span><br><span class="line"></span><br><span class="line"><span class="section">[2:03:36] Still working on:</span></span><br><span class="line"><span class="section">[2:03:36]   src/third_party/icu</span></span><br><span class="line"></span><br><span class="line"><span class="section">[2:03:46] Still working on:</span></span><br><span class="line"><span class="section">[2:03:46]   src/third_party/icu</span></span><br><span class="line"></span><br><span class="line"><span class="section">[2:03:52] Still working on:</span></span><br><span class="line"><span class="section">[2:03:52]   src/third_party/icu</span></span><br><span class="line">Syncing projects: 100% (38/38), done.                              </span><br><span class="line"><span class="section">Running: git submodule foreach 'git config -f $toplevel/.git/config submodule.$name.ignore all'</span></span><br><span class="line"><span class="section">Running: git config --add remote.origin.fetch '+refs/tags/*:refs/tags/*'</span></span><br><span class="line"><span class="section">Running: git config diff.ignoreSubmodules all</span></span><br><span class="line"><span class="section">suntongmiandeMacBook-Pro:webrtc suntongmian$</span></span><br></pre></td></tr></table></figure><h2 id="step-2-2"><a href="#step-2-2" class="headerlink" title="step 2"></a>step 2</h2><p>与远端 repo 进行代码同步，在终端执行命令</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gclient <span class="keyword">sync</span></span><br></pre></td></tr></table></figure><p>这条命令执行时，要下载的文件比较多，需要耐心等待命令的执行结果。</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">suntongmiandeMacBook-<span class="keyword">Pro</span>:webrtc suntongmian$ gclient sync</span><br><span class="line">Syncing projects: 100% (38/38), done.                                                     </span><br><span class="line"></span><br><span class="line">________ running '/usr/bin/python src/build/mac_toolchain.py' <span class="keyword">in</span> '/Users/suntongmian/Documents/develop/webrtc'</span><br><span class="line">Skipping <span class="keyword">Mac</span> toolchain installation <span class="keyword">for</span> <span class="keyword">mac</span></span><br><span class="line"></span><br><span class="line">________ running '/usr/bin/python src/tools/clang/scripts/<span class="keyword">update</span>.py' <span class="keyword">in</span> '/Users/suntongmian/Documents/develop/webrtc'</span><br><span class="line">Downloading https:<span class="comment">//commondatastorage.googleapis.com/chromium-browser-clang/Mac/clang-357692-1.tgz </span></span><br><span class="line">&lt;urlopen <span class="keyword">error</span> [Errno 54] Connection reset <span class="keyword">by</span> peer&gt;</span><br><span class="line">Retrying <span class="keyword">in</span> 5 s ...</span><br><span class="line">Downloading https:<span class="comment">//commondatastorage.googleapis.com/chromium-browser-clang/Mac/clang-357692-1.tgz </span></span><br><span class="line">&lt;urlopen <span class="keyword">error</span> [Errno 54] Connection reset <span class="keyword">by</span> peer&gt;</span><br><span class="line">Retrying <span class="keyword">in</span> 10 s ...</span><br><span class="line">Downloading https:<span class="comment">//commondatastorage.googleapis.com/chromium-browser-clang/Mac/clang-357692-1.tgz </span></span><br><span class="line">&lt;urlopen <span class="keyword">error</span> [Errno 54] Connection reset <span class="keyword">by</span> peer&gt;</span><br><span class="line">Retrying <span class="keyword">in</span> 20 s ...</span><br><span class="line">Downloading https:<span class="comment">//commondatastorage.googleapis.com/chromium-browser-clang/Mac/clang-357692-1.tgz Traceback (most recent call last):</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">"src/tools/clang/scripts/update.py"</span>, <span class="keyword">line</span> 322, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">    sys.<span class="keyword">exit</span>(main())</span><br><span class="line">  <span class="keyword">File</span> <span class="string">"src/tools/clang/scripts/update.py"</span>, <span class="keyword">line</span> 318, <span class="keyword">in</span> main</span><br><span class="line">    <span class="keyword">return</span> UpdateClang()</span><br><span class="line">  <span class="keyword">File</span> <span class="string">"src/tools/clang/scripts/update.py"</span>, <span class="keyword">line</span> 252, <span class="keyword">in</span> UpdateClang</span><br><span class="line">    DownloadAndUnpackClangPackage(sys.platform, LLVM_BUILD_DIR)</span><br><span class="line">  <span class="keyword">File</span> <span class="string">"src/tools/clang/scripts/update.py"</span>, <span class="keyword">line</span> 171, <span class="keyword">in</span> DownloadAndUnpackClangPackage</span><br><span class="line">    DownloadAndUnpack(cds_full_url, output_dir, path_prefix)</span><br><span class="line">  <span class="keyword">File</span> <span class="string">"src/tools/clang/scripts/update.py"</span>, <span class="keyword">line</span> 141, <span class="keyword">in</span> DownloadAndUnpack</span><br><span class="line">    DownloadUrl(url, f)</span><br><span class="line">  <span class="keyword">File</span> <span class="string">"src/tools/clang/scripts/update.py"</span>, <span class="keyword">line</span> 100, <span class="keyword">in</span> DownloadUrl</span><br><span class="line">    response = urllib.urlopen(url)</span><br><span class="line">  <span class="keyword">File</span> <span class="string">"/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/urllib2.py"</span>, <span class="keyword">line</span> 154, <span class="keyword">in</span> urlopen</span><br><span class="line">    <span class="keyword">return</span> opener.<span class="keyword">open</span>(url, data, timeout)</span><br><span class="line">  <span class="keyword">File</span> <span class="string">"/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/urllib2.py"</span>, <span class="keyword">line</span> 431, <span class="keyword">in</span> <span class="keyword">open</span></span><br><span class="line">    response = self._open(req, data)</span><br><span class="line">  <span class="keyword">File</span> <span class="string">"/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/urllib2.py"</span>, <span class="keyword">line</span> 449, <span class="keyword">in</span> _open</span><br><span class="line">    '_open', req)</span><br><span class="line">  <span class="keyword">File</span> <span class="string">"/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/urllib2.py"</span>, <span class="keyword">line</span> 409, <span class="keyword">in</span> _call_chain</span><br><span class="line">    result = func(*<span class="keyword">args</span>)</span><br><span class="line">  <span class="keyword">File</span> <span class="string">"/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/urllib2.py"</span>, <span class="keyword">line</span> 1240, <span class="keyword">in</span> https_open</span><br><span class="line">    context=self._context)</span><br><span class="line">  <span class="keyword">File</span> <span class="string">"/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/urllib2.py"</span>, <span class="keyword">line</span> 1194, <span class="keyword">in</span> do_open</span><br><span class="line">    <span class="keyword">h</span>.request(req.get_method(), req.get_selector(), req.data, headers)</span><br><span class="line">  <span class="keyword">File</span> <span class="string">"/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/httplib.py"</span>, <span class="keyword">line</span> 1053, <span class="keyword">in</span> request</span><br><span class="line">    self._send_request(method, url, body, headers)</span><br><span class="line">  <span class="keyword">File</span> <span class="string">"/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/httplib.py"</span>, <span class="keyword">line</span> 1093, <span class="keyword">in</span> _send_request</span><br><span class="line">    self.endheaders(body)</span><br><span class="line">  <span class="keyword">File</span> <span class="string">"/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/httplib.py"</span>, <span class="keyword">line</span> 1049, <span class="keyword">in</span> endheaders</span><br><span class="line">    self._send_output(message_body)</span><br><span class="line">  <span class="keyword">File</span> <span class="string">"/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/httplib.py"</span>, <span class="keyword">line</span> 893, <span class="keyword">in</span> _send_output</span><br><span class="line">    self.send(msg)</span><br><span class="line">  <span class="keyword">File</span> <span class="string">"/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/httplib.py"</span>, <span class="keyword">line</span> 855, <span class="keyword">in</span> send</span><br><span class="line">    self.connect()</span><br><span class="line">  <span class="keyword">File</span> <span class="string">"/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/httplib.py"</span>, <span class="keyword">line</span> 1266, <span class="keyword">in</span> connect</span><br><span class="line">    HTTPConnection.connect(self)</span><br><span class="line">  <span class="keyword">File</span> <span class="string">"/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/httplib.py"</span>, <span class="keyword">line</span> 835, <span class="keyword">in</span> connect</span><br><span class="line">    self._tunnel()</span><br><span class="line">  <span class="keyword">File</span> <span class="string">"/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/httplib.py"</span>, <span class="keyword">line</span> 812, <span class="keyword">in</span> _tunnel</span><br><span class="line">    (<span class="keyword">version</span>, code, message) = response._read_status()</span><br><span class="line">  <span class="keyword">File</span> <span class="string">"/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/httplib.py"</span>, <span class="keyword">line</span> 417, <span class="keyword">in</span> _read_status</span><br><span class="line">    raise BadStatusLine(<span class="keyword">line</span>)</span><br><span class="line">httplib.BadStatusLine: ''</span><br><span class="line"><span class="keyword">Error</span>: Command '/usr/bin/python src/tools/clang/scripts/<span class="keyword">update</span>.py' returned non-zero <span class="keyword">exit</span> status 1 <span class="keyword">in</span> /Users/suntongmian/Documents/develop/webrtc</span><br><span class="line">Hook '/usr/bin/python src/tools/clang/scripts/<span class="keyword">update</span>.py' took 35.18 secs</span><br><span class="line">suntongmiandeMacBook-<span class="keyword">Pro</span>:webrtc suntongmian$</span><br></pre></td></tr></table></figure><h2 id="step-3-2"><a href="#step-3-2" class="headerlink" title="step 3"></a>step 3</h2><p>进入 src 目录，依据 741f9a0679bc70682b056004f8421879352d1a8d 检出一个新分支。741f9a0679bc70682b056004f8421879352d1a8d 是 “选择 Release 版本” 步骤中获取的 M74 Release 版本的 commit 编号信息。在终端执行命令</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd src</span><br><span class="line">git branch M74-<span class="keyword">Release</span> <span class="number">741</span>f9a0679bc70682b056004f8421879352d1a8d</span><br><span class="line">git checkout M74-<span class="keyword">Release</span></span><br><span class="line">git <span class="keyword">log</span></span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">suntongmiandeMacBook-Pro:webrtc suntongmian$ ls</span><br><span class="line">depot_toolssrc</span><br><span class="line">suntongmiandeMacBook-Pro:webrtc suntongmian$ </span><br><span class="line">suntongmiandeMacBook-Pro:webrtc suntongmian$ cd src</span><br><span class="line">suntongmiandeMacBook-Pro:src suntongmian$ </span><br><span class="line">suntongmiandeMacBook-Pro:src suntongmian$ ls</span><br><span class="line">AUTHORS<span class="keyword">call</span>pylintrc</span><br><span class="line">BUILD.gncodereview.settingsresources</span><br><span class="line">CODE_OF_CONDUCT.mdcommon_audiortc_base</span><br><span class="line">DEPScommon_types.hrtc_tools</span><br><span class="line">ENG_REVIEW_OWNERScommon_videosdk</span><br><span class="line">LICENSEcryptostats</span><br><span class="line">OWNERS<span class="keyword">data</span><span class="keyword">style</span>-guide</span><br><span class="line">PATENTSexamples<span class="keyword">style</span>-guide.md</span><br><span class="line">PRESUBMIT.pyiossystem_wrappers</span><br><span class="line">README.chromiumlicense_template.txt<span class="keyword">test</span></span><br><span class="line">README.md<span class="keyword">logging</span>testing</span><br><span class="line">WATCHLISTSmediathird_party</span><br><span class="line">abseil-<span class="keyword">in</span>-webrtc.mdmodulestools</span><br><span class="line">api<span class="keyword">native</span>-api.mdtools_webrtc</span><br><span class="line">audio<span class="keyword">out</span>video</span><br><span class="line">basep2pwebrtc.gni</span><br><span class="line"><span class="keyword">build</span>pcwhitespace.txt</span><br><span class="line">build_overridespresubmit_test.py</span><br><span class="line">buildtoolspresubmit_test_mocks.py</span><br><span class="line">suntongmiandeMacBook-Pro:src suntongmian$ </span><br><span class="line">suntongmiandeMacBook-Pro:src suntongmian$ git branch M74-<span class="keyword">Release</span> <span class="number">741</span>f9a0679bc70682b056004f8421879352d1a8d</span><br><span class="line">suntongmiandeMacBook-Pro:src suntongmian$ </span><br><span class="line">suntongmiandeMacBook-Pro:src suntongmian$ git <span class="keyword">status</span></span><br><span class="line">位于分支 <span class="keyword">master</span></span><br><span class="line">您的分支与上游分支 <span class="string">'origin/master'</span> 一致。</span><br><span class="line"></span><br><span class="line">无文件要提交，干净的工作区</span><br><span class="line">suntongmiandeMacBook-Pro:src suntongmian$ </span><br><span class="line">suntongmiandeMacBook-Pro:src suntongmian$ git branch</span><br><span class="line">  M74-<span class="keyword">Release</span></span><br><span class="line">* <span class="keyword">master</span></span><br><span class="line">suntongmiandeMacBook-Pro:src suntongmian$ </span><br><span class="line">suntongmiandeMacBook-Pro:src suntongmian$ git checkout M74-<span class="keyword">Release</span></span><br><span class="line">切换到分支 <span class="string">'M74-Release'</span></span><br><span class="line">suntongmiandeMacBook-Pro:src suntongmian$ </span><br><span class="line">suntongmiandeMacBook-Pro:src suntongmian$ git <span class="keyword">status</span></span><br><span class="line">位于分支 M74-<span class="keyword">Release</span></span><br><span class="line">无文件要提交，干净的工作区</span><br><span class="line">suntongmiandeMacBook-Pro:src suntongmian$ </span><br><span class="line">suntongmiandeMacBook-Pro:src suntongmian$ git branch</span><br><span class="line">* M74-<span class="keyword">Release</span></span><br><span class="line">  <span class="keyword">master</span></span><br><span class="line">suntongmiandeMacBook-Pro:src suntongmian$ </span><br><span class="line">suntongmiandeMacBook-Pro:src suntongmian$ git <span class="keyword">log</span></span><br><span class="line"><span class="keyword">commit</span> <span class="number">741</span>f9a0679bc70682b056004f8421879352d1a8d (<span class="keyword">HEAD</span> -&gt; M74-<span class="keyword">Release</span>, branch-heads/m74)</span><br><span class="line">Author: Erik Språng &lt;sprang@webrtc.org&gt;</span><br><span class="line"><span class="built_in">Date</span>:   Thu Apr <span class="number">18</span> <span class="number">14</span>:<span class="number">28</span>:<span class="number">02</span> <span class="number">2019</span> +<span class="number">0200</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">Ignore</span> <span class="keyword">duplicate</span> sent packets <span class="keyword">in</span> TransportFeedbackAdapter</span><br><span class="line">    </span><br><span class="line">    Bug: webrtc:<span class="number">10564</span>, chromium:<span class="number">954139</span>, webrtc:<span class="number">10509</span></span><br><span class="line">    <span class="keyword">Change</span>-<span class="keyword">Id</span>: I617b58ef8cf5858d7a81aaa39884c5cc1ac2af6e</span><br><span class="line">    Reviewed-<span class="keyword">on</span>: https://webrtc-review.googlesource.com/c/src/+/<span class="number">133564</span></span><br><span class="line">    <span class="keyword">Commit</span>-Queue: Erik Språng &lt;sprang@webrtc.org&gt;</span><br><span class="line">    Reviewed-<span class="keyword">by</span>: Sebastian Jansson &lt;srte@webrtc.org&gt;</span><br><span class="line">    Cr-Original-<span class="keyword">Commit</span>-<span class="keyword">Position</span>: refs/heads/<span class="keyword">master</span>@&#123;#<span class="number">27689</span>&#125;(cherry picked <span class="keyword">from</span> <span class="keyword">commit</span> d50947ab516ec404b100752617fb828d05cf0e3d)</span><br><span class="line">    Reviewed-<span class="keyword">on</span>: https://webrtc-review.googlesource.com/c/src/+/<span class="number">133579</span></span><br><span class="line">    Cr-<span class="keyword">Commit</span>-<span class="keyword">Position</span>: refs/branch-heads/m74@&#123;#<span class="number">20</span>&#125;</span><br><span class="line">    Cr-Branched-<span class="keyword">From</span>: be7af9399ceb88171bf60b50419ff2dec8184fb9-refs/heads/<span class="keyword">master</span>@&#123;#<span class="number">26981</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">commit</span> e6d5f62d010d7f6284504af1c7898894851b238c</span><br><span class="line">Author: Erik Språng &lt;sprang@webrtc.org&gt;</span><br><span class="line"><span class="built_in">Date</span>:   Wed Apr <span class="number">3</span> <span class="number">20</span>:<span class="number">20</span>:<span class="number">42</span> <span class="number">2019</span> +<span class="number">0200</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">Merge</span> <span class="keyword">to</span> M74: <span class="keyword">Allow</span> setting ALR <span class="keyword">values</span> <span class="keyword">for</span> screen <span class="keyword">content</span> again</span><br><span class="line">    </span><br><span class="line">suntongmiandeMacBook-Pro:src suntongmian$</span><br></pre></td></tr></table></figure><blockquote><h1 id="四、执行编译"><a href="#四、执行编译" class="headerlink" title="四、执行编译"></a>四、执行编译</h1></blockquote><p>在执行编译前，我们需要配置好编译的参数和环境，生产出构建文件。这里就需要用到 <a href="https://gn.googlesource.com/gn/+/master/README.md" target="_blank" rel="noopener">GN</a> 这个工具了。GN 是一个为 Ninja 生成构建文件的元构建系统。<a href="https://ninja-build.org/" target="_blank" rel="noopener">Ninja</a> 是一个小型构建系统，特点是构建速度快。</p><h2 id="step-1-3"><a href="#step-1-3" class="headerlink" title="step 1"></a>step 1</h2><p>使用 GN 来生产 Ninja 工程文件，在终端执行命令</p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">gn</span> gen out/ios --<span class="built_in">args</span>='target_os=<span class="string">"ios"</span> target_cpu=<span class="string">"arm64"</span> is_debug=<span class="literal">true</span>'</span><br></pre></td></tr></table></figure><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">suntongmiandeMacBook-Pro:src suntongmian$ gn gen out/ios <span class="attribute">--args</span>=<span class="string">'target_os="ios" target_cpu="arm64" is_debug=true'</span></span><br><span class="line">Warning: Multiple codesigning identities match <span class="string">"iPhone Developer"</span></span><br><span class="line">Warning: - D78B0B7AF39CEFA4D0F673B4D3AA517D312C97CC (selected)</span><br><span class="line">Warning: - 5634EAED50D1AD95ED76F6AC8298E06590FE476B</span><br><span class="line">Warning: - 2843CD233EB6A93C79C2332E4F4FC601BEDA13BC</span><br><span class="line">Warning: Please use either ios_code_signing_identity <span class="keyword">or</span> </span><br><span class="line">Warning: ios_code_signing_identity_description variable <span class="keyword">to</span> </span><br><span class="line">Warning: control which<span class="built_in"> identity </span>is selected.</span><br><span class="line"></span><br><span class="line">Done. Made 1378 targets <span class="keyword">from</span> 189 files <span class="keyword">in</span> 2200ms</span><br><span class="line">suntongmiandeMacBook-Pro:src suntongmian$</span><br></pre></td></tr></table></figure><p>产生的工程文件在目录 <strong>/src/out/ios</strong> 下。通过命令查看下改目录下有哪些文件，在终端执行命令</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ls</span> <span class="keyword">out</span>/ios</span><br></pre></td></tr></table></figure><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">suntongmiandeMacBook-Pro:src suntongmian$ ls out/ios</span><br><span class="line">args.gn</span><br><span class="line">build.ninja</span><br><span class="line">build<span class="selector-class">.ninja</span><span class="selector-class">.d</span></span><br><span class="line">clang_x64</span><br><span class="line">low_bandwidth_audio_perf_test.runtime_deps</span><br><span class="line">obj</span><br><span class="line">toolchain.ninja</span><br><span class="line">suntongmiandeMacBook-Pro:src suntongmian$</span><br></pre></td></tr></table></figure><h2 id="step-2-3"><a href="#step-2-3" class="headerlink" title="step 2"></a>step 2</h2><p>编译 APP 工程，在终端执行命令</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ninja -C <span class="keyword">out</span>/ios AppRTCMobile</span><br></pre></td></tr></table></figure><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">suntongmiandeMacBook-Pro:src suntongmian$ ninja -C out/ios AppRTCMobile</span><br><span class="line">ninja: Entering directory `out/ios'</span><br><span class="line">[1/2732] CXX obj/api/audio_codecs/audio_codecs_api/audio_codec_pair_id.o</span><br><span class="line">FAILED: obj/api/audio_codecs/audio_codecs_api/audio_codec_pair_id.o </span><br><span class="line"><span class="built_in">..</span>/<span class="built_in">..</span>/third_party/llvm-build/Release+Asserts/bin/clang++ -MMD -MF obj/api/audio_codecs/audio_codecs_api/audio_codec_pair_id.o.d -DNO_TCMALLOC -DCHROMIUM_BUILD <span class="attribute">-DCR_XCODE_VERSION</span>=1020 <span class="attribute">-DCR_CLANG_REVISION</span>=\"357692-1\" -D__STDC_CONSTANT_MACROS -D__STDC_FORMAT_MACROS -D_LIBCPP_ABI_UNSTABLE -D_LIBCPP_DISABLE_VISIBILITY_ANNOTATIONS -D_LIBCXXABI_DISABLE_VISIBILITY_ANNOTATIONS -D_LIBCPP_ENABLE_NODISCARD <span class="attribute">-DCR_LIBCXX_REVISION</span>=358423 -D_DEBUG <span class="attribute">-DDYNAMIC_ANNOTATIONS_ENABLED</span>=1 <span class="attribute">-DWTF_USE_DYNAMIC_ANNOTATIONS</span>=1 <span class="attribute">-DWEBRTC_ENABLE_PROTOBUF</span>=1 -DWEBRTC_INCLUDE_INTERNAL_AUDIO_DEVICE -DRTC_ENABLE_VP9 -DHAVE_SCTP -DWEBRTC_ARCH_ARM64 -DWEBRTC_HAS_NEON -DWEBRTC_LIBRARY_IMPL <span class="attribute">-DWEBRTC_NON_STATIC_TRACE_EVENT_HANDLERS</span>=1 -DWEBRTC_POSIX -DWEBRTC_MAC -DWEBRTC_IOS <span class="attribute">-DABSL_ALLOCATOR_NOTHROW</span>=1 -I<span class="built_in">..</span>/<span class="built_in">..</span> -Igen -I<span class="built_in">..</span>/<span class="built_in">..</span>/third_party/abseil-cpp -fno-strict-aliasing <span class="attribute">--param</span>=ssp-buffer-size=4 -fstack-protector -fcolor-diagnostics -fmerge-all-constants <span class="attribute">-fcrash-diagnostics-dir</span>=../../tools/clang/crashreports -Xclang -mllvm -Xclang <span class="attribute">-instcombine-lower-dbg-declare</span>=0 -fcomplete-member-pointers -arch arm64 -fno-experimental-isel -Wno-builtin-macro-redefined -D__DATE__= -D__TIME__= -D__TIMESTAMP__= -no-canonical-prefixes -Wall -Werror -Wextra -Wimplicit-fallthrough -Wthread-safety -Wextra-semi -Wunguarded-availability -Wundeclared-selector -Wno-missing-field-initializers -Wno-unused-parameter -Wno-c++11-narrowing -Wno-unneeded-internal-declaration -Wno-undefined-var-template -Wno-ignored-pragma-optimize -O0 -fno-omit-frame-pointer -g2 -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS12.2.sdk <span class="attribute">-stdlib</span>=libc++ <span class="attribute">-miphoneos-version-min</span>=10.0 <span class="attribute">-fvisibility</span>=hidden -Wheader-hygiene -Wstring-conversion -Wtautological-overlap-compare -Wexit-time-destructors -Wglobal-constructors -Wextra -Wno-unused-parameter -Wno-missing-field-initializers -Wc++11-narrowing -Wimplicit-fallthrough -Wthread-safety -Winconsistent-missing-override -Wundef -Wunused-lambda-capture -Wno-shorten-64-to-32 -Wno-undefined-bool-conversion -Wno-tautological-undefined-compare <span class="attribute">-std</span>=c++11 -fno-exceptions -fno-rtti -nostdinc++ -isystem<span class="built_in">..</span>/<span class="built_in">..</span>/buildtools/third_party/libc++/trunk/include -isystem<span class="built_in">..</span>/<span class="built_in">..</span>/buildtools/third_party/libc++abi/trunk/include -fvisibility-inlines-hidden -Wnon-virtual-dtor -Woverloaded-virtual -c <span class="built_in">..</span>/<span class="built_in">..</span>/api/audio_codecs/audio_codec_pair_id.cc -o obj/api/audio_codecs/audio_codecs_api/audio_codec_pair_id.o</span><br><span class="line">/bin/sh: <span class="built_in">..</span>/<span class="built_in">..</span>/third_party/llvm-build/Release+Asserts/bin/clang++: <span class="literal">No</span> such file <span class="keyword">or</span> directory</span><br><span class="line">[2/2732] CXX obj/api/audio_codecs/audio_codecs_api/audio_decoder.o</span><br><span class="line">FAILED: obj/api/audio_codecs/audio_codecs_api/audio_decoder.o </span><br><span class="line"><span class="built_in">..</span>/<span class="built_in">..</span>/third_party/llvm-build/Release+Asserts/bin/clang++ -MMD -MF obj/api/audio_codecs/audio_codecs_api/audio_decoder.o.d -DNO_TCMALLOC -DCHROMIUM_BUILD <span class="attribute">-DCR_XCODE_VERSION</span>=1020 <span class="attribute">-DCR_CLANG_REVISION</span>=\"357692-1\" -D__STDC_CONSTANT_MACROS -D__STDC_FORMAT_MACROS -D_LIBCPP_ABI_UNSTABLE -D_LIBCPP_DISABLE_VISIBILITY_ANNOTATIONS -D_LIBCXXABI_DISABLE_VISIBILITY_ANNOTATIONS -D_LIBCPP_ENABLE_NODISCARD <span class="attribute">-DCR_LIBCXX_REVISION</span>=358423 -D_DEBUG <span class="attribute">-DDYNAMIC_ANNOTATIONS_ENABLED</span>=1 <span class="attribute">-DWTF_USE_DYNAMIC_ANNOTATIONS</span>=1 <span class="attribute">-DWEBRTC_ENABLE_PROTOBUF</span>=1 -DWEBRTC_INCLUDE_INTERNAL_AUDIO_DEVICE -DRTC_ENABLE_VP9 -DHAVE_SCTP -DWEBRTC_ARCH_ARM64 -DWEBRTC_HAS_NEON -DWEBRTC_LIBRARY_IMPL <span class="attribute">-DWEBRTC_NON_STATIC_TRACE_EVENT_HANDLERS</span>=1 -DWEBRTC_POSIX -DWEBRTC_MAC -DWEBRTC_IOS <span class="attribute">-DABSL_ALLOCATOR_NOTHROW</span>=1 -I<span class="built_in">..</span>/<span class="built_in">..</span> -Igen -I<span class="built_in">..</span>/<span class="built_in">..</span>/third_party/abseil-cpp -fno-strict-aliasing <span class="attribute">--param</span>=ssp-buffer-size=4 -fstack-protector -fcolor-diagnostics -fmerge-all-constants <span class="attribute">-fcrash-diagnostics-dir</span>=../../tools/clang/crashreports -Xclang -mllvm -Xclang <span class="attribute">-instcombine-lower-dbg-declare</span>=0 -fcomplete-member-pointers -arch arm64 -fno-experimental-isel -Wno-builtin-macro-redefined -D__DATE__= -D__TIME__= -D__TIMESTAMP__= -no-canonical-prefixes -Wall -Werror -Wextra -Wimplicit-fallthrough -Wthread-safety -Wextra-semi -Wunguarded-availability -Wundeclared-selector -Wno-missing-field-initializers -Wno-unused-parameter -Wno-c++11-narrowing -Wno-unneeded-internal-declaration -Wno-undefined-var-template -Wno-ignored-pragma-optimize -O0 -fno-omit-frame-pointer -g2 -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS12.2.sdk <span class="attribute">-stdlib</span>=libc++ <span class="attribute">-miphoneos-version-min</span>=10.0 <span class="attribute">-fvisibility</span>=hidden -Wheader-hygiene -Wstring-conversion -Wtautological-overlap-compare -Wexit-time-destructors -Wglobal-constructors -Wextra -Wno-unused-parameter -Wno-missing-field-initializers -Wc++11-narrowing -Wimplicit-fallthrough -Wthread-safety -Winconsistent-missing-override -Wundef -Wunused-lambda-capture -Wno-shorten-64-to-32 -Wno-undefined-bool-conversion -Wno-tautological-undefined-compare <span class="attribute">-std</span>=c++11 -fno-exceptions -fno-rtti -nostdinc++ -isystem<span class="built_in">..</span>/<span class="built_in">..</span>/buildtools/third_party/libc++/trunk/include -isystem<span class="built_in">..</span>/<span class="built_in">..</span>/buildtools/third_party/libc++abi/trunk/include -fvisibility-inlines-hidden -Wnon-virtual-dtor -Woverloaded-virtual -c <span class="built_in">..</span>/<span class="built_in">..</span>/api/audio_codecs/audio_decoder.cc -o obj/api/audio_codecs/audio_codecs_api/audio_decoder.o</span><br><span class="line">/bin/sh: <span class="built_in">..</span>/<span class="built_in">..</span>/third_party/llvm-build/Release+Asserts/bin/clang++: <span class="literal">No</span> such file <span class="keyword">or</span> directory</span><br><span class="line">[3/2732] CXX obj/api/audio_codecs/audio_codecs_api/audio_encoder.o</span><br><span class="line">FAILED: obj/api/audio_codecs/audio_codecs_api/audio_encoder.o </span><br><span class="line"><span class="built_in">..</span>/<span class="built_in">..</span>/third_party/llvm-build/Release+Asserts/bin/clang++ -MMD -MF obj/api/audio_codecs/audio_codecs_api/audio_encoder.o.d -DNO_TCMALLOC -DCHROMIUM_BUILD <span class="attribute">-DCR_XCODE_VERSION</span>=1020 <span class="attribute">-DCR_CLANG_REVISION</span>=\"357692-1\" -D__STDC_CONSTANT_MACROS -D__STDC_FORMAT_MACROS -D_LIBCPP_ABI_UNSTABLE -D_LIBCPP_DISABLE_VISIBILITY_ANNOTATIONS -D_LIBCXXABI_DISABLE_VISIBILITY_ANNOTATIONS -D_LIBCPP_ENABLE_NODISCARD <span class="attribute">-DCR_LIBCXX_REVISION</span>=358423 -D_DEBUG <span class="attribute">-DDYNAMIC_ANNOTATIONS_ENABLED</span>=1 <span class="attribute">-DWTF_USE_DYNAMIC_ANNOTATIONS</span>=1 <span class="attribute">-DWEBRTC_ENABLE_PROTOBUF</span>=1 -DWEBRTC_INCLUDE_INTERNAL_AUDIO_DEVICE -DRTC_ENABLE_VP9 -DHAVE_SCTP -DWEBRTC_ARCH_ARM64 -DWEBRTC_HAS_NEON -DWEBRTC_LIBRARY_IMPL <span class="attribute">-DWEBRTC_NON_STATIC_TRACE_EVENT_HANDLERS</span>=1 -DWEBRTC_POSIX -DWEBRTC_MAC -DWEBRTC_IOS <span class="attribute">-DABSL_ALLOCATOR_NOTHROW</span>=1 -I<span class="built_in">..</span>/<span class="built_in">..</span> -Igen -I<span class="built_in">..</span>/<span class="built_in">..</span>/third_party/abseil-cpp -fno-strict-aliasing <span class="attribute">--param</span>=ssp-buffer-size=4 -fstack-protector -fcolor-diagnostics -fmerge-all-constants <span class="attribute">-fcrash-diagnostics-dir</span>=../../tools/clang/crashreports -Xclang -mllvm -Xclang <span class="attribute">-instcombine-lower-dbg-declare</span>=0 -fcomplete-member-pointers -arch arm64 -fno-experimental-isel -Wno-builtin-macro-redefined -D__DATE__= -D__TIME__= -D__TIMESTAMP__= -no-canonical-prefixes -Wall -Werror -Wextra -Wimplicit-fallthrough -Wthread-safety -Wextra-semi -Wunguarded-availability -Wundeclared-selector -Wno-missing-field-initializers -Wno-unused-parameter -Wno-c++11-narrowing -Wno-unneeded-internal-declaration -Wno-undefined-var-template -Wno-ignored-pragma-optimize -O0 -fno-omit-frame-pointer -g2 -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS12.2.sdk <span class="attribute">-stdlib</span>=libc++ <span class="attribute">-miphoneos-version-min</span>=10.0 <span class="attribute">-fvisibility</span>=hidden -Wheader-hygiene -Wstring-conversion -Wtautological-overlap-compare -Wexit-time-destructors -Wglobal-constructors -Wextra -Wno-unused-parameter -Wno-missing-field-initializers -Wc++11-narrowing -Wimplicit-fallthrough -Wthread-safety -Winconsistent-missing-override -Wundef -Wunused-lambda-capture -Wno-shorten-64-to-32 -Wno-undefined-bool-conversion -Wno-tautological-undefined-compare <span class="attribute">-std</span>=c++11 -fno-exceptions -fno-rtti -nostdinc++ -isystem<span class="built_in">..</span>/<span class="built_in">..</span>/buildtools/third_party/libc++/trunk/include -isystem<span class="built_in">..</span>/<span class="built_in">..</span>/buildtools/third_party/libc++abi/trunk/include -fvisibility-inlines-hidden -Wnon-virtual-dtor -Woverloaded-virtual -c <span class="built_in">..</span>/<span class="built_in">..</span>/api/audio_codecs/audio_encoder.cc -o obj/api/audio_codecs/audio_codecs_api/audio_encoder.o</span><br><span class="line">/bin/sh: <span class="built_in">..</span>/<span class="built_in">..</span>/third_party/llvm-build/Release+Asserts/bin/clang++: <span class="literal">No</span> such file <span class="keyword">or</span> directory</span><br><span class="line">[6/2732] CXX obj/api/audio_codecs/ilbc<span class="built_in">..</span>.udio_encoder_ilbc/audio_encoder_ilbc.o</span><br><span class="line">FAILED: obj/api/audio_codecs/ilbc/audio_encoder_ilbc/audio_encoder_ilbc.o </span><br><span class="line"><span class="built_in">..</span>/<span class="built_in">..</span>/third_party/llvm-build/Release+Asserts/bin/clang++ -MMD -MF obj/api/audio_codecs/ilbc/audio_encoder_ilbc/audio_encoder_ilbc.o.d -DNO_TCMALLOC -DCHROMIUM_BUILD <span class="attribute">-DCR_XCODE_VERSION</span>=1020 <span class="attribute">-DCR_CLANG_REVISION</span>=\"357692-1\" -D__STDC_CONSTANT_MACROS -D__STDC_FORMAT_MACROS -D_LIBCPP_ABI_UNSTABLE -D_LIBCPP_DISABLE_VISIBILITY_ANNOTATIONS -D_LIBCXXABI_DISABLE_VISIBILITY_ANNOTATIONS -D_LIBCPP_ENABLE_NODISCARD <span class="attribute">-DCR_LIBCXX_REVISION</span>=358423 -D_DEBUG <span class="attribute">-DDYNAMIC_ANNOTATIONS_ENABLED</span>=1 <span class="attribute">-DWTF_USE_DYNAMIC_ANNOTATIONS</span>=1 <span class="attribute">-DWEBRTC_ENABLE_PROTOBUF</span>=1 -DWEBRTC_INCLUDE_INTERNAL_AUDIO_DEVICE -DRTC_ENABLE_VP9 -DHAVE_SCTP -DWEBRTC_ARCH_ARM64 -DWEBRTC_HAS_NEON -DWEBRTC_LIBRARY_IMPL <span class="attribute">-DWEBRTC_NON_STATIC_TRACE_EVENT_HANDLERS</span>=1 -DWEBRTC_POSIX -DWEBRTC_MAC -DWEBRTC_IOS <span class="attribute">-DABSL_ALLOCATOR_NOTHROW</span>=1 -I<span class="built_in">..</span>/<span class="built_in">..</span> -Igen -I<span class="built_in">..</span>/<span class="built_in">..</span>/third_party/abseil-cpp -fno-strict-aliasing <span class="attribute">--param</span>=ssp-buffer-size=4 -fstack-protector -fcolor-diagnostics -fmerge-all-constants <span class="attribute">-fcrash-diagnostics-dir</span>=../../tools/clang/crashreports -Xclang -mllvm -Xclang <span class="attribute">-instcombine-lower-dbg-declare</span>=0 -fcomplete-member-pointers -arch arm64 -fno-experimental-isel -Wno-builtin-macro-redefined -D__DATE__= -D__TIME__= -D__TIMESTAMP__= -no-canonical-prefixes -Wall -Werror -Wextra -Wimplicit-fallthrough -Wthread-safety -Wextra-semi -Wunguarded-availability -Wundeclared-selector -Wno-missing-field-initializers -Wno-unused-parameter -Wno-c++11-narrowing -Wno-unneeded-internal-declaration -Wno-undefined-var-template -Wno-ignored-pragma-optimize -O0 -fno-omit-frame-pointer -g2 -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS12.2.sdk <span class="attribute">-stdlib</span>=libc++ <span class="attribute">-miphoneos-version-min</span>=10.0 <span class="attribute">-fvisibility</span>=hidden -Wheader-hygiene -Wstring-conversion -Wtautological-overlap-compare -Wexit-time-destructors -Wglobal-constructors -Wextra -Wno-unused-parameter -Wno-missing-field-initializers -Wc++11-narrowing -Wimplicit-fallthrough -Wthread-safety -Winconsistent-missing-override -Wundef -Wunused-lambda-capture -Wno-shorten-64-to-32 -Wno-undefined-bool-conversion -Wno-tautological-undefined-compare <span class="attribute">-std</span>=c++11 -fno-exceptions -fno-rtti -nostdinc++ -isystem<span class="built_in">..</span>/<span class="built_in">..</span>/buildtools/third_party/libc++/trunk/include -isystem<span class="built_in">..</span>/<span class="built_in">..</span>/buildtools/third_party/libc++abi/trunk/include -fvisibility-inlines-hidden -Wnon-virtual-dtor -Woverloaded-virtual -c <span class="built_in">..</span>/<span class="built_in">..</span>/api/audio_codecs/ilbc/audio_encoder_ilbc.cc -o obj/api/audio_codecs/ilbc/audio_encoder_ilbc/audio_encoder_ilbc.o</span><br><span class="line">/bin/sh: <span class="built_in">..</span>/<span class="built_in">..</span>/third_party/llvm-build/Release+Asserts/bin/clang++: <span class="literal">No</span> such file <span class="keyword">or</span> directory</span><br><span class="line">ninja: build stopped: subcommand failed.</span><br><span class="line">suntongmiandeMacBook-Pro:src suntongmian$</span><br></pre></td></tr></table></figure><h2 id="step-3-3"><a href="#step-3-3" class="headerlink" title="step 3"></a>step 3</h2><p>编译 WebRTC 库文件的方法有2种，分别为 ninja 命令行，python 脚本。</p><h3 id="方法-1"><a href="#方法-1" class="headerlink" title="方法 1"></a>方法 1</h3><p>使用 <code>ninja</code> 命令行编译，在终端执行命令</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ninja -C <span class="keyword">out</span>/ios framework_objc</span><br></pre></td></tr></table></figure><p>生成的库文件在 <code>out/ios</code> 目录下。</p><h3 id="方法-2"><a href="#方法-2" class="headerlink" title="方法 2"></a>方法 2</h3><p>使用 python 脚本 <code>/src/tools_webrtc/ios/build_ios_libs.py</code> 编译，在终端执行命令</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python tools_webrtc/ios/build_ios_libs<span class="selector-class">.py</span> --bitcode</span><br></pre></td></tr></table></figure><p>生成的库文件在 <code>out_ios_lib</code> 目录下。</p><blockquote><h1 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h1></blockquote><p>[1] <a href="https://webrtc.org/" target="_blank" rel="noopener">WebRTC Home</a></p><p>[2] <a href="https://www.w3.org/2017/11/media-advisory-webrtc10-cr.html.en" target="_blank" rel="noopener">WebRTC becomes design-complete strengthening the Web Platform as a solid actor in the telecommunications arena</a></p><p>[3] <a href="https://www.w3.org/TR/2017/CR-webrtc-20171102/" target="_blank" rel="noopener">WebRTC 1.0: Real-time Communication Between Browsers</a>, W3C Candidate Recommendation 02 November 2017</p><p>[4] <a href="https://www.w3.org/TR/webrtc/" target="_blank" rel="noopener">WebRTC 1.0: Real-time Communication Between Browsers</a>, W3C Candidate Recommendation 27 September 2018</p><p>[5] <a href="https://webrtc.googlesource.com/src" target="_blank" rel="noopener">WebRTC SRC</a></p><p>[6] <a href="https://webrtc.org/release-notes/" target="_blank" rel="noopener">WebRTC Release Notes</a> </p><p>[7] <a href="https://webrtc.org/native-code/development/" target="_blank" rel="noopener">WebRTC Native Code, Development</a></p><p>[8] <a href="https://webrtc.org/native-code/ios/" target="_blank" rel="noopener">WebRTC Native Code, iOS</a></p><p>[9] <a href="https://www.chromium.org/developers/how-tos/depottools" target="_blank" rel="noopener">Using depot_tools</a></p><p>[10] <a href="https://commondatastorage.googleapis.com/chrome-infra-docs/flat/depot_tools/docs/html/depot_tools_tutorial.html" target="_blank" rel="noopener">depot_tools_tutorial(7) Manual Page</a></p><p>[11] <a href="https://blog.csdn.net/jiajiayouba/article/details/81453398" target="_blank" rel="noopener">MAC 终端走代理服务器</a></p><p>[12] <a href="https://gn.googlesource.com/gn/+/master/README.md" target="_blank" rel="noopener">GN</a></p><p>[13] <a href="https://ninja-build.org/" target="_blank" rel="noopener">Ninja</a></p><p>[14] <a href="https://blog.csdn.net/mogoweb/article/details/73650218" target="_blank" rel="noopener">chromium中的GN构建系统</a></p><p>[15] <a href="https://www.wolfcstech.com/2016/11/16/ChromiumGN%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%E7%9A%84%E4%BD%BF%E7%94%A8/" target="_blank" rel="noopener">Chromium GN构建工具的使用</a></p><p>[16] <a href="https://blog.csdn.net/liuchunming033/article/details/45368237" target="_blank" rel="noopener">【Git学习笔记】Git冲突：commit your changes or stash them before you can merge.</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> 音视频处理 </tag>
            
            <tag> WebRTC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WebRTC 开发（一）引言</title>
      <link href="/2019/05/01/webrtc-development-1-preface/"/>
      <url>/2019/05/01/webrtc-development-1-preface/</url>
      
        <content type="html"><![CDATA[<p>三年前在 <a href="https://depthlove.github.io/2016/10/14/Interactive-live-broadcast/">《聊一聊互动直播》</a>中一文中谈了些对 WebRTC 和 RTC 的看法。现在 WebRTC 的热度不断攀升，我对 WebRTC 的热情也是一度高涨的，对实时音视频以及大数据、机器学习、深度学习这些方向的发展一直保持着关注。在<a href="https://www.qiniu.com/" target="_blank" rel="noopener">七牛云</a>工作了三年，这三年的远程办公经历，总结下来就是太忙了，工作和私人时间搅合在一起，感觉一天二十四小时都在工作，有些疲惫不堪，但收获也是有的。而今，经过一段时间的休息调整，状态恢复的不错，有时间思考，有时间写写自己的看法，还有点时间感受生活。</p><p>摧毁一个人，最直接最暴力的方式就是让他没有时间思考。没有时间思考的人，也是一个不懂得交流的人。如果一个人没有时间思考，也就没有自己的想法，更谈不上与人交流产生火花。时间是个很神奇的东西，能成就人，也能让人“几十年如一日”没有长进。特别是做程序员这行，思考力与实践力至关重要。对于生活与工作，作为人，我们更需要思考，会工作会生活。</p><a id="more"></a><p>2015年接触 WebRTC，那时候我还在深圳工作，2016年去了北京工作，在这四年多时间里，虽然一直都在从事 WebRTC 以及其它音视频相关的工作，我自认为在 WebRTC 这块还需要深入钻研，毕竟音视频这块的东西，要做的深入是必须要对音视频理论和流媒体协议掌握的有足够深度。在一个方向上走的越远，就越觉得掌握的东西越少。实践是检验真理的唯一标准，这个实践可以是完成一个小项目，写一篇文章，也可以是一场面试，一次与高手过招。所以，我就想写写关于 WebRTC 的一些分析性的文章，回顾过去，记录现在，以及展望将来。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 音视频处理 </tag>
            
            <tag> WebRTC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BF 算法与 KMP 算法</title>
      <link href="/2019/04/29/bf-algorithm-and-kmp-algorithm/"/>
      <url>/2019/04/29/bf-algorithm-and-kmp-algorithm/</url>
      
        <content type="html"><![CDATA[<p>最近温习数据结构与算法，在学习字符串的匹配算法 BM 算法、KMP 算法时，看到了两篇关于 KMP 算法讲解的文章，写的很经典。</p><ul><li><p>阮一峰写的 <a href="http://www.ruanyifeng.com/blog/2013/05/Knuth%E2%80%93Morris%E2%80%93Pratt_algorithm.html" target="_blank" rel="noopener">字符串匹配的KMP算法</a> </p></li><li><p><a href="https://blog.csdn.net/v_july_v/article/details/7041827" target="_blank" rel="noopener">从头到尾彻底理解KMP</a></p></li></ul><p>BF 算法、KMP 算法匹配过程如下：</p><p>主串 S：“BBC ABCDAB ABCDABCDABDE”</p><p>模式串 P：”ABCDABD”</p><p>BM 算法很简单，就是暴力匹配，以主串 S 为基准，模式串 P 从主串 S 的串头单步向后移动匹配到主串 S 的串尾。</p><a id="more"></a><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">step <span class="number">1.</span></span><br><span class="line">BBC ABCDAB ABCDABCDABDE</span><br><span class="line">ABCDABD</span><br><span class="line"></span><br><span class="line">step <span class="number">2.</span></span><br><span class="line">BBC ABCDAB ABCDABCDABDE</span><br><span class="line"> ABCDABD                 单步移动</span><br><span class="line"></span><br><span class="line">step <span class="number">3.</span></span><br><span class="line">BBC ABCDAB ABCDABCDABDE</span><br><span class="line">  ABCDABD                单步移动</span><br><span class="line"></span><br><span class="line">step <span class="number">4.</span></span><br><span class="line">BBC ABCDAB ABCDABCDABDE</span><br><span class="line">    ABCDABD              单步移动</span><br><span class="line">    </span><br><span class="line">...                      单步移动</span><br><span class="line"></span><br><span class="line">step <span class="number">11.</span></span><br><span class="line">BBC ABCDAB ABCDABCDABDE</span><br><span class="line">           ABCDABD       单步移动</span><br><span class="line">           </span><br><span class="line">...                      单步移动</span><br><span class="line">           </span><br><span class="line">step <span class="number">16.</span> （经过<span class="number">16</span>个回合匹配成功，模式串 P 相对于主串 S 向后移动了<span class="number">15</span>个位置）</span><br><span class="line">BBC ABCDAB ABCDABCDABDE</span><br><span class="line">               ABCDABD</span><br></pre></td></tr></table></figure><p>KMP 算法相比 BM 算法高效的原因在于，当模式串 P 的某个字符与主串 S 的字符不匹配时，模式串不是单步向后移动，而是向后跳跃几个位置再与主串 S 匹配。至于跳跃移动的步数，就是 KMP 算法的核心，即求 next。</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">求取 <span class="keyword">next</span> 的公式：</span><br><span class="line">移动位数 <span class="keyword">next</span> = 已匹配的字符数 - 对应的部分匹配值</span><br><span class="line"></span><br><span class="line">对应的部分匹配值的计算公式：</span><br><span class="line">对应的部分匹配值 = 已匹配的字符数构成的字符串的前缀和后缀的共同字符串的最大长度</span><br></pre></td></tr></table></figure><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">step <span class="number">1.</span></span><br><span class="line">BBC ABCDAB ABCDABCDABDE</span><br><span class="line">ABCDABD                  next = <span class="number">0</span> - <span class="number">0</span> = <span class="number">0</span>，匹配<span class="number">0</span>个字符，ABCDAB 前缀后缀共同的最长元素 空 的长度为 <span class="number">0</span></span><br><span class="line"></span><br><span class="line">step <span class="number">2.</span>（向后移动：<span class="number">1</span>）</span><br><span class="line">BBC ABCDAB ABCDABCDABDE</span><br><span class="line"> ABCDABD                 next = <span class="number">0</span> - <span class="number">0</span> = <span class="number">0</span>，匹配<span class="number">0</span>个字符，ABCDAB 前缀后缀共同的最长元素 空 的长度为 <span class="number">0</span></span><br><span class="line"></span><br><span class="line">step <span class="number">3.</span>（向后移动：<span class="number">1</span>）</span><br><span class="line">BBC ABCDAB ABCDABCDABDE</span><br><span class="line">  ABCDABD                next = <span class="number">0</span> - <span class="number">0</span> = <span class="number">0</span>，匹配<span class="number">0</span>个字符，ABCDAB 前缀后缀共同的最长元素 空 的长度为 <span class="number">0</span></span><br><span class="line">  </span><br><span class="line">step <span class="number">4.</span>（向后移动：<span class="number">1</span>）</span><br><span class="line">BBC ABCDAB ABCDABCDABDE</span><br><span class="line">   ABCDABD               next = <span class="number">0</span> - <span class="number">0</span> = <span class="number">0</span>，匹配<span class="number">0</span>个字符，ABCDAB 前缀后缀共同的最长元素 空 的长度为 <span class="number">0</span></span><br><span class="line"></span><br><span class="line">step <span class="number">5.</span>（向后移动：<span class="number">1</span>）</span><br><span class="line">BBC ABCDAB ABCDABCDABDE</span><br><span class="line">    ABCDABD              next = <span class="number">6</span> - <span class="number">2</span> = <span class="number">4</span>，匹配<span class="number">6</span>个字符，ABCDAB 前缀后缀共同的最长元素 AB 的长度为 <span class="number">2</span></span><br><span class="line">    </span><br><span class="line">step <span class="number">6.</span>（向后移动：<span class="number">4</span>）</span><br><span class="line">BBC ABCDAB ABCDABCDABDE</span><br><span class="line">        ABCDABD          next = <span class="number">2</span> - <span class="number">0</span> = <span class="number">2</span>，匹配<span class="number">2</span>个字符，AB 前缀后缀共同的最长元素 空 的长度为 <span class="number">0</span></span><br><span class="line"></span><br><span class="line">step <span class="number">7.</span>（向后移动：<span class="number">2</span>）</span><br><span class="line">BBC ABCDAB ABCDABCDABDE</span><br><span class="line">          ABCDABD        next = <span class="number">0</span> - <span class="number">0</span> = <span class="number">0</span>，匹配<span class="number">0</span>个字符，ABCDAB 前缀后缀共同的最长元素 空 的长度为 <span class="number">0</span></span><br><span class="line"></span><br><span class="line">step <span class="number">8.</span>（向后移动：<span class="number">1</span>）</span><br><span class="line">BBC ABCDAB ABCDABCDABDE</span><br><span class="line">           ABCDABD       next = <span class="number">6</span> - <span class="number">2</span> = <span class="number">4</span>，匹配<span class="number">6</span>个字符，ABCDAB 前缀后缀共同的最长元素 AB 的长度为 <span class="number">2</span></span><br><span class="line">           </span><br><span class="line">step <span class="number">9.</span>（向后移动：<span class="number">4</span>。</span><br><span class="line">          经过<span class="number">9</span>个回合匹配成功，模式串 P 相对于主串 S 向后移动了<span class="number">15</span>个位置）</span><br><span class="line">BBC ABCDAB ABCDABCDABDE</span><br><span class="line">               ABCDABD</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> 数据结构与算法 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>音视频开发技能列表</title>
      <link href="/2019/04/10/audio-and-video-development-skills-list/"/>
      <url>/2019/04/10/audio-and-video-development-skills-list/</url>
      
        <content type="html"><![CDATA[<blockquote><h2 id="流媒体协议"><a href="#流媒体协议" class="headerlink" title="流媒体协议"></a>流媒体协议</h2></blockquote><h3 id="RTMP"><a href="#RTMP" class="headerlink" title="RTMP"></a>RTMP</h3><p><a href="https://www.jianshu.com/p/b2144f9bbe28" target="_blank" rel="noopener">带你吃透RTMP</a><br><a href="https://www.jianshu.com/p/00aceabce944" target="_blank" rel="noopener">直播推流实现RTMP协议的一些注意事项</a></p><a id="more"></a><h3 id="HLS"><a href="#HLS" class="headerlink" title="HLS"></a>HLS</h3><h3 id="RTSP"><a href="#RTSP" class="headerlink" title="RTSP"></a>RTSP</h3><p><a href="https://juejin.im/entry/59269396a0bb9f0057c5c65e" target="_blank" rel="noopener">Live555 源码解析 (2) - RTSP 协议概述</a></p><h3 id="SDP"><a href="#SDP" class="headerlink" title="SDP"></a>SDP</h3><p><a href="https://www.cnblogs.com/qingquan/archive/2011/08/02/2125585.html" target="_blank" rel="noopener">SDP 协议分析</a><br><a href="https://zouhualong.oschina.io/pages/blog/voip/VoIP-SIP-SDP" target="_blank" rel="noopener">SDP</a><br><a href="https://blog.csdn.net/machh/article/details/51873690" target="_blank" rel="noopener">SDP协议解析</a></p><h3 id="RTP、RTCP"><a href="#RTP、RTCP" class="headerlink" title="RTP、RTCP"></a>RTP、RTCP</h3><p><a href="https://blog.csdn.net/bripengandre/article/details/2238818" target="_blank" rel="noopener">RTP协议分析</a><br><a href="https://blog.csdn.net/machh/article/details/51868569" target="_blank" rel="noopener">RTP/RTCP协议解析</a><br><a href="https://mp.weixin.qq.com/s/Or7nhl2pGkSgQZwLhl5U3Q" target="_blank" rel="noopener">WebRTC的RTP、RTCP协议实现分析</a></p><blockquote><h2 id="传输层协议"><a href="#传输层协议" class="headerlink" title="传输层协议"></a>传输层协议</h2></blockquote><h3 id="TCP、UDP"><a href="#TCP、UDP" class="headerlink" title="TCP、UDP"></a>TCP、UDP</h3><p>极客时间的专栏 <a href="https://time.geekbang.org/column/intro/100007101?utm_term=zeusAQ46L&amp;utm_source=weibo&amp;utm_medium=liaoxuefeng&amp;utm_campaign=164-presell&amp;utm_content=weibo" target="_blank" rel="noopener">趣谈网络协议</a></p><h3 id="QUIC"><a href="#QUIC" class="headerlink" title="QUIC"></a>QUIC</h3><p><a href="https://mp.weixin.qq.com/s/_RAXrlGPeN_3D6dhJFf6Qg" target="_blank" rel="noopener">科普：QUIC协议原理分析</a><br><a href="https://mp.weixin.qq.com/s/NbewZ1NU49qSjIcdFrpotw" target="_blank" rel="noopener">QUIC协议初探-iOS实践</a><br><a href="https://mp.weixin.qq.com/s/_RAXrlGPeN_3D6dhJFf6Qg" target="_blank" rel="noopener">让互联网更快的协议，QUIC在腾讯的实践及性能优化</a></p><blockquote><h2 id="文件格式"><a href="#文件格式" class="headerlink" title="文件格式"></a>文件格式</h2></blockquote><h3 id="FLV"><a href="#FLV" class="headerlink" title="FLV"></a>FLV</h3><p><a href="https://blog.csdn.net/hejjunlin/article/details/73322063" target="_blank" rel="noopener">H.264标准（二）FLV封装格式详解</a><br><a href="http://blog.csdn.net/yeyumin89/article/details/7932368" target="_blank" rel="noopener">将h.264视频流封装成flv格式文件（一.flv格式）</a><br><a href="http://blog.csdn.net/yeyumin89/article/details/7932431" target="_blank" rel="noopener">将h.264视频流封装成flv格式文件（二.开始动手）</a><br><a href="https://www.jianshu.com/p/d68d6efe8230" target="_blank" rel="noopener">FFmpeg从入门到出家（FLV文件结构解析）</a></p><blockquote><h2 id="编解码"><a href="#编解码" class="headerlink" title="编解码"></a>编解码</h2></blockquote><h3 id="H-264-AVC"><a href="#H-264-AVC" class="headerlink" title="H.264/AVC"></a>H.264/AVC</h3><p><a href="https://blog.csdn.net/Ch97CKd/article/details/78237080" target="_blank" rel="noopener">深入浅出理解视频编码H.264结构</a><br><a href="https://blog.csdn.net/romantic_energy/article/details/50508332" target="_blank" rel="noopener">H.264流媒体协议格式中的Annex B格式和AVCC格式深度解析</a><br><a href="https://blog.csdn.net/yue_huang/article/details/75126155" target="_blank" rel="noopener">码流格式: Annex-B, AVCC(H.264)与HVCC(H.265), extradata详解</a></p><h3 id="H-265-HEVC"><a href="#H-265-HEVC" class="headerlink" title="H.265/HEVC"></a>H.265/HEVC</h3><p><a href="https://www.jianshu.com/p/dd5907ccc1a1" target="_blank" rel="noopener">FFmpeg从入门到出家（HEVC在RTMP中的扩展）</a><br><a href="https://www.jianshu.com/p/cb93e618e041" target="_blank" rel="noopener">基于iOS11的HEVC(H.265)硬编码/硬解码功能开发指南</a><br><a href="http://taobaofed.org/blog/2019/03/18/web-player-h265" target="_blank" rel="noopener">Web端H.265播放器研发解密</a></p><h3 id="AAC"><a href="#AAC" class="headerlink" title="AAC"></a>AAC</h3><h3 id="SEI"><a href="#SEI" class="headerlink" title="SEI"></a>SEI</h3><p><a href="https://www.jianshu.com/p/fa018c403a0a" target="_blank" rel="noopener">FFmpeg从入门到精通——进阶篇，SEI那些事儿</a></p><blockquote><h2 id="开源工具"><a href="#开源工具" class="headerlink" title="开源工具"></a>开源工具</h2></blockquote><h3 id="FFmpeg"><a href="#FFmpeg" class="headerlink" title="FFmpeg"></a>FFmpeg</h3><p><a href="https://github.com/FFmpeg/FFmpeg" target="_blank" rel="noopener">FFmpeg</a></p><p><a href="https://github.com/kewlbear/FFmpeg-iOS-build-script" target="_blank" rel="noopener">FFmpeg-iOS-build-script</a></p><p><a href="https://www.jianshu.com/p/aae7af2d9bd1" target="_blank" rel="noopener">FFmpeg从入门到出家（FFmpeg简析）</a></p><h3 id="fdk-aac"><a href="#fdk-aac" class="headerlink" title="fdk-aac"></a>fdk-aac</h3><p><a href="https://sourceforge.net/projects/opencore-amr/files/fdk-aac" target="_blank" rel="noopener">fdk-aac</a></p><p><a href="https://github.com/kewlbear/fdk-aac-build-script-for-iOS" target="_blank" rel="noopener">fdk-aac-iOS-build-script</a></p><h3 id="x264"><a href="#x264" class="headerlink" title="x264"></a>x264</h3><p><a href="https://www.videolan.org/developers/x264.html" target="_blank" rel="noopener">x264</a></p><p><a href="https://github.com/kewlbear/x264-ios" target="_blank" rel="noopener">x264-iOS-build-script</a></p><h3 id="WebRTC"><a href="#WebRTC" class="headerlink" title="WebRTC"></a>WebRTC</h3><p><a href="https://mp.weixin.qq.com/s/H3YOpvB2Jq-YedgjRvwf1g" target="_blank" rel="noopener">一张图解释WebRTC底层协议结构</a><br><a href="https://webrtc.org.cn/real-world-webrtc-1" target="_blank" rel="noopener">实际中的WebRTC：STUN，TURN以及信令（一）</a><br><a href="https://www.cnblogs.com/lingyunhu" target="_blank" rel="noopener">RTC 专栏</a><br><a href="https://webrtchacks.com" target="_blank" rel="noopener">webrtchacks</a><br><a href="https://blog.piasy.com/index.html" target="_blank" rel="noopener">WebRTC Native 源码导读</a></p><h3 id="LIVE555"><a href="#LIVE555" class="headerlink" title="LIVE555"></a>LIVE555</h3><p><a href="https://github.com/rgaufman/live555" target="_blank" rel="noopener">LIVE555</a></p><p><a href="https://blog.csdn.net/leixiaohua1020/article/details/12235615" target="_blank" rel="noopener">live555源代码分析</a><br><a href="https://blog.csdn.net/leixiaohua1020/article/details/12022409" target="_blank" rel="noopener">live555 源代码简单分析1：主程序</a><br><a href="https://blog.csdn.net/leixiaohua1020/article/details/12748025" target="_blank" rel="noopener">live555 分析—— OpenRtsp</a><br><a href="https://blog.csdn.net/leixiaohua1020/article/details/11850907" target="_blank" rel="noopener">live555学习笔记－RTSP服务运作</a><br><a href="https://blog.csdn.net/leixiaohua1020/article/details/11850969" target="_blank" rel="noopener">live555学习笔记－RTP打包与发送</a><br><a href="https://blog.csdn.net/leixiaohua1020/article/details/11851311" target="_blank" rel="noopener">live555学习笔记－RTSPClient分析</a></p><h3 id="SRS"><a href="#SRS" class="headerlink" title="SRS"></a>SRS</h3><p><a href="https://github.com/ossrs/srs" target="_blank" rel="noopener">SRS</a></p><h3 id="NGINX-RTMP"><a href="#NGINX-RTMP" class="headerlink" title="NGINX-RTMP"></a>NGINX-RTMP</h3><p><a href="https://github.com/arut/nginx-rtmp-module" target="_blank" rel="noopener">nginx-rtmp-module</a></p><blockquote><h2 id="OpenGL"><a href="#OpenGL" class="headerlink" title="OpenGL"></a>OpenGL</h2></blockquote><h3 id="基础概念"><a href="#基础概念" class="headerlink" title="基础概念"></a>基础概念</h3><p><a href="https://mp.weixin.qq.com/s/B4GxcNz9bybC6aUcnclVLw" target="_blank" rel="noopener">20分钟让你了解OpenGL ——OpenGL全流程详细解读</a><br><a href="https://www.cnblogs.com/salam/archive/2016/01/08/5113572.html" target="_blank" rel="noopener">一篇通俗易懂的讲解OpenGL ES的文章</a><br><a href="http://blog.csdn.net/wangyuchun_799/article/details/7736928" target="_blank" rel="noopener">OpenGL ES入门详解</a><br><a href="https://blog.csdn.net/jeffasd/article/details/52152956" target="_blank" rel="noopener">iOS OpenGL 纹理坐标详解</a><br><a href="https://blog.csdn.net/mengtnt/article/details/7773279" target="_blank" rel="noopener">如何配置OpenGL ES的上下文（OpenGL ES2.0官方文档翻译）</a><br><a href="http://www.cnblogs.com/andyque/archive/2011/08/08/2131019.html" target="_blank" rel="noopener">（译）OpenGL ES2.0 – Iphone开发指引</a><br><a href="http://www.cnblogs.com/zilongshanren/archive/2011/09/02/2155061.html" target="_blank" rel="noopener">（译）OpenGLES2.0 Iphone开发指引：第二部分，纹理贴图</a></p><h3 id="基础应用"><a href="#基础应用" class="headerlink" title="基础应用"></a>基础应用</h3><p><a href="http://blog.csdn.net/column/details/opengl-es2-ios.html" target="_blank" rel="noopener">OpenGL ES 2.0 iOS教程</a></p><p><a href="https://blog.csdn.net/icetime17/article/details/50429658" target="_blank" rel="noopener">iOS — OpenGLES之初步认识</a><br><a href="https://blog.csdn.net/icetime17/article/details/50436927" target="_blank" rel="noopener">iOS — OpenGLES之着色器(shader)语法介绍</a><br><a href="https://blog.csdn.net/icetime17/article/details/50451752" target="_blank" rel="noopener">iOS — OpenGLES之着色器(shader)的编译、链接及使用</a><br><a href="https://blog.csdn.net/icetime17/article/details/50451954" target="_blank" rel="noopener">iOS — OpenGLES之简单的图形绘制</a><br><a href="https://blog.csdn.net/icetime17/article/details/50491271" target="_blank" rel="noopener">iOS — OpenGLES之顶点缓存对象VBO</a><br><a href="https://blog.csdn.net/icetime17/article/details/50493548" target="_blank" rel="noopener">[译] — OpenGL ES 2.0 for iPhone Tutorial Part 2: Textures</a><br><a href="https://blog.csdn.net/icetime17/article/details/50993655" target="_blank" rel="noopener">iOS — OpenGLES之图片纹理</a></p><p><a href="http://www.cocoachina.com/special/2010/0126/404.html" target="_blank" rel="noopener">西蒙iPhone-OpenGL ES 中文教程专题</a></p><p><a href="https://zhuanlan.zhihu.com/p/29795080" target="_blank" rel="noopener">从0打造一个GPUImage(1)</a><br><a href="https://zhuanlan.zhihu.com/p/29868128" target="_blank" rel="noopener">从0打造一个GPUImage(2)</a><br><a href="https://zhuanlan.zhihu.com/p/30212530" target="_blank" rel="noopener">从0打造一个GPUImage(3)</a><br><a href="https://zhuanlan.zhihu.com/p/31202175" target="_blank" rel="noopener">从0打造一个GPUImage(4)</a><br><a href="https://zhuanlan.zhihu.com/p/32194345" target="_blank" rel="noopener">从0打造一个GPUImage(5)</a><br><a href="https://zhuanlan.zhihu.com/p/32695857" target="_blank" rel="noopener">从0打造一个GPUImage(6)</a><br><a href="https://zhuanlan.zhihu.com/p/32443564" target="_blank" rel="noopener">如何调试shader</a></p><h3 id="特效"><a href="#特效" class="headerlink" title="特效"></a>特效</h3><p><a href="https://blog.csdn.net/vn9plgzvnps1522s82g/article/details/79124926" target="_blank" rel="noopener">“抖音”式的酷炫短视频开发进阶</a><br><a href="https://mp.weixin.qq.com/s/YWqejVy8q8qPzhDfljCHDw" target="_blank" rel="noopener">在 iOS 中使用 GLSL 实现抖音特效</a></p><h3 id="视频教程"><a href="#视频教程" class="headerlink" title="视频教程"></a>视频教程</h3><p><a href="http://ke.jikexueyuan.com/xilie/74" target="_blank" rel="noopener">OpenGL ES</a></p><blockquote><h2 id="音视频测试"><a href="#音视频测试" class="headerlink" title="音视频测试"></a>音视频测试</h2></blockquote><p><a href="https://segmentfault.com/a/1190000011327421" target="_blank" rel="noopener">关于音视频测试的一点建议</a></p><blockquote><h2 id="优化策略"><a href="#优化策略" class="headerlink" title="优化策略"></a>优化策略</h2></blockquote><p><a href="https://blog.csdn.net/hejjunlin/article/details/54962205" target="_blank" rel="noopener">音视频开发中常见基础问题总结</a><br><a href="https://blog.csdn.net/hejjunlin/article/details/84339858" target="_blank" rel="noopener">直播首屏耗时400ms以下的优化实践</a><br><a href="https://blog.csdn.net/Ch97CKd/article/details/84207136" target="_blank" rel="noopener">弱网优化、网络抖动、网络延时，这些问题，怎么处理？</a><br><a href="https://blog.csdn.net/hejjunlin/article/details/57075026" target="_blank" rel="noopener">直播技术总结（三）ijkplayer的一些问题优化记录</a><br><a href="https://mp.weixin.qq.com/s/304lgfYM3EK7j6AK1FhyPQ?" target="_blank" rel="noopener">多媒体那些事-播放器漫谈（一）</a><br><a href="https://mp.weixin.qq.com/s/N9EEW0D0aSRIgWbli1gBtw" target="_blank" rel="noopener">多媒体那些事-播放器漫谈（二）</a><br><a href="https://weibo.com/ttarticle/p/show?id=2309404027497137235962" target="_blank" rel="noopener">手机游戏直播 ： 悟空TV客户端设计与技术难点</a><br><a href="https://blog.csdn.net/Guofengpu/article/details/78513984" target="_blank" rel="noopener">从直播CDN的原理说起，谈如何解决延时和连麦的老难题</a><br><a href="https://blog.csdn.net/Guofengpu/article/details/79228778" target="_blank" rel="noopener">视频直播时的QoS策略</a><br><a href="https://blog.csdn.net/Guofengpu/article/details/78432360" target="_blank" rel="noopener">超百万观众同场看直播流畅不卡顿，快手如何做到的？|首次披露</a></p><blockquote><h2 id="架构设计与应用"><a href="#架构设计与应用" class="headerlink" title="架构设计与应用"></a>架构设计与应用</h2></blockquote><p><a href="https://blog.csdn.net/u014773226/article/details/51736374" target="_blank" rel="noopener">iOS流媒体直播整个框架介绍(HLS、RTSP)</a><br><a href="https://mp.weixin.qq.com/s?__biz=MzU1NTEzOTM5Mw==&amp;mid=2247484951&amp;idx=1&amp;sn=d74802ff389a4d7e4cbf2cbfce53ed96&amp;source=41#wechat_redirect" target="_blank" rel="noopener">短视频客户端SDK设计与实现</a></p><blockquote><h2 id="博客"><a href="#博客" class="headerlink" title="博客"></a>博客</h2></blockquote><p><a href="https://www.jianshu.com/users/86315de37fb0/following" target="_blank" rel="noopener">简书</a><br><a href="https://i.csdn.net/#/uc/follow-list" target="_blank" rel="noopener">CSDN</a></p><blockquote><h2 id="公众号"><a href="#公众号" class="headerlink" title="公众号"></a>公众号</h2></blockquote><p><a href="https://mp.weixin.qq.com/s/vz_P617A4ru-gysBoLzkxg" target="_blank" rel="noopener">LiveVideoStack</a><br><a href="https://mp.weixin.qq.com/s/KEVzepq7TpRy63dulWw7QA" target="_blank" rel="noopener">观止云</a><br><a href="https://mp.weixin.qq.com/s/UX0kVSca_b83Jyefg5UpoA" target="_blank" rel="noopener">野狗</a><br><a href="https://mp.weixin.qq.com/s/HwT7ErIXJGg9hsgJtP_dDQ" target="_blank" rel="noopener">何俊林</a><br><a href="https://mp.weixin.qq.com/s/MtbaL4D9g23WfZS9uS_zeA" target="_blank" rel="noopener">编风网</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> 音视频处理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用 SRS 在 VPS 上搭建流媒体服务器</title>
      <link href="/2019/04/02/use-srs-establish-server-on-vps/"/>
      <url>/2019/04/02/use-srs-establish-server-on-vps/</url>
      
        <content type="html"><![CDATA[<p>闲话少说，直接步入正题。</p><h3 id="一、登陆远程服务器"><a href="#一、登陆远程服务器" class="headerlink" title="一、登陆远程服务器"></a>一、登陆远程服务器</h3><p>我使用的是 MacBook Pro 笔记本，在 MacBook Pro 笔记本上的终端输入命令 ssh root@IP地址 -p ssh端口</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">ssh</span> <span class="selector-tag">root</span>@<span class="keyword">111</span>.<span class="keyword">11</span>.<span class="keyword">111</span>.<span class="keyword">111</span> -p <span class="number">1111</span></span><br></pre></td></tr></table></figure><p>其中，IP 地址和 SSH 端口换成你自己的 VPS 信息。</p><h3 id="二、下载-SRS-源码"><a href="#二、下载-SRS-源码" class="headerlink" title="二、下载 SRS 源码"></a>二、下载 SRS 源码</h3><p>在终端执行命令下载 SRS 源码</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="keyword">clone</span> <span class="title">https</span>://github.com/ossrs/srs</span><br></pre></td></tr></table></figure><h3 id="三、编译-SRS"><a href="#三、编译-SRS" class="headerlink" title="三、编译 SRS"></a>三、编译 SRS</h3><p>进入 srs/trunk 目录</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cd</span> <span class="string">./srs/trunk</span></span><br></pre></td></tr></table></figure><p>在终端执行下面的命令编译 SRS</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./configure <span class="meta">&amp;&amp; make</span></span><br></pre></td></tr></table></figure><a id="more"></a><h3 id="四、修改配置文件"><a href="#四、修改配置文件" class="headerlink" title="四、修改配置文件"></a>四、修改配置文件</h3><p>我没有对 <strong>./conf/srs.conf</strong> 文件进行修改，使用的是默认配置。使用默认的配置，可跳过此步，直接进入下一步 <strong>“五、启动 SRS”</strong> 的操作。如果想改 vhost 或其它，就执行下面的操作。</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">vi</span> ./<span class="keyword">conf</span>/srs.<span class="keyword">conf</span></span><br></pre></td></tr></table></figure><p>srs.conf 配置文件的默认参数为</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># main config for srs.</span></span><br><span class="line"><span class="comment"># @see full.conf for detail config.</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">listen</span>              <span class="number">1935</span>;</span><br><span class="line"><span class="attribute">max_connections</span>     <span class="number">1000</span>;</span><br><span class="line"><span class="attribute">srs_log_tank</span>        file;</span><br><span class="line"><span class="attribute">srs_log_file</span>        ./objs/srs.log;</span><br><span class="line"><span class="section">http_api</span> &#123;</span><br><span class="line">    <span class="attribute">enabled</span>         <span class="literal">on</span>;</span><br><span class="line">    <span class="attribute">listen</span>          <span class="number">1985</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="section">http_server</span> &#123;</span><br><span class="line">    <span class="attribute">enabled</span>         <span class="literal">on</span>;</span><br><span class="line">    <span class="attribute">listen</span>          <span class="number">8080</span>;</span><br><span class="line">    <span class="attribute">dir</span>             ./objs/nginx/html;</span><br><span class="line">&#125;</span><br><span class="line"><span class="section">stats</span> &#123;</span><br><span class="line">    <span class="attribute">network</span>         <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">disk</span>            sda sdb xvda xvdb;</span><br><span class="line">&#125;</span><br><span class="line"><span class="attribute">vhost</span> __defaultVhost__ &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="五、启动-SRS"><a href="#五、启动-SRS" class="headerlink" title="五、启动 SRS"></a>五、启动 SRS</h3><p>启动 SRS 服务</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./objs/srs -c <span class="keyword">conf</span>/srs.<span class="keyword">conf</span></span><br></pre></td></tr></table></figure><h3 id="六、下载-FFmpeg"><a href="#六、下载-FFmpeg" class="headerlink" title="六、下载 FFmpeg"></a>六、下载 FFmpeg</h3><p>下载 FFmpeg</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="keyword">clone</span> <span class="title">https</span>://git.ffmpeg.org/ffmpeg.git ffmpeg</span><br></pre></td></tr></table></figure><h3 id="七、编译-FFmpeg"><a href="#七、编译-FFmpeg" class="headerlink" title="七、编译 FFmpeg"></a>七、编译 FFmpeg</h3><p>进入目录 ffmpeg</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ffmpeg</span><br></pre></td></tr></table></figure><p>编译 FFmpeg</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./configure <span class="meta">&amp;&amp; make</span></span><br></pre></td></tr></table></figure><p>如果出现错误：<strong>nasm/yasm not found or too old. Use –disable-x86asm for a crippled build.</strong>，就需要安装 yasm，并再次执行 ./configure &amp;&amp; make 命令。如果未出错，跳过下面的操作直接进行下一步：<strong>八、FFmpeg 推流</strong> 的操作。</p><p>从 yasm 的版本列表 <a href="http://www.tortall.net/projects/yasm/releases" target="_blank" rel="noopener">http://www.tortall.net/projects/yasm/releases</a> 中找到合适的平台版本，通过以下命令安装 yasm</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http:<span class="regexp">//</span>www.tortall.net<span class="regexp">/projects/y</span>asm<span class="regexp">/releases/y</span>asm-<span class="number">1.3</span>.<span class="number">0</span>.tar.gz</span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">tar</span> <span class="selector-tag">zxvf</span> <span class="selector-tag">yasm-1</span><span class="selector-class">.3</span><span class="selector-class">.0</span><span class="selector-class">.tar</span><span class="selector-class">.gz</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">cd</span> <span class="selector-tag">yasm-1</span><span class="selector-class">.3</span><span class="selector-class">.0</span></span><br></pre></td></tr></table></figure><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">./configure</span></span><br></pre></td></tr></table></figure><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">make</span> &amp;&amp; <span class="built_in">make</span> install</span><br></pre></td></tr></table></figure><p>再次进入目录 ffmpeg 执行命令</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./configure <span class="meta">&amp;&amp; make</span></span><br></pre></td></tr></table></figure><h3 id="八、FFmpeg-推流"><a href="#八、FFmpeg-推流" class="headerlink" title="八、FFmpeg 推流"></a>八、FFmpeg 推流</h3><p>使用 scp 命令上传文件到远程服务器上。scp 的使用见我的文章 <a href="https://depthlove.github.io/2019/03/30/use-live555-establish-server-on-vps">使用 live555 在 VPS 上搭建流媒体服务器</a></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./ffmpeg -re -<span class="selector-tag">i</span> ../ForBiggerFun<span class="selector-class">.mp4</span> -f flv -y rtmp:<span class="comment">//111.11.111.111/live/teststreaming</span></span><br></pre></td></tr></table></figure><p>其中，ForBiggerFun.mp4 视频文件在目录 ffmpeg 的上一层目录中。</p><h3 id="九、播放视频流"><a href="#九、播放视频流" class="headerlink" title="九、播放视频流"></a>九、播放视频流</h3><p>使用 VLC 或者 ffplay 播放 rtmp 视频流：<strong>rtmp://111.11.111.111/live/teststreaming</strong></p><h3 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h3><p><a href="https://github.com/ossrs/srs/wiki" target="_blank" rel="noopener">https://github.com/ossrs/srs/wiki</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> 音视频处理 </tag>
            
            <tag> 服务器端 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用 live555 在 VPS 上搭建流媒体服务器</title>
      <link href="/2019/03/30/use-live555-establish-server-on-vps/"/>
      <url>/2019/03/30/use-live555-establish-server-on-vps/</url>
      
        <content type="html"><![CDATA[<p>在上一篇文章 <a href="https://depthlove.github.io/2019/03/29/establish-vpn-server">使用搬瓦工搭建 ShadowSocks 翻墙（VPN）</a> 中提到了我购买了 VPS 服务资源，所谓物尽其用，仅让其充当 VPN 服务的工具有点浪费，可以在上面跑一些其它服务，比如流媒体直播服务、流媒体转码服务等。关于主机购买，也可以购买国内供应商的提供的主机服务，像阿里云、腾讯云、百度云等，可以关注他们的一些促销活动，在优惠力度大的时候囤机。</p><p>我的 VPS 服务器的操作系统为：<br><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Operating <span class="keyword">system</span>:  Centos <span class="number">7</span> x86_64 bbr</span><br></pre></td></tr></table></figure></p><a id="more"></a><h3 id="一、登陆-VPS-服务器"><a href="#一、登陆-VPS-服务器" class="headerlink" title="一、登陆 VPS 服务器"></a>一、登陆 VPS 服务器</h3><p>我使用的是 MacBook Pro 笔记本，在 MacBook Pro 笔记本上的终端输入命令 ssh root@IP地址 -p ssh端口，其中 IP 地址和 SSH 端口换成你自己的 VPS 信息</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">suntongmiandeMacBook-<span class="symbol">Pro:</span>~ suntongmian<span class="variable">$ </span>ssh root<span class="variable">@111</span>.<span class="number">11.111</span>.<span class="number">111</span> -p <span class="number">1111</span></span><br></pre></td></tr></table></figure><p>执行命令后的结果如下：</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">suntongmiandeMacBook-<span class="symbol">Pro:</span>~ suntongmian<span class="variable">$ </span></span><br><span class="line">suntongmiandeMacBook-<span class="symbol">Pro:</span>~ suntongmian<span class="variable">$ </span>ssh root<span class="variable">@111</span>.<span class="number">11.111</span>.<span class="number">111</span> -p <span class="number">1111</span></span><br><span class="line">root<span class="variable">@111</span>.<span class="number">11.111</span>.<span class="number">111</span><span class="string">'s password: </span></span><br><span class="line"><span class="string">[root@host ~]#</span></span><br></pre></td></tr></table></figure><h3 id="二、安装-gcc-编译器"><a href="#二、安装-gcc-编译器" class="headerlink" title="二、安装 gcc 编译器"></a>二、安装 gcc 编译器</h3><p>给 VPS 主机安装 gcc 编译器</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root<span class="symbol">@host</span> ~]<span class="meta"># yum install gcc-c++</span></span><br></pre></td></tr></table></figure><h3 id="三、下载-live55-源码"><a href="#三、下载-live55-源码" class="headerlink" title="三、下载 live55 源码"></a>三、下载 live55 源码</h3><p>在主机根目录创建目录 <strong>streamingserver</strong></p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root<span class="symbol">@host</span> ~]<span class="meta"># </span></span><br><span class="line">[root<span class="symbol">@host</span> ~]<span class="meta"># mkdir streamingserver</span></span><br><span class="line">[root<span class="symbol">@host</span> ~]<span class="meta">#</span></span><br></pre></td></tr></table></figure><p>进入目录 <strong>streamingserver</strong></p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root<span class="symbol">@host</span> ~]<span class="meta"># </span></span><br><span class="line">[root<span class="symbol">@host</span> ~]<span class="meta"># cd streamingserver</span></span><br><span class="line">[root<span class="symbol">@host</span> streamingserver]<span class="meta">#</span></span><br></pre></td></tr></table></figure><p>从 <a href="live555.com">live555 官网</a>下载 live555 源码<br>在终端执行命令下载或者直接在官网下载，以在终端执行命令下载为例子</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@host streamingserver]# curl -O http://www.live555.com/live<span class="meta">.2019</span><span class="meta">.03</span><span class="meta">.06</span>.tar.gz</span><br></pre></td></tr></table></figure><h3 id="四、解压"><a href="#四、解压" class="headerlink" title="四、解压"></a>四、解压</h3><p>在终端执行文件的解压缩命令</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-attr">[root@host streamingserver]</span># <span class="selector-tag">tar</span> <span class="selector-tag">-xvf</span> <span class="selector-tag">live</span><span class="selector-class">.2019</span><span class="selector-class">.03</span><span class="selector-class">.06</span><span class="selector-class">.tar</span><span class="selector-class">.gz</span></span><br></pre></td></tr></table></figure><p>使用 <strong>ls</strong> 命令查看当前目录下的文件</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-attr">[root@host streamingserver]</span># </span><br><span class="line"><span class="selector-attr">[root@host streamingserver]</span># <span class="selector-tag">ls</span></span><br><span class="line"><span class="selector-tag">live</span>  <span class="selector-tag">live</span><span class="selector-class">.2019</span><span class="selector-class">.03</span><span class="selector-class">.06</span><span class="selector-class">.tar</span><span class="selector-class">.gz</span></span><br><span class="line"><span class="selector-attr">[root@host streamingserver]</span>#</span><br></pre></td></tr></table></figure><h3 id="五、编译"><a href="#五、编译" class="headerlink" title="五、编译"></a>五、编译</h3><p>第一步：进入 live55 源码目录 live</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root<span class="symbol">@host</span> streamingserver]<span class="meta"># cd live</span></span><br></pre></td></tr></table></figure><p>第二步：执行脚本</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root<span class="symbol">@host</span> live]<span class="meta"># ./genMakefiles linux-64bit</span></span><br></pre></td></tr></table></figure><p>因为我的系统是 Centos, 64bit，执行的是上面的脚本。如果系统是 Mac 系统，那么就要执行脚本 ./genMakefiles macosx</p><p>第三步：执行编译</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root<span class="symbol">@host</span> live]<span class="meta"># make</span></span><br></pre></td></tr></table></figure><h3 id="六、启动流媒体服务"><a href="#六、启动流媒体服务" class="headerlink" title="六、启动流媒体服务"></a>六、启动流媒体服务</h3><p>第一步：进入 mediaServer 目录</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root<span class="symbol">@host</span> live]<span class="meta"># </span></span><br><span class="line">[root<span class="symbol">@host</span> live]<span class="meta"># cd mediaServer</span></span><br><span class="line">[root<span class="symbol">@host</span> mediaServer]<span class="meta">#</span></span><br></pre></td></tr></table></figure><p>第二步：启动流媒体服务</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root<span class="symbol">@host</span> mediaServer]<span class="meta"># </span></span><br><span class="line">[root<span class="symbol">@host</span> mediaServer]<span class="meta"># ./live555MediaServer</span></span><br></pre></td></tr></table></figure><p>命令执行后的结果如下：</p><figure class="highlight vhdl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">[root@host mediaServer]# </span><br><span class="line">[root@host mediaServer]# ./live555MediaServer</span><br><span class="line">LIVE555 Media Server</span><br><span class="line">version <span class="number">0.96</span> (LIVE555 Streaming Media <span class="keyword">library</span> version <span class="number">2019.03</span>.<span class="number">06</span>).</span><br><span class="line">Play streams from this server using the URL</span><br><span class="line">rtsp://<span class="number">111.11</span>.<span class="number">111.111</span>/&lt;filename&gt;</span><br><span class="line">where &lt;filename&gt; <span class="keyword">is</span> a <span class="keyword">file</span> present <span class="keyword">in</span> the current directory.</span><br><span class="line">Each <span class="keyword">file</span><span class="symbol">'s</span> <span class="keyword">type</span> <span class="keyword">is</span> inferred from its name suffix:</span><br><span class="line"><span class="string">".264"</span> =&gt; a H.<span class="number">264</span> Video Elementary Stream <span class="keyword">file</span></span><br><span class="line"><span class="string">".265"</span> =&gt; a H.<span class="number">265</span> Video Elementary Stream <span class="keyword">file</span></span><br><span class="line"><span class="string">".aac"</span> =&gt; an AAC Audio (ADTS format) <span class="keyword">file</span></span><br><span class="line"><span class="string">".ac3"</span> =&gt; an AC-<span class="number">3</span> Audio <span class="keyword">file</span></span><br><span class="line"><span class="string">".amr"</span> =&gt; an AMR Audio <span class="keyword">file</span></span><br><span class="line"><span class="string">".dv"</span> =&gt; a DV Video <span class="keyword">file</span></span><br><span class="line"><span class="string">".m4e"</span> =&gt; a MPEG-<span class="number">4</span> Video Elementary Stream <span class="keyword">file</span></span><br><span class="line"><span class="string">".mkv"</span> =&gt; a Matroska audio+video+(optional)subtitles <span class="keyword">file</span></span><br><span class="line"><span class="string">".mp3"</span> =&gt; a MPEG-<span class="number">1</span> <span class="keyword">or</span> <span class="number">2</span> Audio <span class="keyword">file</span></span><br><span class="line"><span class="string">".mpg"</span> =&gt; a MPEG-<span class="number">1</span> <span class="keyword">or</span> <span class="number">2</span> Program Stream (audio+video) <span class="keyword">file</span></span><br><span class="line"><span class="string">".ogg"</span> <span class="keyword">or</span> <span class="string">".ogv"</span> <span class="keyword">or</span> <span class="string">".opus"</span> =&gt; an Ogg audio <span class="keyword">and</span>/<span class="keyword">or</span> video <span class="keyword">file</span></span><br><span class="line"><span class="string">".ts"</span> =&gt; a MPEG <span class="keyword">Transport</span> Stream <span class="keyword">file</span></span><br><span class="line">(a <span class="string">".tsx"</span> index <span class="keyword">file</span> - <span class="keyword">if</span> present - provides server <span class="symbol">'trick</span> play' support)</span><br><span class="line"><span class="string">".vob"</span> =&gt; a VOB (MPEG-<span class="number">2</span> video <span class="keyword">with</span> AC-<span class="number">3</span> audio) <span class="keyword">file</span></span><br><span class="line"><span class="string">".wav"</span> =&gt; a WAV Audio <span class="keyword">file</span></span><br><span class="line"><span class="string">".webm"</span> =&gt; a WebM audio(Vorbis)+video(VP8) <span class="keyword">file</span></span><br><span class="line">See http://www.live555.com/mediaServer/ <span class="keyword">for</span> additional documentation.</span><br><span class="line">(We <span class="keyword">use</span> <span class="keyword">port</span> <span class="number">80</span> <span class="keyword">for</span> optional RTSP-over-HTTP tunneling, <span class="keyword">or</span> <span class="keyword">for</span> HTTP live streaming (<span class="keyword">for</span> indexed <span class="keyword">Transport</span> Stream files only).)</span><br></pre></td></tr></table></figure><p>从上面显示的信息可看出，live555 默认支持 .264, .265, .aac, ac3, .amr, .dv, .m4e, .mkv, .mp3, .mpg, .ogg, .ts, .vob, .wav, .webm 视频格式。</p><h3 id="七、本地文件上传到服务器"><a href="#七、本地文件上传到服务器" class="headerlink" title="七、本地文件上传到服务器"></a>七、本地文件上传到服务器</h3><p>第一步：获取 .mkv 格式的视频文件</p><p>如果在网络上找不到合适的 .mkv 格式的视频文件，那么可以使用 ffmpeg 转码获取。ffmpeg 的安装，可参看我的文章 <a href="https://depthlove.github.io/2015/09/24/install-ffmpeg-to-MacOSX-and-use-ffmpeg-to-transform-h264-to-mp4">在Mac OSX上安装ffmpeg &amp;&amp; ffmpeg命令行将h264封装为mp4</a></p><p>在 MacBook Pro 笔记本的终端输入 ffmpeg 转码命令</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">suntongmiandeMacBook-Pro:myTestVideo suntongmian$ ffmpeg -<span class="selector-tag">i</span> SampleVideo_1280x720_10mb<span class="selector-class">.mp4</span> -vcodec copy -acodec copy output.mkv</span><br></pre></td></tr></table></figure><p>执行结果如下：</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">suntongmiandeMacBook-Pro<span class="function">:myTestVideo</span> suntongmian$ </span><br><span class="line">suntongmiandeMacBook-Pro<span class="function">:myTestVideo</span> suntongmian$ <span class="keyword">ls</span></span><br><span class="line">SampleVideo_1280x720_10mb.mp4</span><br><span class="line">suntongmiandeMacBook-Pro<span class="function">:myTestVideo</span> suntongmian$ </span><br><span class="line">suntongmiandeMacBook-Pro<span class="function">:myTestVideo</span> suntongmian$ ffmpeg -i SampleVideo_1280x720_10mb.mp4 -vcodec copy -acodec copy output.mkv </span><br><span class="line">ffmpeg <span class="keyword">version</span> 4.1.2 Copyright <span class="params">(c)</span> 2000-2019 the FFmpeg developers</span><br><span class="line">  built with Apple LLVM <span class="keyword">version</span> 10.0.0 <span class="params">(clang-1000.11.45.5)</span></span><br><span class="line">  configuration: <span class="params">--prefix=/usr/local/Cellar/ffmpeg/4</span>.1.2 <span class="params">--enable-shared</span> <span class="params">--enable-pthreads</span> <span class="params">--enable-version3</span> <span class="params">--enable-hardcoded-tables</span> <span class="params">--enable-avresample</span> <span class="params">--cc=clang</span> <span class="params">--host-cflags=</span>'-I/Library/Java/JavaVirtualMachines/openjdk-11.0.2.jdk/Contents/Home/include -I/Library/Java/JavaVirtualMachines/openjdk-11.0.2.jdk/Contents/Home/include/darwin' <span class="params">--host-ldflags=</span> <span class="params">--enable-ffplay</span> <span class="params">--enable-gnutls</span> <span class="params">--enable-gpl</span> <span class="params">--enable-libaom</span> <span class="params">--enable-libbluray</span> <span class="params">--enable-libmp3lame</span> <span class="params">--enable-libopus</span> <span class="params">--enable-librubberband</span> <span class="params">--enable-libsnappy</span> <span class="params">--enable-libtesseract</span> <span class="params">--enable-libtheora</span> <span class="params">--enable-libvorbis</span> <span class="params">--enable-libvpx</span> <span class="params">--enable-libx264</span> <span class="params">--enable-libx265</span> <span class="params">--enable-libxvid</span> <span class="params">--enable-lzma</span> <span class="params">--enable-libfontconfig</span> <span class="params">--enable-libfreetype</span> <span class="params">--enable-frei0r</span> <span class="params">--enable-libass</span> <span class="params">--enable-libopencore-amrnb</span> <span class="params">--enable-libopencore-amrwb</span> <span class="params">--enable-libopenjpeg</span> <span class="params">--enable-librtmp</span> <span class="params">--enable-libspeex</span> <span class="params">--enable-videotoolbox</span> <span class="params">--disable-libjack</span> <span class="params">--disable-indev=jack</span> <span class="params">--enable-libaom</span> <span class="params">--enable-libsoxr</span></span><br><span class="line">  libavutil      56. 22.100 / 56. 22.100</span><br><span class="line">  libavcodec     58. 35.100 / 58. 35.100</span><br><span class="line">  libavformat    58. 20.100 / 58. 20.100</span><br><span class="line">  libavdevice    58.  5.100 / 58.  5.100</span><br><span class="line">  libavfilter     7. 40.101 /  7. 40.101</span><br><span class="line">  libavresample   4.  0.  0 /  4.  0.  0</span><br><span class="line">  libswscale      5.  3.100 /  5.  3.100</span><br><span class="line">  libswresample   3.  3.100 /  3.  3.100</span><br><span class="line">  libpostproc    55.  3.100 / 55.  3.100</span><br><span class="line">Input <span class="comment">#0, mov,mp4,m4a,3gp,3g2,mj2, from 'SampleVideo_1280x720_10mb.mp4':</span></span><br><span class="line">  Metadata:</span><br><span class="line">    major_brand     : isom</span><br><span class="line">    minor_<span class="keyword">version</span>   : 512</span><br><span class="line">    compatible_brands: isomiso2avc1mp41</span><br><span class="line">    creation_time   : 1970-01-01T00<span class="function">:00</span><span class="function">:00.000000Z</span></span><br><span class="line">    encoder         : Lavf53.24.2</span><br><span class="line">  Duration: 00<span class="function">:01</span><span class="function">:02.32</span>, start: 0.000000, bitrate: 1347 kb/s</span><br><span class="line">    Stream <span class="comment">#0:0(und): Video: h264 (Main) (avc1 / 0x31637661), yuv420p, 1280x720 [SAR 1:1 DAR 16:9], 959 kb/s, 25 fps, 25 tbr, 12800 tbn, 50 tbc (default)</span></span><br><span class="line">    Metadata:</span><br><span class="line">      creation_time   : 1970-01-01T00<span class="function">:00</span><span class="function">:00.000000Z</span></span><br><span class="line">      handler_name    : VideoHandler</span><br><span class="line">    Stream <span class="comment">#0:1(und): Audio: aac (LC) (mp4a / 0x6134706D), 48000 Hz, 5.1, fltp, 383 kb/s (default)</span></span><br><span class="line">    Metadata:</span><br><span class="line">      creation_time   : 1970-01-01T00<span class="function">:00</span><span class="function">:00.000000Z</span></span><br><span class="line">      handler_name    : SoundHandler</span><br><span class="line">Output <span class="comment">#0, matroska, to 'output.mkv':</span></span><br><span class="line">  Metadata:</span><br><span class="line">    major_brand     : isom</span><br><span class="line">    minor_<span class="keyword">version</span>   : 512</span><br><span class="line">    compatible_brands: isomiso2avc1mp41</span><br><span class="line">    encoder         : Lavf58.20.100</span><br><span class="line">    Stream <span class="comment">#0:0(und): Video: h264 (Main) (avc1 / 0x31637661), yuv420p, 1280x720 [SAR 1:1 DAR 16:9], q=2-31, 959 kb/s, 25 fps, 25 tbr, 1k tbn, 12800 tbc (default)</span></span><br><span class="line">    Metadata:</span><br><span class="line">      creation_time   : 1970-01-01T00<span class="function">:00</span><span class="function">:00.000000Z</span></span><br><span class="line">      handler_name    : VideoHandler</span><br><span class="line">    Stream <span class="comment">#0:1(und): Audio: aac (LC) ([255][0][0][0] / 0x00FF), 48000 Hz, 5.1, fltp, 383 kb/s (default)</span></span><br><span class="line">    Metadata:</span><br><span class="line">      creation_time   : 1970-01-01T00<span class="function">:00</span><span class="function">:00.000000Z</span></span><br><span class="line">      handler_name    : SoundHandler</span><br><span class="line">Stream mapping:</span><br><span class="line">  Stream <span class="comment">#0:0 -&gt; #0:0 (copy)</span></span><br><span class="line">  Stream <span class="comment">#0:1 -&gt; #0:1 (copy)</span></span><br><span class="line">Press [q] to stop, [?] for <span class="keyword">help</span></span><br><span class="line">frame= 1557 fps=0.0 q=-1.0 Lsize=   10249kB time=00<span class="function">:01</span><span class="function">:02.29</span> bitrate=1347.9kbits/s speed= 973x    </span><br><span class="line">video<span class="function">:7298kB</span> audio<span class="function">:2919kB</span> subtitle<span class="function">:0kB</span> other streams<span class="function">:0kB</span> global headers<span class="function">:0kB</span> muxing overhead: 0.316002%</span><br><span class="line">suntongmiandeMacBook-Pro<span class="function">:myTestVideo</span> suntongmian$ </span><br><span class="line">suntongmiandeMacBook-Pro<span class="function">:myTestVideo</span> suntongmian$ <span class="keyword">ls</span></span><br><span class="line">SampleVideo_1280x720_10mb.mp4output.mkv</span><br><span class="line">suntongmiandeMacBook-Pro<span class="function">:myTestVideo</span> suntongmian$</span><br></pre></td></tr></table></figure><p>第二步：上传本地文件到远端服务器</p><p>我使用的是 MacBook Pro 笔记本，在 MacBook Pro 笔记本上的终端上执行下面的命令，将视频文件上传到 VPS 服务器上。</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">suntongmiandeMacBook-<span class="symbol">Pro:</span>myTestVideo suntongmian<span class="variable">$ </span>scp -P <span class="number">1111</span> output.mkv root<span class="variable">@111</span>.<span class="number">11.111</span>.<span class="number">111</span><span class="symbol">:/root/streamingserver/live/mediaServer</span></span><br></pre></td></tr></table></figure><p>命令执行后的结果如下：</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">suntongmiandeMacBook-<span class="symbol">Pro:</span>myTestVideo suntongmian<span class="variable">$ </span></span><br><span class="line">suntongmiandeMacBook-<span class="symbol">Pro:</span>myTestVideo suntongmian<span class="variable">$ </span>scp -P <span class="number">1111</span> output.mkv root<span class="variable">@111</span>.<span class="number">11.111</span>.<span class="number">111</span><span class="symbol">:/root/streamingserver/live/mediaServer</span></span><br><span class="line">root<span class="variable">@111</span>.<span class="number">11.111</span>.<span class="number">111</span><span class="string">'s password: </span></span><br><span class="line"><span class="string">output.mkv                                                                                           100%   30MB 511.1KB/s   01:00    </span></span><br><span class="line"><span class="string">suntongmiandeMacBook-Pro:myTestVideo suntongmian$</span></span><br></pre></td></tr></table></figure><p>其中，<strong>myTestVideo</strong> 是我的 MacBook Pro 笔记本上存放测试视频的文件夹。<strong>/root/streamingserver/live/mediaServer</strong> 为 VPS 主机的目录层级。</p><p>关于 scp 命令的使用，可参看文章 <a href="https://www.vpser.net/manage/scp.html" target="_blank" rel="noopener">Linux SSH远程文件/目录传输命令scp</a></p><p>第二步：检测文件是否上传成功</p><p>在 VPS 主机上执行命令 <strong>ls</strong> 查看相应的目录下是否存在文件 <strong>output.mkv</strong>。若存在 <strong>output.mkv</strong>，就说明上面的第一步操作成功了。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-attr">[root@host mediaServer]</span># </span><br><span class="line"><span class="selector-attr">[root@host mediaServer]</span># <span class="selector-tag">ls</span></span><br><span class="line"><span class="selector-tag">COPYING</span>                <span class="selector-tag">DynamicRTSPServer</span><span class="selector-class">.o</span>     <span class="selector-tag">Makefile</span>       <span class="selector-tag">version</span><span class="selector-class">.hh</span></span><br><span class="line"><span class="selector-tag">COPYING</span><span class="selector-class">.LESSER</span>         <span class="selector-tag">live555MediaServer</span>      <span class="selector-tag">Makefile</span><span class="selector-class">.head</span></span><br><span class="line"><span class="selector-tag">DynamicRTSPServer</span><span class="selector-class">.cpp</span>  <span class="selector-tag">live555MediaServer</span><span class="selector-class">.cpp</span>  <span class="selector-tag">Makefile</span><span class="selector-class">.tail</span></span><br><span class="line"><span class="selector-tag">DynamicRTSPServer</span><span class="selector-class">.hh</span>   <span class="selector-tag">live555MediaServer</span><span class="selector-class">.o</span>    <span class="selector-tag">output</span><span class="selector-class">.mkv</span></span><br><span class="line"><span class="selector-attr">[root@host mediaServer]</span>#</span><br></pre></td></tr></table></figure><h3 id="八、重新启动流媒体服务"><a href="#八、重新启动流媒体服务" class="headerlink" title="八、重新启动流媒体服务"></a>八、重新启动流媒体服务</h3><p>第一步：使用 ctrl+c 终止之前启动的流媒体服务</p><p>执行结果如下：</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">^C</span><br><span class="line">[root<span class="symbol">@host</span> mediaServer]<span class="meta">#</span></span><br></pre></td></tr></table></figure><p>第二步：重新启动流媒体服务</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root<span class="symbol">@host</span> mediaServer]<span class="meta"># </span></span><br><span class="line">[root<span class="symbol">@host</span> mediaServer]<span class="meta"># ./live555MediaServer</span></span><br></pre></td></tr></table></figure><h3 id="九、测试视频流"><a href="#九、测试视频流" class="headerlink" title="九、测试视频流"></a>九、测试视频流</h3><p>第一步：安装 VLC 视频播放器。我使用的是 MacBook Pro 笔记本，在笔记本上下载并安装了 VLC 视频播放器。</p><p>第二步：播放视频流。在 VLC 中打开视频流地址 <strong>rtsp://111.11.111.111/output.mkv</strong>，即可看到 live555 服务器推送出来的视频流。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 音视频处理 </tag>
            
            <tag> 服务器端 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用搬瓦工搭建 ShadowSocks 翻墙（VPN）</title>
      <link href="/2019/03/29/establish-vpn-server/"/>
      <url>/2019/03/29/establish-vpn-server/</url>
      
        <content type="html"><![CDATA[<p>为了查询资料的便利性，大部分时候需要使用 Google 浏览器，但是国内除了高校能默认支持访问 Google 的服务外，基本所有人想使用 Google 的服务都需要借助 <a href="[https://zh.wikipedia.org/wiki/%E8%99%9B%E6%93%AC%E7%A7%81%E4%BA%BA%E7%B6%B2%E8%B7%AF](https://zh.wikipedia.org/wiki/%E8%99%9B%E6%93%AC%E7%A7%81%E4%BA%BA%E7%B6%B2%E8%B7%AF">虚拟专用网 VPN (Virtual Private Network) </a><br>) 工具。以前使用过一些 VPN 服务提供商提供的服务，出现过用了一段时间就使用不了了、服务不稳定、连接后访问网络资源慢，还有的干脆就无法使用。比如我花了 79 美金买过 NordVPN 的服务，网上的口碑和排名很靠前的。事实上真是花钱买烦恼，99%的概率连不上 NordVPN 服务，即使碰运气连上去了，但网速差的让人吐血。为这个事，与 NordVPN 的技术支持来往过好多封英文邮件，最终还是没有解决连不上服务器的问题。在国内想使用 Google 服务查询资料真是痛苦。搞笑的是，2018年12月初去韩国济州岛玩，在济州岛使用 NordVPN 服务倒是 99%以上概率连上服务器，网速也还可以。泪崩，在 NordVPN 上花的钱彻底打水漂了。好在工作所在公司提供了 VPN 服务，就一直使用到现在。</p><p>为能正常使用 Google 的资源以及考虑到数据访问的私密性，就开始考虑搭建一个私人的 VPN 服务。查询了一些资料，找到了 <a href="https://bwh88.net" target="_blank" rel="noopener">搬瓦工 (BandwagonHost)</a> 。以下是搭建的流程：</p><a id="more"></a><h4 id="一、购买主机服务-VPS"><a href="#一、购买主机服务-VPS" class="headerlink" title="一、购买主机服务 VPS"></a>一、购买主机服务 VPS</h4><h5 id="参考该文的购买流程"><a href="#参考该文的购买流程" class="headerlink" title="参考该文的购买流程"></a>参考该文的购买流程</h5><p><a href="https://www.iqiqi.org/banwagong-vps-setup-shadowsocks" target="_blank" rel="noopener">搬瓦工(BandwagonHost) 一键搭建ShadowSocks翻墙教程</a></p><h4 id="二、登陆-VPS"><a href="#二、登陆-VPS" class="headerlink" title="二、登陆 VPS"></a>二、登陆 VPS</h4><h5 id="参考该文的登陆搬瓦工的-VPS-的流程"><a href="#参考该文的登陆搬瓦工的-VPS-的流程" class="headerlink" title="参考该文的登陆搬瓦工的 VPS 的流程"></a>参考该文的登陆搬瓦工的 VPS 的流程</h5><p><a href="https://www.bwgyhw.cn/bandwagonhost-ssh-login/?utm_source=textarea.com&amp;utm_medium=textarea.com&amp;utm_campaign=article" target="_blank" rel="noopener">Windows/Mac/Linux如何SSH远程连接/登陆搬瓦工</a></p><p>我使用的 MacBook Pro，以下为 Mac 系统上的 VPS 登陆流程：</p><p>在终端输入命令 <strong>ssh root@IP地址 -p ssh端口</strong>，其中 IP 地址和 SSH 端口换成你自己的 VPS 信息</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">ssh</span> <span class="selector-tag">root</span>@<span class="keyword">111</span>.<span class="keyword">11</span>.<span class="keyword">111</span>.<span class="keyword">111</span> -p <span class="number">1111</span></span><br></pre></td></tr></table></figure><h4 id="三、安装-SSR-脚本"><a href="#三、安装-SSR-脚本" class="headerlink" title="三、安装 SSR 脚本"></a>三、安装 SSR 脚本</h4><h5 id="参考该文的-Shadowsocks-安装流程"><a href="#参考该文的-Shadowsocks-安装流程" class="headerlink" title="参考该文的 Shadowsocks 安装流程"></a>参考该文的 Shadowsocks 安装流程</h5><p><a href="https://www.iqiqi.org/bandwagonhost-install-shadowsocks" target="_blank" rel="noopener">搬瓦工(BandwagonHost)取消了一键安装Shadowsocks后，最新搬瓦工手动安装SS教程！</a></p><p>第一步：等到出现 <strong>root@host ~</strong> 字样，执行命令</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget --<span class="keyword">no</span>-check-certificate -O shadowsocks-<span class="keyword">all</span>.<span class="keyword">sh</span> http<span class="variable">s:</span>//raw.githubusercontent.<span class="keyword">com</span>/teddysun/shadowsocks_install/master/shadowsocks-<span class="keyword">all</span>.<span class="keyword">sh</span></span><br></pre></td></tr></table></figure><p><strong>注意 (warning) : 国外服务器运行脚本时容易出错，如出现错误提示 bash: wget: command not found，可以请在先执行 yum -y install wget 命令。成功后，再执行上面的命令。如果没有出现提示错误，请略过。</strong></p><p>第二步：等待上一步的命令执行结束后，继续执行命令</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod +<span class="keyword">x</span> shadowsocks-<span class="keyword">all</span>.<span class="keyword">sh</span></span><br></pre></td></tr></table></figure><p>第三步：等待上一步的命令执行结束后，继续执行命令</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./shadowsocks-<span class="keyword">all</span>.<span class="keyword">sh</span> <span class="number">2</span>&gt;&amp;<span class="number">1</span> | tee shadowsocks-<span class="keyword">all</span>.<span class="built_in">log</span></span><br></pre></td></tr></table></figure><p>第四步：根据需要选择，不懂的话直接选1，或者默认回车。下面会提示你输入你的 SS SERVER 的密码和端口。不输入就是默认。跑完命令后会出来你的 SS 客户端的信息。</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Which Shadowsocks<span class="built_in"> server </span>you’d select:</span><br><span class="line">1) Shadowsocks-Python</span><br><span class="line">2) ShadowsocksR</span><br><span class="line">3) Shadowsocks-Go</span><br><span class="line">4) Shadowsocks-libev</span><br><span class="line">Please enter a number (Default Shadowsocks-Python):1</span><br><span class="line"></span><br><span class="line">You choose = Shadowsocks-Python</span><br><span class="line"></span><br><span class="line">Please enter password <span class="keyword">for</span> Shadowsocks-Python</span><br><span class="line">(Default password: teddysun.com):123456</span><br><span class="line"></span><br><span class="line">password = 123456</span><br><span class="line"></span><br><span class="line">Please enter a<span class="built_in"> port </span><span class="keyword">for</span> Shadowsocks-Python [1-65535]</span><br><span class="line">(Default port: 11260):11260</span><br><span class="line"></span><br><span class="line">port = 11260</span><br></pre></td></tr></table></figure><p>第五步：特别注意，由于 iPhone 端的的 wingy 目前只支持到 cfb，所以我们选择 aes-256-cfb，即7，回车。</p><p>第六步：当我们看到 Congratulations, Shadowsocks-Python server install completed! 时，则证明我们已经成功安装了 SS。请立即将这些信息复制下来加以保存，我们就会用到这几个比较重要的信息：主机服务器IP地址、端口号、密码和加密方式。上面的命令全部回车执行后，如果没有报错，即为执行成功，出现确认提示的时候，输入 y 后，回车即可。</p><p>这样的话我们就在搬瓦工 VPS 主机上完成了 SS 的手动安装，记录保存好你的上述信息：Server IP、Server Port、Password、Encryption Method，我们就可以在不同的设备终端找到相应的 SS 进行安装设置使用了。</p><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">INFO: loading config <span class="keyword">from</span> /etc/shadowsocks-python/config.json</span><br><span class="line"><span class="number">2019</span>-<span class="number">03</span>-<span class="number">28</span> <span class="number">05</span>:<span class="number">14</span>:<span class="number">24</span> INFO     loading libcrypto <span class="keyword">from</span> libcrypto.so.<span class="number">10</span></span><br><span class="line">Starting Shadowsocks success</span><br><span class="line"></span><br><span class="line">Congratulations, Shadowsocks-Python server install completed!</span><br><span class="line">Your Server IP        :  <span class="number">111.11</span>.<span class="number">111.111</span></span><br><span class="line">Your Server Port      :  <span class="number">11260</span></span><br><span class="line">Your Password         :  <span class="number">123456</span></span><br><span class="line">Your Encryption <span class="function"><span class="keyword">Method</span>:</span>  aes-<span class="number">256</span>-cfb</span><br><span class="line"></span><br><span class="line">Your QR Code: (<span class="keyword">For</span> Shadowsocks Windows, OSX, Android <span class="keyword">and</span> iOS clients)</span><br><span class="line">ss:<span class="comment">//xxxxxxxxxxxxxxxxx</span></span><br><span class="line">Your QR Code <span class="keyword">has</span> been saved <span class="keyword">as</span> a PNG file path:</span><br><span class="line">/root/shadowsocks_python_qr.png</span><br><span class="line"></span><br><span class="line">Welcome <span class="keyword">to</span> visit: https:<span class="comment">//teddysun.com/486.html</span></span><br><span class="line">Enjoy it!</span><br></pre></td></tr></table></figure><h4 id="四、使用-Shadowsocks-终端体验-VPN-服务"><a href="#四、使用-Shadowsocks-终端体验-VPN-服务" class="headerlink" title="四、使用 Shadowsocks 终端体验 VPN 服务"></a>四、使用 Shadowsocks 终端体验 VPN 服务</h4><p>根据设备类型，下载对应的平台软件，并设置好参数就可以畅享 VPN 服务了。</p><p>Windows：<a href="https://github.com/shadowsocks/shadowsocks-windows/releases" target="_blank" rel="noopener">Github链接地址</a></p><p>Mac：<a href="https://github.com/yangfeicheung/Shadowsocks-X/releases" target="_blank" rel="noopener">Github链接地址</a></p><p>Android：<a href="https://github.com/shadowsocks/shadowsocks-android/releases" target="_blank" rel="noopener">Github链接地址</a></p><p>iPhone：Kite Ass Proxy：<a href="https://itunes.apple.com/cn/app/kite-ss-proxy/id1346595633?mt=8" target="_blank" rel="noopener">APP Store链接地址</a>、<br>FirstWingy：<a href="https://itunes.apple.com/cn/app/firstwingy/id1316416848?mt=8" target="_blank" rel="noopener">APP Store链接地址</a>、<br>SuperWingy：<a href="https://itunes.apple.com/cn/app/superwingy/id1290093815?mt=8" target="_blank" rel="noopener">APP Store链接地址</a></p><p>我要在 Mac 和 iPhone 上使用，我下载了上面的 Mac 版本，但是没有下载上面的 iPhone 版本，iPhone 版本我用的是 <a href="https://itunes.apple.com/us/app/sockswitch-shadowsocks-client/id1453207024?mt=8" target="_blank" rel="noopener">Sockswitch</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> 工具 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mac 上安装 Spark</title>
      <link href="/2018/03/18/install-spark-in-mac/"/>
      <url>/2018/03/18/install-spark-in-mac/</url>
      
        <content type="html"><![CDATA[<h2 id="1-安装-JDK"><a href="#1-安装-JDK" class="headerlink" title="1. 安装 JDK"></a>1. 安装 JDK</h2><h3 id="1-1-检查-JDK-版本"><a href="#1-1-检查-JDK-版本" class="headerlink" title="1.1 检查 JDK 版本"></a>1.1 检查 JDK 版本</h3><p>检查 Mac 上是否已经安装了 jdk，在终端上执行命令</p><p>java -version</p><p>Spark 是使用 scala 语言开发的，如果要使用 Scala，就需要安装与之对应的 jdk 版本，Scala 的下载地址：<a href="http://www.scala-lang.org/download/" target="_blank" rel="noopener">http://www.scala-lang.org/download/</a>。下载地址页面明确说明了要使用 Scala 就必须要求 java version 为 1.8 以上，也就是 Java 8 JDK 以上版本。</p><a id="more"></a><p><img src="https://raw.githubusercontent.com/depthlove/depthloveBlog/7d233c70c1014d94ebedbcdbc6cafa488b479023/source/images/install-spark-in-mac/install-spark-in-mac-00.png" alt="java -version 的结果"></p><p><img src="https://raw.githubusercontent.com/depthlove/depthloveBlog/7d233c70c1014d94ebedbcdbc6cafa488b479023/source/images/install-spark-in-mac/install-spark-in-mac-01.png" alt="Scala 要求的 JDK 版本"></p><h3 id="1-2-安装-JDK"><a href="#1-2-安装-JDK" class="headerlink" title="1.2 安装 JDK"></a>1.2 安装 JDK</h3><p>如果 Mac 上没有安装 jdk，jdk 的下载地址：<a href="http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html" target="_blank" rel="noopener">http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html</a>，选择 Mac 版本的 jdk 下载，下载后安装。</p><p>安装完成后，在终端执行命令如下命令查看是否成功安装</p><p>java -version</p><h2 id="2-安装-Spark"><a href="#2-安装-Spark" class="headerlink" title="2. 安装 Spark"></a>2. 安装 Spark</h2><h3 id="2-1-下载-Spark"><a href="#2-1-下载-Spark" class="headerlink" title="2.1 下载 Spark"></a>2.1 下载 Spark</h3><p>Spark 压缩包的下载地址为：<a href="http://spark.apache.org/downloads.html" target="_blank" rel="noopener">http://spark.apache.org/downloads.html</a>，选择合适的版本安装。我选择的是 <a href="http://mirrors.shu.edu.cn/apache/spark/spark-2.3.0/spark-2.3.0-bin-hadoop2.7.tgz" target="_blank" rel="noopener">spark-2.3.0-bin-hadoop2.7.tgz</a> 版本。</p><p><img src="https://raw.githubusercontent.com/depthlove/depthloveBlog/7d233c70c1014d94ebedbcdbc6cafa488b479023/source/images/install-spark-in-mac/install-spark-in-mac-02.png" alt="Spark 下载页面"></p><h3 id="2-2-解压-Spark"><a href="#2-2-解压-Spark" class="headerlink" title="2.2 解压 Spark"></a>2.2 解压 Spark</h3><p>将 spark-2.3.0-bin-hadoop2.7.tgz 解压到你的某个文件目录下。我的文件目录结构是 </p><p><img src="https://raw.githubusercontent.com/depthlove/depthloveBlog/7d233c70c1014d94ebedbcdbc6cafa488b479023/source/images/install-spark-in-mac/install-spark-in-mac-03.png" alt="存放 spark-2.3.0-bin-hadoop2.7.tgz 的文件目录 "></p><h3 id="2-3-运行-Spark"><a href="#2-3-运行-Spark" class="headerlink" title="2.3 运行 Spark"></a>2.3 运行 Spark</h3><p>进入 Spark 所在的目录下，执行 Scala 脚本启动 Spark</p><p><img src="https://raw.githubusercontent.com/depthlove/depthloveBlog/7d233c70c1014d94ebedbcdbc6cafa488b479023/source/images/install-spark-in-mac/install-spark-in-mac-10.png" alt="Scala 脚本启动 Spark"></p><p>根据终端的显示结果，在 Chrome 浏览器上访问 <a href="http://172.20.10.4:4040" target="_blank" rel="noopener">http://172.20.10.4:4040</a>，会出现 Spark 的 web 页面，可以点击 Jobs，Stages，Storage，Environment，Executors 等菜单项看看 Spark 都运行了哪些服务，更加直观地了解 Spark 是个什么样的东西。</p><p><img src="https://raw.githubusercontent.com/depthlove/depthloveBlog/7d233c70c1014d94ebedbcdbc6cafa488b479023/source/images/install-spark-in-mac/install-spark-in-mac-05.png" alt="Spark 的 web 页面"></p><p>启动了 Spark，也在浏览器上看到了其可视化界面，接下来就来个例子试试 Spark。</p><p>在 spark-2.3.0-bin-hadoop2.7 所在的目录下，新建一个 testfile 目录，testfile 目录下新建一个文件 helloSpark，并写上简单几行文字。</p><p><img src="https://raw.githubusercontent.com/depthlove/depthloveBlog/7d233c70c1014d94ebedbcdbc6cafa488b479023/source/images/install-spark-in-mac/install-spark-in-mac-06.png" alt="helloSpark 的内容"></p><p>在 bin 目录下执行脚本 spark-shell，并使用 Scala 统计 helloSpark 文件中的函数、文件中第一行的内容</p><p><img src="https://raw.githubusercontent.com/depthlove/depthloveBlog/7d233c70c1014d94ebedbcdbc6cafa488b479023/source/images/install-spark-in-mac/install-spark-in-mac-07.png" alt="spark-shell 的使用"></p><p>helloSpark 文件和 spark-shell 脚本所在的目录如下图</p><p><img src="https://raw.githubusercontent.com/depthlove/depthloveBlog/7d233c70c1014d94ebedbcdbc6cafa488b479023/source/images/install-spark-in-mac/install-spark-in-mac-08.png" alt="helloSpark 文件位置"></p><p><img src="https://raw.githubusercontent.com/depthlove/depthloveBlog/7d233c70c1014d94ebedbcdbc6cafa488b479023/source/images/install-spark-in-mac/install-spark-in-mac-09.png" alt="spark-shell 脚本的位置"></p><p>注意：可能有些朋友不清楚 <code>val lines = sc.textFile(&quot;../../testfile/helloSpark&quot;)</code> 中 <code>../</code> 的意思，<code>../</code> 表示上一层目录，<code>../../</code> 表示上上层目录。</p><p>到此，Spark 的简单试用结束了。想了解 <code>sc.textFile</code>，大家自行 google 或 baidu。</p><p>对于初学者来说，有相应的视频配合的话，会对 Spark 的安装有更新直观的视觉体验。给大家推荐下视频：<a href="https://www.imooc.com/video/14394" target="_blank" rel="noopener">Spark 从零开始-Spark 安装</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> 大数据 </tag>
            
            <tag> 机器学习 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【译】调查：苹果 HEVC 采用的影响</title>
      <link href="/2018/02/26/translate-Survey-The-Impact-of-Apples-HEVC-Adoption/"/>
      <url>/2018/02/26/translate-Survey-The-Impact-of-Apples-HEVC-Adoption/</url>
      
        <content type="html"><![CDATA[<p>英语原文：<a href="http://www.streamingmedia.com/Articles/Editorial/Featured-Articles/Survey-The-Impact-of-Apples-HEVC-Adoption-122654.aspx" target="_blank" rel="noopener">Survey: The Impact of Apple’s HEVC Adoption</a></p><p>调查：苹果 HEVC 采用的影响<br>新的 Unisphere 报告显示OTT服务和其他视频发布商正在向HEVC转移，但同样对 AV1 感兴趣<br>作者：Streaming Media 编辑人员<br>发布时间：2018年1月23日</p><p>您是否想知道苹果决定在 HTTP Live Streaming（HLS）中添加 HEVC 对流发布社区意图部署 HEVC 有多大影响？最近一项对 Streaming Media 读者的调查显示，66.2％的受访者表示，苹果的举动产生了重大影响，到2018年年底，高达62.5％的人可能会向 HLS 中添加 HEVC。这些只是 Harmonic 公司和 Unisphere 研究机构今天联合发布的许多调查结果中的两个。这份名为“<a href="http://www.streamingmedia.com/Research/7694-The-Impact-of-Apple&#39;s-HEVC-Adoption-A-Survey-Based-Report.htm" target="_blank" rel="noopener">苹果 HEVC 采用的影响：基于调查的报告</a>”的报告包括来自600多 Streaming Media 读者的回应。</p><p>这份可供下载的8页报告也显示了制片人对开放媒体联盟（AOM）AV1 编解码器的兴趣，66％以上的受访者表现出浓厚的兴趣。虽然目前超过25％的受访者分发使用 HEVC 编码的视频，但74％的受访者表示“已知或未知的内容使用费”是通过 HLS 部署 HEVC 的一个重要问题。</p><a id="more"></a><p>调查报告的作者，Streaming Media 特约编辑 Jan Ozer 说：“HEVC 推出五年多以来，总版税费用仍然未知，继续遏制了编解码器的采用。结果，在苹果加入 AOM 之前有33％的受访者计划在2018年及以后增加AV1，苹果加入 AOM，这只会增加受访者的兴趣。额外的27.3％对 VP9 表示相同的观点，显然，最好的事情是 HEVC IP 社区可以采取行动来促进 HEVC 的采用，从而降低版税结构和成本。”</p><p>HEVC 的采用也受到其他几个因素的影响，如与 HEVC 编码相关的额外编码成本以及有关如何解决传统 HLS 终端的混淆。具体来说，当被问及他们如何处理传统设备时，48.3％回答他们不知道，表明在这一点上需要市场教育。那些避开 HEVC 的公司采用了许多其他技术来实现相同的好处，如内容感知编码和其他比特率缩减系统。</p><p>尽管对 AV1 的兴趣很浓厚，但采用并不是扣篮。受访者对比较质量，播放性能和编码时间表示了很大的担忧。令人意外的是，对潜在知识产权问题的关注并不是一个重大障碍。Ozer 评论说：“在 VP8 之前，专家和专利组织一直在使用开源编解码器来解决潜在的 IP 问题。在开放媒体联盟中，亚马逊，思科，谷歌，英特尔，微软，Mozilla，Netflix 以及现在的苹果都认为：出版界认为 IP 挑战的威胁并不真实。”</p><p>这项调查还测量了其他编解码器的兴趣，并提到了 V-NOVA PERSEUS，Divideon xvc 和 RealNetworks RealMedia HD，尽管53.8％的受访者当前没有计划添加任何编解码器。对高动态范围（HDR）视频的兴趣似乎在迅速增长；虽然只有9.8％的受访者在2017年底发布 HDR，但计划在2018年底之前发布 HDR 的比例为50.6％，49.4％的用户没有超出标准动态范围的计划。</p><p>“苹果HEVC采用的影响：基于调查的报告”，现在可以<a href="http://www.streamingmedia.com/Research/7694-The-Impact-of-Apple&#39;s-HEVC-Adoption-A-Survey-Based-Report.htm" target="_blank" rel="noopener">下载</a>。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 译文 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【译】人工智能和机器学习将视频质量推向新的高度</title>
      <link href="/2018/02/25/translate-AI-and-Machine-Learning-Push-Video-Quality-to-New-Heights/"/>
      <url>/2018/02/25/translate-AI-and-Machine-Learning-Push-Video-Quality-to-New-Heights/</url>
      
        <content type="html"><![CDATA[<p>英语原文：<a href="http://www.streamingmediaglobal.com/Articles/ReadArticle.aspx?ArticleID=123274" target="_blank" rel="noopener">AI and Machine Learning Push Video Quality to New Heights</a>   </p><p>人工智能和机器学习将视频质量推向新的高度<br>人工智能和机器学习以及深度学习和神经网络正在解决编码质量到隐藏字幕的 OTT（Over To Top）挑战。<br>作者：Ankur Patel<br>发布时间：2018-02-15</p><p><em>[对人工智能和机器学习如何彻底改变视频感兴趣？加入我们2月27日在伦敦的<a href="http://www.streaming-forum.com/2018/" target="_blank" rel="noopener">流媒体论坛</a>，我们将介绍亚马逊，IBM等专注于人工智能和机器学习的演讲。]</em></p><p>自从1928年第一次播出电视节目以来，视频技术已经从模拟标准清晰度（SD）黑白电视到 OTT 数字高清（HD）流式传输到数百个的连接设备。根据思科最新的可视网络指数，到2021年视频流量将占所有互联网流量的82%，高于2016年的73%。而且，思科首席执行官 Chuck Robbins 预测，到2020年每小时将有100万台设备添加到网络中。 OTT 视频流最大的挑战是提供尽可能高的体验质量（QoE）和服务质量（QoS）。</p><a id="more"></a><p>根据马萨诸塞大学阿默斯特分校的 Ramesh K. Sitarman 教授发表的一篇论文，观众在2秒延迟后开始放弃一个视频，其后每秒钟有6％消失。缓冲和像素化会导致数字广告带来负面的用户体验和收入损失。通过根据需要切换比特率并通过带宽波动，自适应比特率（ABR）流已经被采用来保证最小化缓冲。 ABR 的概念解决了 OTT 流媒体的部分挑战。但是，考虑到移动用户的位置和连接性的动态变化，ABR不能完全消除移动手持设备上的重新缓冲和像素化，需要重新缓冲过去的事物。另外，诸如快进和快退等其他复杂性通常会导致播放停顿，从而产生负面的用户体验。</p><p>这些挑战的答案隐藏在人工智能（AI）和机器学习的新技术概念中。麻省理工学院的计算机科学和人工智能实验室（CSAIL）开发了 Pensieve 神经网络，这是一种人工智能（AI）系统，它使用机器学习来选择不同的现有算法，例如基于速率的算法，取决于网络条件的基于缓冲区的算法。 Pensieve 神经网络提前预测连接问题，并预测性地调整流分辨率，为无缓冲用户体验创建足够的回放缓冲区。实际上，这种方法不会完全消除缓冲，但它可以帮助减少缓冲，让我们更接近无缓冲视频流。使用 Pensieve 神经网络进行的现场实验减少了30％的重新缓冲，并将主要 QoE 矩阵增加了25％。然而，随着更全面的数据可用于训练 Pensieve 神经网络，总会有进一步改进的空间。</p><p>视频流也可以受益于机器学习技术的进步。 YouTube 和 Netflix 采用机器学习动态优化编码参数。这不仅增加了用户的 QoE 和 QoS，而且还减少了相同质量所需的比特数。使用机器学习的编码优化还可以帮助优化带宽使用率较低的成本。它还将减少以前用于手动优化的工程资源成本。就 YouTube 来说，神经网络（NN）用于动态预测视频编码量化等级（QL），该等级可以产生目标比特率，并且在单程中实现双通编码的性能。因此，它也将减少整体视频延迟和编码成本。</p><p>从手持移动设备到大屏幕电视的连接设备的可用性已经产生了许多挑战，因为不同的屏幕尺寸可以使感知视频质量产生巨大差异。静态编码模型不具有成本效益，因为它们不会将屏幕大小和场景复杂度计算在内。机器学习算法可用于基于视频的感知质量来实现“内容感知”编码。机器学习算法可以根据针对该特定屏幕尺寸的屏幕大小和目标感知质量来决定编码参数。例如，为了在两种不同的屏幕尺寸上实现相同的感知质量，一个屏幕所需的位数可能比另一个屏幕少得多。机器学习可以帮助我们即时执行此操作，从而减少带宽消耗并节省成本。</p><p>人工智能和机器学习可以为动态检测唇形同步和隐藏字幕（CC）文本同步问题提供有效的解决方案，否则需要主动眼球检测或使用侵入性方法，例如在基带视频中插入水印或指纹（SDI）和音频。由牛津大学计算机科学系使用名为 LipNet 的人工智能系统进行的实验可以识别出准确率为93.4％的单词，而与仅达到52.3％的人类专业人员相比，其准确性达到了93.4％。 Google DeepMind 项目进行的类似测试表明，AI 很容易胜过试图破译200个随机剪辑数据集的专业口头读者。 人工智能成功破译了所有单词的46.8％，而专业唇读者则破译了12.4％。市场上出现的产品使用AI和机器学习来检测唇形同步和 CC 文本同步问题。一种这样的产品是来至于 Multicoreware 公司的 Li​​pSync，它使用人工智能和深度学习来跟踪嘴唇的运动以测量视频-音频同步。</p><p>随着我们进入人工智能的世界，新的概念和理论正在出现，以优化内容生成，准备，交付，安全和演示。例如，深度神经网络的实施对 YouTube 视频推荐系统产生了巨大的积极影响。更为有希望的是基于人工智能和机器学习的下一代高度直观的网络，这将对 OTT 视频流产生巨大的积极影响，改变其采用和增长以及增强内容安全性。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 译文 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2017年度总结</title>
      <link href="/2017/12/31/2017-12-31-annual-summary/"/>
      <url>/2017/12/31/2017-12-31-annual-summary/</url>
      
        <content type="html"><![CDATA[<p>今天是2017年12月31日，2017年的最后一天。马上就2018年了，在2017年有什么收获呢。仔细想想，好像没有什么收获，也没有印象最深的事情。</p><p>工作中做出的一点成绩就是开发了 iOS 平台的短视频 SDK，服务了一批企业客户。从2017年5月到现在主要就是做短视频 SDK 的事情，为了赶进度，每天都过的很快，没什么感觉。2017年下半年开始带人做一些事情，算是走带团队的路线了，发现在带人上经验上还需要完善，这方面有些小收获。</p><a id="more"></a><p>生活中最大的变化就是自己想找个人结婚了。这一点改变对我而言，是个很大的变化，2017年上半年，我对结婚这件事都没怎么放在心上。但到了2017年10月后，不知怎么了就非常想结婚了。</p><p>2017年工作上没有什么大的提升和成就感，生活上也平平淡淡，这一年就这么过去了，有点可惜。2018年，就30岁了，房子装修、买车、结婚是最重要的事情了。2018年最最重要的事情就是领结婚证。</p><p align="right">二〇一七年十二月三十一日，北京</p>]]></content>
      
      
      
        <tags>
            
            <tag> 工作 </tag>
            
            <tag> 生活 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用 gitment 制作 GitHub 博客的评论系统</title>
      <link href="/2017/08/12/use-gitment-as-comment-system/"/>
      <url>/2017/08/12/use-gitment-as-comment-system/</url>
      
        <content type="html"><![CDATA[<p>多说评论系统在2017年6月1日关闭服务后，对于自建博客该使用哪款评论系统我犯愁了。我仔细对比了国内的一些评论系统，发现没有一款能比得上多说。虽然我之前的多说评论在导出时发生了数据错乱以至于数据无法导进新的评论系统，但是我从内心底对维护多说服务的技术人员表示认可。在知道多说即将关闭服务之后，我立即就选用了 Disqus。Disqus 真的很难用，一是需要翻墙，二是可视化界面做的太糟糕。不想在评论系统上大费周折，就将就用到了现在。终于忍无可忍，搜索了些资料发现了基于 GitHub issue 的 <a href="https://github.com/imsun/gitment" target="_blank" rel="noopener">gitment</a> 和 <a href="https://github.com/gitalk/gitalk" target="_blank" rel="noopener">gitalk</a> 两款评论插件。经过比较我选用了 <a href="https://github.com/imsun/gitment" target="_blank" rel="noopener">gitment</a>。</p><a id="more"></a><p><a href="https://github.com/imsun/gitment" target="_blank" rel="noopener">gitment</a> 和 <a href="https://github.com/gitalk/gitalk" target="_blank" rel="noopener">gitalk</a> 这两款评论插件对于如何部署都没有说的很清晰。建议参考<br><a href="https://github.com/imsun/gitment/blob/master/README.md" target="_blank" rel="noopener">gitment readme</a> 和 <a href="https://github.com/iissnan/hexo-theme-next/pull/1634/files" target="_blank" rel="noopener">Add Gitment Support</a>，即可部署成功。</p><p>本人博客基于 <a href="https://github.com/" target="_blank" rel="noopener">github托管平台</a> + <a href="https://hexo.io" target="_blank" rel="noopener">hexo博客框架</a> + <a href="https://github.com/iissnan/hexo-theme-next" target="_blank" rel="noopener">next博客主题</a> + <a href="https://github.com/imsun/gitment" target="_blank" rel="noopener">gitment评论插件</a> 资源构建。  </p><p align="right">二〇一七年八月十二日，北京</p>]]></content>
      
      
      
        <tags>
            
            <tag> 工作 </tag>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>人生到处知何似，应似飞鸿踏雪泥</title>
      <link href="/2017/07/04/recalling-the-old-days/"/>
      <url>/2017/07/04/recalling-the-old-days/</url>
      
        <content type="html"><![CDATA[<center>和子由渑池怀旧<br>苏轼<br>人生到处知何似，应似飞鸿踏雪泥。<br>泥上偶然留指爪，鸿飞那复计东西。<br>老僧已死成新塔，坏壁无由见旧题。<br>往日崎岖还记否，路上人困蹇驴嘶。<br></center><p>每一场剧的谢幕，都将会有一场新剧情演绎。体会这过程，人生阶段的爱恨交加才能不偏不倚，急于实现内心的渴求，往往在达到目标之后深深地感悟到人生的那些阶段本不该如此，人生的每个阶段应该是快乐的、幸福的，简单的。虽有现实的，人性的因素，让内心波浪起伏，只能说经历太少，对人生和生活理解的并不透彻。人生历程的持续，人生观、世界观、价值观都在向前演绎，是变好了，还是变坏了，取决于生活的态度。社会的浮躁，人心的攀比，在这人与社会演进的长河中，是走在岸边看风景，还是被吸进河中陷于疲惫挣扎。人需要有欲望，需要尝试，才能感悟。千人千种经历千种感悟，不变的是最终都会回归到来到出生时最简单的世界。人生每十年是一个阶段，十岁前的自己，二十岁前的自己，三十岁前的自己，四十岁前的自己……想一想，社会教会了人识别复杂的事物，人也从复杂中的事物中明白了最简单的道理。人生不过百余年，有所得，有所失，患得患失才是罪过。往前一步，可以向后看，不能后悔但需反思。读懂内心，何处不是“面朝大海，春暖花开。”</p><a id="more"></a><p align="right">二〇一七年七月四日，北京</p>]]></content>
      
      
      
        <tags>
            
            <tag> 生活 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>分析 H.265 + AAC 的 FLV 文件</title>
      <link href="/2017/07/01/analyse-h265-flv/"/>
      <url>/2017/07/01/analyse-h265-flv/</url>
      
        <content type="html"><![CDATA[<p>常见的 FLV 文件里封装的是 H.264 和 AAC 数据。对于 H.265(HEVC)，FLV 支不支持呢，答案是官方版本不支持。想用 FLV 封装 H.265 数据，那该怎么搞？首先，需要一套 H.265 的编解码器，其次，就是扩展 FLV 的头 header，其实是增加对 H.265 CodecID 的支持。</p><p>今年6月6日苹果开发者大会开放了 iOS 平台的 HEVC API，也就是开发者可以调用 iOS 系统的 API 进行 H.265 硬编码了，但是只能在 iOS 11.0 及以上版本使用。目前，iOS 11.0 正式版还未正式发布，需要等到今年的9月份。不建议开发者将自己的 iOS 设备刷到 iOS 11.0 beta 版，因为升级 beta 版后非常卡。经测试，苹果的 H.265 编码出来的图像质量还是可以的，但是消耗码率较高。</p><p>苹果开放 H.265 编解码 API 势必会影响到整个 H.265 行业的发展，但 H.265 离真正落地和普及还需要时间。明年（2018年）再看 H.265 对整个音视频行业的影响。</p><a id="more"></a><p>去年，我们团队就已经实现 H.265 直播推流和播放了，采用的是 H.265 软编码和软解码器，推流端使用 500K 码率就能推送 24 帧，720P 的视频流，设备的性能消耗在可接受的范围内，播放端画质相当清晰。</p><p>言归正传，分析下 H.265+AAC 的 FLV 文件。</p><p><img src="https://raw.githubusercontent.com/depthlove/depthloveBlog/cd5e12823ac4e243a62893f9c942fad766a6c908/source/images/analyse-h265-flv/analyse-h265-flv-00.jpg" alt="H.265+AAC的FLV"></p><p>关于 H.265 的 VPS、SPS、PPS 等知识点的解释，可参看文章：<br><a href="http://blog.csdn.net/u012868357/article/details/48974967" target="_blank" rel="noopener">VPS SPS PPS</a><br><a href="http://blog.csdn.net/lin453701006/article/details/52797104" target="_blank" rel="noopener">HEVC编码结构：序列参数集SPS、图像参数集PPS、视频参数集VPS</a><br><a href="http://blog.csdn.net/leixiaohua1020/article/details/46412607" target="_blank" rel="noopener">FFmpeg的HEVC解码器源代码简单分析：解析器（Parser）部分</a><br><a href="http://blog.csdn.net/nb_vol_1/article/details/50210487" target="_blank" rel="noopener">homerHEVC代码阅读（21）——基本流程</a><br><a href="http://blog.csdn.net/lin453701006/article/details/52797415" target="_blank" rel="noopener">HEVC概念缩写对照表</a></p><p>想了解关于 FLV 的更多细节请看文章<a href="https://depthlove.github.io/2015/11/13/flv-analysis-in-rtmp-live-play">rtmp直播推流（一）－－flv格式解析与封装</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> 音视频处理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>深度学习项目移植之使用 cmake 编译 iOS 平台库</title>
      <link href="/2017/05/21/use-cmake-to-build-ios-lib/"/>
      <url>/2017/05/21/use-cmake-to-build-ios-lib/</url>
      
        <content type="html"><![CDATA[<p>去年（2016年）做深度学习项目的移动端移植用到了 cmake，现在把当时写的一篇使用流程贴出来，主要目的是备忘。废话不多说，直接进入正题。</p><h2 id="1-下载-X11-并安装"><a href="#1-下载-X11-并安装" class="headerlink" title="1. 下载 X11 并安装"></a>1. 下载 X11 并安装</h2><p>关于 Mac 版 X11，Mac 不再随附 X11，但 XQuartz 项目会提供 X11 服务器和客户端库。XQuartz 项目提供适用于 MacOS 的 X11 服务器和客户端库，网址是 <a href="https://www.xquartz.org" target="_blank" rel="noopener">https://www.xquartz.org</a>。下载可用的最新版本并安装。具体说明见：<a href="https://support.apple.com/zh-cn/HT201341" target="_blank" rel="noopener">关于 Mac 版 X11</a></p><h2 id="2-下载-cmake-的-dmg-格式并安装"><a href="#2-下载-cmake-的-dmg-格式并安装" class="headerlink" title="2. 下载 cmake 的 dmg 格式并安装"></a>2. 下载 cmake 的 dmg 格式并安装</h2><p>下载地址: <a href="https://cmake.org/download/" target="_blank" rel="noopener">https://cmake.org/download/</a>，本文使用的是 Mac OSX 10.6 or later，cmake-3.7.1-Darwin-x86_64.dmg 版本。</p><h2 id="3-终端安装-cmake"><a href="#3-终端安装-cmake" class="headerlink" title="3. 终端安装 cmake"></a>3. 终端安装 cmake</h2><p>在终端执行命令：</p><pre><code>sudo &quot;/Applications/CMake.app/Contents/bin/cmake-gui&quot; --install</code></pre><a id="more"></a><h2 id="4-进入包含-CMakeLists-txt-文件的源码文件夹-xxx-并执行命令得到-Mac-工程（注意：命令的空格）"><a href="#4-进入包含-CMakeLists-txt-文件的源码文件夹-xxx-并执行命令得到-Mac-工程（注意：命令的空格）" class="headerlink" title="4. 进入包含 CMakeLists.txt 文件的源码文件夹 xxx 并执行命令得到 Mac 工程（注意：命令的空格）"></a>4. 进入包含 CMakeLists.txt 文件的源码文件夹 xxx 并执行命令得到 Mac 工程（注意：命令的空格）</h2><p>在终端依次执行下面的命令：<strong><em>（备注：xxx 为工程的名称）</em></strong></p><pre><code>cd xxxmkdir buildcd buildcmake -G Xcode ..</code></pre><h2 id="5-将-Mac-工程改为-iOS-工程"><a href="#5-将-Mac-工程改为-iOS-工程" class="headerlink" title="5. 将 Mac 工程改为 iOS 工程"></a>5. 将 Mac 工程改为 iOS 工程</h2><p>(1) 进入 build 文件夹，打开 Project.xcodeproj 工程，Duplicate TARGET “xxx”，生成了1个新的 TARGET “xxx copy” <strong><em>（备注：xxx 为 TARGET 的名称，跟 章节 4 中的 xxx 是同名的，也就是说章节 3 中的 xxx 决定了此处 Xcode 项目的 TARGET 名称）</em></strong></p><p>(2) 将 TARGET “xxx copy” 改名为 “xxx-iOS”</p><p>(3) 进入 TARGET “xxx-iOS” 的 Build Settings，将 Architectures 下的 Base SDK 改为 Latest iOS(iOS 10.2)，此时 Architectures，Supported Platforms，Valid Architectures 都会变成跟 iOS 平台相关的设置</p><p>(4) 修改 iOS Deployment Target 为想要支持的最低版本，此处设置支持的 iOS 最低版本为 iOS 7.0</p><p>(5) 在 Xcode 的左上角选择工程 xxx copy，接着进入 Manage Schemes，将 xxx copy 更名为 xxx-iOS</p><h2 id="6-编译-xxx-iOS-即可得到-iOS-静态库-libxxx-iOS-a"><a href="#6-编译-xxx-iOS-即可得到-iOS-静态库-libxxx-iOS-a" class="headerlink" title="6. 编译 xxx-iOS 即可得到 iOS 静态库 libxxx-iOS.a"></a>6. 编译 xxx-iOS 即可得到 iOS 静态库 libxxx-iOS.a</h2><h2 id="7-终端执行命令-lipo-info-libxxx-iOS-a-查看-iOS-静态库支持的-Architectures-（如：armv7，arm64，x86-64，i386）"><a href="#7-终端执行命令-lipo-info-libxxx-iOS-a-查看-iOS-静态库支持的-Architectures-（如：armv7，arm64，x86-64，i386）" class="headerlink" title="7. 终端执行命令 lipo -info libxxx-iOS.a 查看 iOS 静态库支持的 Architectures （如：armv7，arm64，x86_64，i386）"></a>7. 终端执行命令 lipo -info libxxx-iOS.a 查看 iOS 静态库支持的 Architectures （如：armv7，arm64，x86_64，i386）</h2><p>在终端执行命令：</p><pre><code>lipo -info libxxx-iOS.a</code></pre><p>输出结果为</p><p>Architectures in the fat file: libxxx-iOS.a are: armv7 arm64</p><p>若要生成 x86_64，i386 模拟器架构，就需要在使用 Xcode 编译的时候编译相应的 x86_64，i386 库。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 工作 </tag>
            
            <tag> iOS </tag>
            
            <tag> 深度学习 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2017.5.20谈感受</title>
      <link href="/2017/05/20/2017-5-20-idea/"/>
      <url>/2017/05/20/2017-5-20-idea/</url>
      
        <content type="html"><![CDATA[<p>今天是5月20号，微信里各种撒狗粮、秀恩爱。这一切，都跟我没什么关系，该看资料看资料，该写代码写代码，该睡就睡。日子就是这么单调、有规律。</p><p>翻了翻博客里以前的文章，最近一年没怎么写技术性文章，写的都是些心情、感悟。工作忙是一个原因，生活中对未来的规划的不确定性也是一个导致自己静不下心来写技术性文章的原因。以前，还会看看文学方面的书，放松下。现在，书看的少了，写起东西来词穷，流水账的陈述，自己都看不顺眼了。文字这东西很奇妙，把内心的心情通过文字表述出来，能释放压力，缓解精神上的负担。当寂寞空虚冷的时候，就真正明白书和文字才是疗伤的良药。</p><p>写到这里，想起一句话，原文不记得了，意思大概是“当你没能力时，遇到想要呵护的人是那么地难，当你有能力时，那个对的人已经离你而去”。生活就是这样，得向前看，你只要往回看，伤心是难免的。</p><a id="more"></a><p>生活要积极向上，活得才有激情。没激情的生活，过久了就堕落了。我发现自己在精神上已经堕落了，生活中缺乏趣味，缺乏激情。2017年已经过去了一半，那就抓紧将来的时间，活得开心、快乐，才能有健康的精神面貌、世界观和人生观。</p><p>以上文字纯粹是流水账，想到什么写什么。用“该文言语简单、质朴、写实，有可取之处”来抚慰下自己词穷的囧态。好了，到了文章结束的时候了，嗯，那就结束吧。</p><p align="right">二〇一七年五月二十日，北京</p>]]></content>
      
      
      
        <tags>
            
            <tag> 生活 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>也无风雨也无晴</title>
      <link href="/2017/05/14/a-quiet-life/"/>
      <url>/2017/05/14/a-quiet-life/</url>
      
        <content type="html"><![CDATA[<center><br>定风波/定风波·三月七日<br>【作者】苏轼 【朝代】宋<br>三月七日， 沙湖道中遇雨。 雨具先去， 同行皆狼狈， 余独不觉。 已而遂晴， 故作此。<br>莫听穿林打叶声， 何妨吟啸且徐行。 竹杖芒鞋轻胜马， 谁怕？ 一蓑烟雨任平生。<br>料峭春风吹酒醒， 微冷， 山头斜照却相迎。 回首向来潇瑟处， 归去， 也无风雨也无晴。<br><br></center><a id="more"></a><p>用苏轼老先生的一首词来表达我二零一七年上半年的心境。二零一七年上半年去了天津、上海、厦门、东莞、珠海，假装很开心，假装看起来不在乎，其实内心早已如凉水。人生中定的目标不应受环境和事物的影响而放弃，否则会活的很纠结。打开心结，释放内心，做一个洒脱的人，一个快乐的人。</p><p align="right">二〇一七年五月十四日，北京</p>]]></content>
      
      
      
        <tags>
            
            <tag> 生活 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用 tensorflow 学习梵高画作</title>
      <link href="/2017/01/19/tensorflow-neural-style/"/>
      <url>/2017/01/19/tensorflow-neural-style/</url>
      
        <content type="html"><![CDATA[<p>配一台个人使用的深度学习机器大概会花费2万人民币，比如其中的核心部件英伟达 Titan X GPU 售价大概9000人民币左右，这个价格对于一般人还是略贵的。想深层次进入深度学习应用领域，花点钱是必须的。正所谓有投入才有产出。本人现在还没有入手深度学习机器的预算，所以使用 Mac Pro 利用 CPU 计算来玩玩简单点的深度学习项目。</p><p>我的 Mac Pro 配置为：</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">OS X EI Capitan</span><br><span class="line">版本 <span class="number">10.11</span><span class="number">.6</span> (<span class="number">15</span>G1212)</span><br><span class="line">MacBook Pro（<span class="number">13</span> 英寸，<span class="number">2015</span> 年初期）</span><br><span class="line">处理器 <span class="number">2.7</span> GHz Intel Core i5</span><br><span class="line">内存 <span class="number">8</span> GB <span class="number">1867</span> MHz DDR3</span><br><span class="line">启动磁盘 Macintosh HD</span><br><span class="line">图形卡 Intel Iris Graphics <span class="number">6100</span> <span class="number">1536</span> MB</span><br></pre></td></tr></table></figure><a id="more"></a><h3 id="1-在-Mac-上安装-Anaconda-软件"><a href="#1-在-Mac-上安装-Anaconda-软件" class="headerlink" title="1. 在 Mac 上安装 Anaconda 软件"></a>1. 在 Mac 上安装 Anaconda 软件</h3><p><img src="http://images2015.cnblogs.com/blog/719115/201701/719115-20170119195435984-525274691.png" alt="Anaconda 软件界面"></p><h3 id="2-建立-tensorflow-的-conda-计算环境"><a href="#2-建立-tensorflow-的-conda-计算环境" class="headerlink" title="2. 建立 tensorflow 的 conda 计算环境"></a>2. 建立 tensorflow 的 conda 计算环境</h3><p>这里提一下有关 python 版本的问题，现在最稳定最常用的 python 版本是 2.7 和 3.5。入门 python 的话，建议从 2.7 版本入手，然后再过渡到 python 3.x 版本。我这里选用 tensorflow 依赖的 python 版本为 2.7。</p><p>在 Mac 终端执行命令：</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda create -n tensorflow <span class="attribute">python</span>=2.7</span><br></pre></td></tr></table></figure><p><img src="http://images2015.cnblogs.com/blog/719115/201701/719115-20170119210947859-1111890790.png" alt="conda 创建 tensorflow 空间"></p><p>执行完命令后，可以看到</p><pre><code>## To activate this environment, use:# &gt; source activate tensorflow## To deactivate this environment, use:# &gt; source deactivate tensorflow#</code></pre><p>在 Mac 终端执行命令 <code>source activate tensorflow</code> 可以激活名为 tensorflow 的 conda 计算环境，执行命令 <code>source deactivate tensorflow</code> 能关闭 conda 计算环境。</p><h3 id="3-运行名为-tensorflow-的-conda-计算环境"><a href="#3-运行名为-tensorflow-的-conda-计算环境" class="headerlink" title="3. 运行名为 tensorflow 的 conda 计算环境"></a>3. 运行名为 tensorflow 的 conda 计算环境</h3><p>在 Mac 终端执行命令激活 conda 计算环境</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source <span class="built_in">activate</span> tensorflow</span><br></pre></td></tr></table></figure><p><img src="http://images2015.cnblogs.com/blog/719115/201701/719115-20170119215425593-252567153.png" alt="激活 conda 计算环境"></p><p>命令执行完之后，终端最左边会出现 (tensorflow) ，说明名为 tensorflow 的 conda 计算环境被激活了。</p><h3 id="4-使用-pip-安装-tensorflow-深度学习框架"><a href="#4-使用-pip-安装-tensorflow-深度学习框架" class="headerlink" title="4. 使用 pip 安装 tensorflow 深度学习框架"></a>4. 使用 pip 安装 tensorflow 深度学习框架</h3><p>仍然是在 Mac 终端执行命令：</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install <span class="params">--ignore-installed</span> <span class="params">--upgrade</span> https:<span class="string">//storage.googleapis.com/tensorflow/mac/tensorflow-0.8.0rc0-py2-none-any.whl</span></span><br></pre></td></tr></table></figure><p><img src="http://images2015.cnblogs.com/blog/719115/201701/719115-20170119220557046-2012970460.png" alt="pip 安装 tensorflow"></p><p>安装过程中，出现以下错误提示，说明网络不好，或者需要使用 vpn 翻墙。多试几次就能安装成功了。<br><img src="http://images2015.cnblogs.com/blog/719115/201701/719115-20170119220749421-424094784.png" alt="安装超时，出错"></p><h3 id="5-验证-tensorflow-深度学习框架安装成功"><a href="#5-验证-tensorflow-深度学习框架安装成功" class="headerlink" title="5. 验证 tensorflow 深度学习框架安装成功"></a>5. 验证 tensorflow 深度学习框架安装成功</h3><p>在 Mac 终端执行命令，进入 python 环境</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">python</span></span><br></pre></td></tr></table></figure><p>执行一个简单的 tensorflow 小程序来验证深度学习框架是否安装成功，小程序如下：</p><pre><code>import tensorflow as tfhello = tf.constant(&apos;Hello, TensorFlow!&apos;)sess = tf.Session()print sess.run(hello)a = tf.constant(10)b = tf.constant(32)print sess.run(a+b)</code></pre><p><img src="http://images2015.cnblogs.com/blog/719115/201701/719115-20170119232634984-1600377688.png" alt="执行 python 命令，运行 tensorflow 小程序"></p><p>上面的小程序能正常运行，说明 tensorflow 深度学习框架安装成功了。此时，可以在软件 Anaconda 中查看名称为 tensorflow 的 conda 计算环境，如下图所示：</p><p><img src="http://images2015.cnblogs.com/blog/719115/201701/719115-20170119233341234-1329704415.png" alt="Anaconda 中查看名称为 tensorflow 的 conda 计算环境"></p><h3 id="6-加载-neural-style-神经网络训练代码"><a href="#6-加载-neural-style-神经网络训练代码" class="headerlink" title="6. 加载 neural-style 神经网络训练代码"></a>6. 加载 neural-style 神经网络训练代码</h3><p>项目 neural-style 位于 github 上，地址为 <a href="https://github.com/anishathalye/neural-style" target="_blank" rel="noopener">https://github.com/anishathalye/neural-style</a></p><p>创建或者选择一个文件夹来存放 neural-style 代码，使用 git clone 方式 download 代码，命令如下：</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="keyword">clone</span> <span class="title">https</span>://github.com/anishathalye/neural-style.git</span><br></pre></td></tr></table></figure><p><img src="http://images2015.cnblogs.com/blog/719115/201701/719115-20170119235126296-418324233.png" alt="下载 neural-style 代码"></p><p>项目 neural-style 会依赖 pillow，因此还需要安装 pillow，在终端执行命令：</p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip <span class="keyword">install</span> pillow</span><br></pre></td></tr></table></figure><p><img src="http://images2015.cnblogs.com/blog/719115/201701/719115-20170119235240281-926099681.png" alt="安装 pillow"></p><h3 id="7-加载数据模型"><a href="#7-加载数据模型" class="headerlink" title="7. 加载数据模型"></a>7. 加载数据模型</h3><p>在终端执行命令：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http:<span class="regexp">//</span>www.vlfeat.org<span class="regexp">/matconvnet/m</span>odels<span class="regexp">/beta16/im</span>agenet-vgg-verydeep-<span class="number">19</span>.mat</span><br></pre></td></tr></table></figure><p> <img src="http://images2015.cnblogs.com/blog/719115/201701/719115-20170119235505140-1370501613.png" alt></p><p> <img src="http://images2015.cnblogs.com/blog/719115/201701/719115-20170119235528781-103216887.png" alt></p><p>使用 wget 下载数据模型太慢了，简直不能忍，imagenet-vgg-verydeep-19.mat 文件还挺大，有576M。时间就是生命，生命不该浪费在下载上，果断使用 <code>ctrl + c</code> 中断了 wget 下载，如果你能忍受 wget ，那你就用 wget 吧，反正也能下载，就是慢点。为了节约点时间，神奇的淘宝就要闪亮登场了，我在淘宝上先花了1毛钱买了一天的迅雷会员，可是并没有像商家说的秒发账号密码。为了节约时间，果断地又花了1块钱买了一个月的迅雷会员，嗯，这家发货挺快的，接下来就是用迅雷加速下载链接 <a href="http://www.vlfeat.org/matconvnet/models/beta16/imagenet-vgg-verydeep-19.mat" target="_blank" rel="noopener">http://www.vlfeat.org/matconvnet/models/beta16/imagenet-vgg-verydeep-19.mat</a></p><p>imagenet-vgg-verydeep-19.mat 下载完成后，将其移动到 neural-style 根目录下，如下图所示：</p><p><img src="http://images2015.cnblogs.com/blog/719115/201701/719115-20170120001629546-441644004.png" alt="数据模型存放路径"></p><h3 id="8-开启深度学习之梵高的大门"><a href="#8-开启深度学习之梵高的大门" class="headerlink" title="8. 开启深度学习之梵高的大门"></a>8. 开启深度学习之梵高的大门</h3><p>进入 neural-style 目录，将需要处理的图片 nuc.jpg 放入目录 examples 中。nuc_output.jpg 为处理之后输出的文件名称。如果要处理图片 xyz.jpg 就将其放入 目录 examples 中，至于输出文件的名称可以随便设置，比如可以设置为 xyz_output.jpg。</p><p>在终端执行命令 A</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python neural_style.py <span class="params">--content</span> <span class="string">./examples/nuc.jpg</span> <span class="params">--styles</span> <span class="string">./examples/1-style.jpg</span> <span class="params">--output</span> <span class="string">./examples/nuc_output.jpg</span> <span class="params">--iterations</span> 1500</span><br></pre></td></tr></table></figure><p>其中，1-style.jpg 为梵高大师画作，也就是需要学习的对象，这里也可以改为梵高的 2-style1.jpg 或 2-style2.jpg 来作为学习的对象。–iterations 1500 表示迭代次数，如果用笔记本或者普通的台式机就减少迭代次数，因为机器运算太慢了，1500 次迭代不知道要何年何月才能执行完。<code>但是迭代次数在 1000 至 2000 之间处理的效果会比较理想</code>。</p><p>在我的 Mac Pro 上设置的迭代次数为 100 次，得到处理后的图片效果还可以。需要提一下，在我的 Mac pro （配置前面已经给出） 上迭代1次大概会花费3分钟，迭代 100 次需要花费 5小时，毕竟是基于 CPU 计算，运算慢。要是有台 GPU 机器该有多爽，哈哈，想想而已，嘻嘻。</p><p><img src="http://images2015.cnblogs.com/blog/719115/201701/719115-20170120004050156-1048917434.png" alt="开始迭代"></p><p>哦呵，出现了 error 提示，原因在于没有安装 scipy。在终端执行命令安装 scipy</p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip <span class="keyword">install</span> scipy</span><br></pre></td></tr></table></figure><p><img src="http://images2015.cnblogs.com/blog/719115/201701/719115-20170120004101859-1719031783.png" alt="安装 scipy"></p><p>将迭代次数改为 100次，再次执行命令 A</p><p><img src="http://images2015.cnblogs.com/blog/719115/201701/719115-20170120004131406-901903984.png" alt="迭代 100次"></p><p><img src="http://images2015.cnblogs.com/blog/719115/201701/719115-20170120004140046-1598886231.png" alt="迭代 100次 续"></p><p>OK，到此，所有步骤结束，我们可以看看经过深度学习处理之后的图片效果了。</p><h3 id="9-查看处理后的图片效果"><a href="#9-查看处理后的图片效果" class="headerlink" title="9. 查看处理后的图片效果"></a>9. 查看处理后的图片效果</h3><p>进入 neural-style/examples 目录，查看目标图片 nuc_output.jpg </p><p><img src="http://images2015.cnblogs.com/blog/719115/201701/719115-20170120004950328-576212904.png" alt></p><p>梵高大师画作 1-style.jpg 如下：</p><p><img src="http://images2015.cnblogs.com/blog/719115/201701/719115-20170120005037984-1130888407.jpg" alt="梵高画"></p><p>选取了一张我就读过的大学的图书馆照片 nuc.jpg 作为需要处理的图片，如下：</p><p><img src="http://images2015.cnblogs.com/blog/719115/201701/719115-20170120005049062-618427893.jpg" alt="原图，我的大学校园图书馆"></p><p>迭代 100次，学习梵高大师画风后得到的处理后的目标图片 nuc_output.jpg，如下：<br><img src="http://images2015.cnblogs.com/blog/719115/201701/719115-20170120005104421-824057092.jpg" alt="梵高画风的大学图书馆"></p><h5 id="参考文献："><a href="#参考文献：" class="headerlink" title="参考文献："></a>参考文献：</h5><p><a href="http://wiki.jikexueyuan.com/project/tensorflow-zh/get_started/os_setup.html" target="_blank" rel="noopener">http://wiki.jikexueyuan.com/project/tensorflow-zh/get_started/os_setup.html</a></p><p><a href="https://github.com/anishathalye/neural-style" target="_blank" rel="noopener">https://github.com/anishathalye/neural-style</a></p><p>迭代 1次，2次，10次，20次，30次，40次，100次输出的图片合成的 GIF 图，如下</p><p><img src="http://images2015.cnblogs.com/blog/719115/201701/719115-20170120013703062-275928298.gif" width="240" height="240"></p>]]></content>
      
      
      
        <tags>
            
            <tag> 深度学习 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>tensorflow 在 iOS 平台上的应用</title>
      <link href="/2017/01/16/tensorflow-iOS-application/"/>
      <url>/2017/01/16/tensorflow-iOS-application/</url>
      
        <content type="html"><![CDATA[<p>Google 开源的深度学习框架 tensorflow 成为2016年最受欢迎的深度学习框架之一。tensorflow 除了支持 pc 端外，还较好的支持了 android，iOS 移动端平台。移动端作为现在互联网的终端主宰，tensorflow 毫无疑问地会引起移动互联网行业的广泛关注。深度学习在2016年的火爆，以及移动终端的主宰地位，作为程序员的我们，不玩玩 tensorflow  简直就 out 了。</p><h3 id="1-fork-Github-上的-tensorflow-repo"><a href="#1-fork-Github-上的-tensorflow-repo" class="headerlink" title="1. fork Github 上的 tensorflow repo"></a>1. fork Github 上的 tensorflow repo</h3><p>tensorflow 的仓库 repo 位于 Github 上，我们作为开发者要在其基础上做开发，首先就需要 fork 一份 repo 到自己的 Github 账户下。</p><h3 id="2-参考-tensorflow-的官方使用文档编译（使用-tensorflow-r1-0-版本）"><a href="#2-参考-tensorflow-的官方使用文档编译（使用-tensorflow-r1-0-版本）" class="headerlink" title="2. 参考 tensorflow 的官方使用文档编译（使用 tensorflow r1.0 版本）"></a>2. 参考 tensorflow 的官方使用文档编译（使用 tensorflow r1.0 版本）</h3><p>参考<a href="https://github.com/tensorflow/tensorflow/blob/master/tensorflow/contrib/makefile/README.md" target="_blank" rel="noopener">tensorflow 的官方使用文档</a>编译 iOS 平台上的 tensorflow 库。</p><a id="more"></a><p><strong>_Note: To use this library in an iOS application, see related instructions in<br>the <a href="../ios_examples/">iOS examples</a> directory._</strong></p><p>Install XCode 7.3 or more recent. If you have not already, you will need to<br>install the command-line tools using <code>xcode-select</code>:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xcode-select --install</span><br></pre></td></tr></table></figure><p>If this is a new install, you will need to run XCode once to agree to the<br>license before continuing.</p><p>Then install <a href="https://en.wikipedia.org/wiki/Automake" target="_blank" rel="noopener">automake</a>/<a href="https://en.wikipedia.org/wiki/GNU_Libtool" target="_blank" rel="noopener">libtool</a>:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">brew install automake</span><br><span class="line">brew install libtool</span><br></pre></td></tr></table></figure><p>Also, download the graph if you haven’t already:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p ~/graphs</span><br><span class="line">curl -o ~/graphs/inception.zip \</span><br><span class="line"> https://storage.googleapis.com/download.tensorflow.org/models/inception5h.zip \</span><br><span class="line"> &amp;&amp; unzip ~/graphs/inception.zip -d ~/graphs/inception</span><br></pre></td></tr></table></figure><p><strong><em>Note: Building all at once.</em></strong></p><p>If you just want to get the libraries compiled in a hurry, you can run this<br>from the root of your TensorFlow source folder:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tensorflow/contrib/makefile/build_all_ios.sh</span><br></pre></td></tr></table></figure><p>This process will take around twenty minutes on a modern MacBook Pro.</p><p>When it completes, you will have a library for a single architecture and the<br>benchmark program. Although successfully compiling the benchmark program is a<br>sign of success, the program is not a complete iOS app.</p><p>To see TensorFlow running on iOS, the example Xcode project in<br><a href="../ios_examples">tensorflow/contrib/ios_examples</a> shows how to use the static<br>library in a simple app.</p><p>我使用的 Xcode 版本如下</p><p><img src="http://images2015.cnblogs.com/blog/719115/201701/719115-20170116142514333-1602060782.png" alt="Xcode 版本"></p><p>我的 Mac Pro 设备参数如下，执行脚本 tensorflow/contrib/makefile/build_all_ios.sh 编译 iOS 平台的 tensorflow 库<code>花费了90分钟</code>。</p><p><img src="http://images2015.cnblogs.com/blog/719115/201701/719115-20170116134659802-716920306.png" alt="Mac Pro 设备参数"></p><p><img src="http://images2015.cnblogs.com/blog/719115/201701/719115-20170116135708880-1402615710.png" alt="开始编译时的截图"></p><p><img src="http://images2015.cnblogs.com/blog/719115/201701/719115-20170116140108661-2089552430.png" alt="编译完成时的截图"></p><p>libtensorflow-core.a 所在的路径和支持的 CPU 架构 armv7，armv7s，i386，x86_64，arm64 如下：</p><p><img src="http://images2015.cnblogs.com/blog/719115/201701/719115-20170116181935786-829505024.png" alt></p><p><img src="http://images2015.cnblogs.com/blog/719115/201701/719115-20170116181959052-862893730.png" alt></p><h3 id="3-打开-tensorflow-contrib-ios-examples-下的-Xcode-工程"><a href="#3-打开-tensorflow-contrib-ios-examples-下的-Xcode-工程" class="headerlink" title="3. 打开 tensorflow/contrib/ios_examples 下的 Xcode 工程"></a>3. 打开 tensorflow/contrib/ios_examples 下的 Xcode 工程</h3><h4 id="3-1-tf-ios-makefile-example-xcodeproj"><a href="#3-1-tf-ios-makefile-example-xcodeproj" class="headerlink" title="3.1 tf_ios_makefile_example.xcodeproj"></a>3.1 tf_ios_makefile_example.xcodeproj</h4><p>进入 /tensorflow/tensorflow/contrib/ios_examples/simple 文件夹打开工程 tf_ios_makefile_example.xcodeproj 运行 run</p><p><img src="http://images2015.cnblogs.com/blog/719115/201701/719115-20170116143445255-1618884987.png" alt="tf_ios_makefile_example.xcodeproj 运行出现的错误"></p><p>参考<a href="https://github.com/tensorflow/tensorflow/blob/master/tensorflow/contrib/ios_examples/README.md" target="_blank" rel="noopener">TensorFlow iOS Examples 文档</a> 加载 iOS demo 工程所需要的数据模型，需要操作的命令如下</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p ~/graphs</span><br><span class="line">curl -o ~/graphs/inception5h.zip \</span><br><span class="line"> https://storage.googleapis.com/download.tensorflow.org/models/inception5h.zip \</span><br><span class="line"> &amp;&amp; unzip ~/graphs/inception5h.zip -d ~/graphs/inception5h</span><br><span class="line">cp ~/graphs/inception5h/* tensorflow/contrib/ios_examples/benchmark/data/</span><br><span class="line">cp ~/graphs/inception5h/* tensorflow/contrib/ios_examples/camera/data/</span><br><span class="line">cp ~/graphs/inception5h/* tensorflow/contrib/ios_examples/simple/data/</span><br></pre></td></tr></table></figure><p>具体操作：先进入 tensorflow 的根目录，然后依次执行上面的命令。</p><p><img src="http://images2015.cnblogs.com/blog/719115/201701/719115-20170116150401130-1501991403.png" alt="运行 ios examples 要执行的命令"></p><p>此时，在 Xcode 中 clean（快捷键是 command + shift + k） 下 tf_ios_makefile_example.xcodeproj 工程。运行 run（快捷键是 command + r），success 后 iOS 设备出现的界面和点击按钮 Run Model 后的界面如下图所示：</p><p><img src="http://images2015.cnblogs.com/blog/719115/201701/719115-20170116150927114-514982468.png" width="250" height="445"></p><p><img src="http://images2015.cnblogs.com/blog/719115/201701/719115-20170116152640786-773711415.png" width="250" height="445"></p><h4 id="3-2-camera-example-xcodeproj-可以识别出物体"><a href="#3-2-camera-example-xcodeproj-可以识别出物体" class="headerlink" title="3.2 camera_example.xcodeproj 可以识别出物体"></a>3.2 camera_example.xcodeproj 可以识别出物体</h4><p><img src="http://images2015.cnblogs.com/blog/719115/201701/719115-20170116161341255-1424145846.png" width="250" height="445"></p><h4 id="3-3-benchmark-xcodeproj"><a href="#3-3-benchmark-xcodeproj" class="headerlink" title="3.3 benchmark.xcodeproj"></a>3.3 benchmark.xcodeproj</h4><p><img src="http://images2015.cnblogs.com/blog/719115/201701/719115-20170116161942833-341355774.png" width="250" height="445"></p><p><img src="http://images2015.cnblogs.com/blog/719115/201701/719115-20170116161955317-1079763651.png" width="250" height="445"></p>]]></content>
      
      
      
        <tags>
            
            <tag> iOS </tag>
            
            <tag> 深度学习 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2016年的总结</title>
      <link href="/2016/12/27/the-summary-of-2016-year/"/>
      <url>/2016/12/27/the-summary-of-2016-year/</url>
      
        <content type="html"><![CDATA[<p>2016年，换了一份工作，换了一个城市去工作，能走到今天很感谢以前RCTX的部门老大给自己机会进入音视频这个行业，也非常感谢同事对自己的帮助，特别是一起历经RCTX，YF共事的搭档jia哥。</p><p>前行的路上，是需要人帮助的，也是需要自我努力的。家人对自己的关心，就是自己精神上的支柱。朋友的帮助，是自己能走的更快的加速剂。</p><p>28岁的自己在经历社会的洗炼后，其实活的也不明白，要是真明白了，人生也就结束了。人生路越走越长，就会出现不明白的事，从来不苟同某某某在什么时候活明白了，生命的延续，就会诞生新的事物，除非在某个时刻停止了思考，停止了接收新的事物，此刻的活着与死无异，这就是此刻的明白。</p><p>2016年，经历了2家公司，8月5号从深圳辞职，8月8号到上海入职就加入项目的加急开发，期间没有一个缓冲让疲乏的身躯得到休整，心真的很疲惫。但是人接受的内外情景越多，人只会更强大，所以相信一切都是迎接美好而做的铺垫。</p><p>2017年加强锻炼，有个好的身体才能更好的体验生活。希望家人都健健康康的，希望身边的朋友知足长乐，希望自己的学业能更上一层楼。</p><a id="more"></a><p align="right">二〇一六年十二月二十七日，北京</p>]]></content>
      
      
      
        <tags>
            
            <tag> 工作 </tag>
            
            <tag> 生活 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>换了个博客主题，多说评论无法在博客中显示了</title>
      <link href="/2016/11/01/duo-shuo-is-poor/"/>
      <url>/2016/11/01/duo-shuo-is-poor/</url>
      
        <content type="html"><![CDATA[<p>　　之前用的 hexo 博客主题不太美观，就想着换个，结果换了个博客主题，多说评论不能在博客中显示，评论只能在多说后台上看到。试着把文章和评论导出来再导入到多说后台，各种方法都试了，没搞成功。　　</p><p>　　文章评论不能显示的问题让我心情很不好，大量的评论要想一个不落的跟文章关联起来的可能性不大，内心里对恢复评论不作指望了，能恢复多少算多少吧。</p><p>　　想想这个事，真不该折腾，浪费了时间不说，关键是评论数据不能正常恢复显示很影响我的心情。先把评论数据保存，以后得闲，再整这个恢复评论数据显示的事情。说到以后得闲再做，估计这个事可能就被我遗忘了。</p><a id="more"></a><p align="right">二〇一六年十一月一日，北京</p>]]></content>
      
      
      
        <tags>
            
            <tag> 工作 </tag>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>我竟然恐婚了</title>
      <link href="/2016/10/19/fear-of-marriage/"/>
      <url>/2016/10/19/fear-of-marriage/</url>
      
        <content type="html"><![CDATA[<p>　　在二十岁出头的时候，认为恋爱、结婚是很值得期待、很幸福的一件事。可是到了如今的年龄，很害怕结婚。婚姻不是简简单单两个人的事情，要考虑到婚前两个家庭的关系，结婚时的开销，婚后小孩的培养以及夫妻之间感情生活的问题。分析我现在的这种状态，之所以有害怕结婚的状态是因为我认为未来有太多不可预期的因素，我现阶段能力不足以给予自身强有力的信心。</p><a id="more"></a><p>　　工作年限少，现阶段没什么积蓄，完全凭现阶段的努力给将来一个承诺，我自认为是一个较虚的构想，但未来是值得期待的。未来的不可确定性、现阶段的规划，我相信我能实现人生每个阶段所需要的生活需求。</p><p>　　年龄的增长，现在对事对物的看法趋于平和，毕竟不再是以前未经历社会世态的小年青了。以平和的态度，出世入世的心态，去拥有工作的战场，生活的小资情调。人生究竟是怎样的，活过了才知道。和谁一起走过，经历了才知道。</p><p>　　生活是不确定性的，但每个阶段的生活需要一个指标去指引，不然就会活的没有尽头，以至于看不到希望。</p><p align="right">二〇一六年十月十九日，北京，昌平区</p><p>　　　　</p>]]></content>
      
      
      
        <tags>
            
            <tag> 生活 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>聊一聊互动直播</title>
      <link href="/2016/10/14/Interactive-live-broadcast/"/>
      <url>/2016/10/14/Interactive-live-broadcast/</url>
      
        <content type="html"><![CDATA[<p>　　传统单人直播，形式上比较单调，以主播为主导，聊各种话题。观众与主播之间的沟通，基于即时通信（IM）技术以文字，表情，点赞等来与主播互动。这种互动是有延迟性的，单向的，一问一答的模式。为了增加观众与主播之间的强互动性，有必要引入实时通信（RTC）技术打造连麦互动直播。</p><a id="more"></a><p>　　即时通信中 XMPP 协议是被广泛的协议之一，XMPP 是基于文本标记语言 XML 的协议。打造一套属于自己的即时通信系统可以基于 XMPP 协议从零开发，也可以利用开源方案去实现，比如 openfire。openfire 是基于 XMPP 协议，采用 Java 编程语言开发的实时协作服务器，想快速实现一套 IM 方案，可以在该开源工程上进行改造，节省开发时间和成本。</p><p>　　音视频实时通信领域现广泛采用 Google 的开源方案 WebRTC。WebRTC  分为三部分：音频处理模块，视频处理模块，协议层模块。在使用 WebRTC 时，可以从中拆解出所需要的功能块去实现所需要的功能。</p><p>　　现在 WebRTC 被广泛推广，移动直播也从传统的单人直播进入到了多人连麦互动直播的应用场景。RTC 互动直播必将是直播行业中下一场厮杀的战场。</p><p>　　今天以讲师的角色在公司组织的直播技术培训课堂上讲了直播连麦涉及到的一些概念，方案设计。一节课讲授下来，我发现 RTC 可深挖，可改进的点还是比较多的。</p><p align="right">二〇一六年十月十四日，北京，太阳宫中路12号</p>]]></content>
      
      
      
        <tags>
            
            <tag> 工作 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>如何去爱</title>
      <link href="/2016/10/12/how-to-love/"/>
      <url>/2016/10/12/how-to-love/</url>
      
        <content type="html"><![CDATA[<p>　　    如何去爱？关于这个问题，我想说的是到了一定年纪才会懂得。爱，不是一时情感的寄托，一时的喜好。看着小年轻们，经常上演死去活来的剧情，我内心深处想表达的是这些所谓的爱只是一时的爱慕，只是以后回忆青春年华的一个所谓的美景而已。年纪轻轻，没有太多的经历，自以为是男欢女爱，到底有多少能修到甜蜜与和谐的生活。到了一定年龄，经历过社会的锤炼，对男女之情才会有成熟的看法，对家庭的观念才有全局的认识。</p><p>　　    古有三十而立，四十不惑之说，真的很佩服古人的总结。到三十的年纪，会多角度去看待事物，自身的角度，换位思考的角度。</p><a id="more"></a><p>　　    在我还在读书生涯的时候，有人问我为什么不交女朋友。对于这个问题，当时考虑的是没有自我生存能力，未来充满太多不可预期的因素，怎么能轻易拉人进坑呢。</p><p>　　    研究生毕业后，一直为了体现自己所学的价值，时间花在了学习和工作上。顿首回看，时间过的好快，两年多就这么过去了。脑中留下的印象就是加班，学习，加班，学习的场景。至于如何去哄女孩子，不会啊。连个对象都没有，怎么操作，哈哈。<br>　　<br>　　    随着年龄的增长，更加懂得责任，懂得对未来的规划。遇见对的人，一切都是值得期待的，也是值得努力的。　　    </p><p align="right">二〇一六年十月十二日，夜，北京，太阳宫中路12号</p><p>　　    </p>]]></content>
      
      
      
        <tags>
            
            <tag> 生活 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>论 IT 技术的有效期</title>
      <link href="/2016/10/08/talk-about-IT-technology/"/>
      <url>/2016/10/08/talk-about-IT-technology/</url>
      
        <content type="html"><![CDATA[<p>　　    IT，互联网行业的代名词，代表着科技前沿、市场趋势，无时不刻在改变我们的生活。有那么一群活跃在 IT 行业的人群，美言之软件开发工程师，自嘲之码农，对 IT 技术的革新有着最深刻的体会。旧的技术被取代，程序员若不及时跟上市场的节奏，被淘汰是必然的结局。技术的新旧更替，处在程序开发最上层的程序员的反应最敏感，受到的冲击最大。有点实力的公司，要彰显市场的竞争力，在引领市场获取未来竞争力的驱动下，招募一批研究员、专家、首席科学家去做理论研究。这批做理论的人对 IT 市场的应激反应肯定是延迟的。理论的过时经历的时间更长，理论间的交叉以及相互引入改进，让理论存活的时间变长，也让做理论研究的 IT 人群有长远发展的空间，不至于时刻面临着技术失效的局面。</p><a id="more"></a><p>　　    理论研究与应用开发，对于 IT 从业人员不可或缺。应用开发用到的技术更新换代快，受制于开发平台，倘若开发平台衰退，顶层的应用开发工程分分钟失业，塞班系统的消失，致使当年大批人面临失业转岗，说不定下一个就是 Android，iOS。作为 IT 职场人士，要时刻保持着对市场敏锐的嗅觉。一种新的技术和平台的火爆，下一刻就是人满为患，需求过剩。2015年春节之前 iOS 应用开发人员的需求可以用疯狂来形容，全民创业，国家鼓励大学生创业，O2O 的火热，催生了 iOS 培训市场的不正常的膨胀，大量 iOS 开发人员噌的一下就冒出来了。2015年下半年到2016年上半年，市场上 iOS 开发工程师过剩，iOS 应用开发工程师的薪资待遇下降回归理性，但真正有能耐的人却又是少数，水平差又无基础理论知识支撑的以市场回报率为导向的开发者面临失业和裁员的局面是肯定的。</p><p>　　    做软件开发，数据结构，算法，操作系统，编译原理，开发语言 C / C++ / JAVA，这些必备的技能要非常扎实。要想发展的更好，需要学习和实践软件架构。</p><p>　　    自从进入音视频技术行业，我考虑的更多的是如何从这个已存在多年的技术领域跳跃到一个新的方向去做更有理论深度的行业。我这样考虑的原因是知道技术是有时效性的。时效性意味着回报，意味着市场需求。考虑到自己几年后就三十岁了，如何保持自己的核心竞争力和实现自己高收益的目标，是我现阶段必须慎重决策的事情。</p><p align="right">二〇一六年十月八日</p>]]></content>
      
      
      
        <tags>
            
            <tag> 工作 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>下一个十年</title>
      <link href="/2016/10/07/next-ten-years/"/>
      <url>/2016/10/07/next-ten-years/</url>
      
        <content type="html"><![CDATA[<p>　　 今晚跟高中要好的同学耀（某知名学校硕士）相聚，聊的东西都深入内心。八年未见，我们从十多岁的小青年变成了年近三十岁的大叔，相见仍然是那么熟悉，岁月的痕迹留在了我们脸上和身体健康状态上。每一个行业都有它的亮点，也有它的痛点，不必羡慕，不必感概，因为深处其中时，真的没有那么光鲜，没有那么轻松，没有那么自以为是。我们每个人都在为前途、命运在决斗，遍体鳞伤仍然奋斗不止。</p><a id="more"></a><p>　　 每一代人有每一代人的痛楚，我和高中同学两人都是八零后，此处只谈农村八零后的切身感受，七零后离我太远了，九零后虽近但时代大背景已大不相同。农村的八零后这一代，真的就像是一个品牌的过渡产品，过渡产品意味着什么，试验品。八零后没有赶上九十年代互联网的发起，下海经商的浪潮，但城市与农村的差距却在这些兴起的商业中拉开了距离。</p><p>　　 农村八零后的受教育背景虽然比七零后好一点，但是工作机会，社会竞争力已不可同年而语；相比九零后，八零后受到的教育中规中矩，没有九零后思想活跃。二十一世纪科技发展突飞猛进，八零后接受的信息根本无法与九零后抗衡，思想的活跃受益于社会经济的发展和生活观念的变化。八零后处在一个前有老资格的七零后，后有新奇玩法的九零后的时间轴上，压力是有的，工作的压力，结婚的压力，买房的压力，培养子女的压力等。好在八零后，算是比较务实的一代人，虽然是一代试验品，但好在没有自甘堕落。</p><p>　　 我们无法选择自己所在的时代背景，唯有一颗上进的心，既成全了自己，也慰藉了父母的内心。农村子女的出路，只有读书。现在流行的素质教育，地方特色的高考保护主义，让城市与农村孩子的距离更远了，导致了拼爹，拼妈的潮流。拼出来的是血，还是汗，看自己能否体谅父母了。</p><p>　　 心情比较沉重，写出的东西看着充满低沉的气息。跟同学聊完房贷，装修，生活成本后，我对个人的生活重新审视了一遍，彻底明白开源节流，细水长流的内涵和长远意义。工作两年多以来，只关注自己所学知识转化为物质回报的比例，忽视了物质的管理和利用。</p><p>　　 下一个十年，要面对什么？婚姻，子女，个人业务转型。当为自己考虑时，都觉得还好，为下一代着想时，想想就累，想着是不是要再买一套大一点的房子，学校是不是要上好一点的，长大了是不是要出国留学。</p><p>　　 人为什么而活，人活着到底感受到了什么？</p><p align="right">二〇一六年十月七日，深夜</p>]]></content>
      
      
      
        <tags>
            
            <tag> 工作 </tag>
            
            <tag> 生活 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>三年内个人发展规划</title>
      <link href="/2016/10/06/private-development-in-three-years/"/>
      <url>/2016/10/06/private-development-in-three-years/</url>
      
        <content type="html"><![CDATA[<p>　　互联网发展日新月异，处在该行业就需要紧跟行业发展动态和高新技术理论发展趋势。这不仅关乎个人长远发展，也关乎家庭生活的质量，所以，需要做好长远实际的规划。</p><p>　　如何做好规划，这个问题因人而异。但都离不开学习环节。学习伴随我们的一生，一生的工作，一生的生活。我们工作效率的提升，生活质量的提升，都需要通过不断地学习、接受新的理念来修正过去的观念。</p><p>　　处在互联网这个非线性时变的系统中，我该如何有效精准地预测系统的实际输出呢。经验，理论是建立预测模型的基础，将工作经验，人生阅历，接收到的新理论作为训练数据，进而得出一个切合自身实际的预测输出。获取到一个理论模型之后，接下来的环节就是不断在实践过程中进行修正调参，以更符合期望。</p><a id="more"></a><p>　　我的三年规划，早已经做好了，一切围绕着贴近精神和生活的实际需求。以假设脱离实际，是空谈；以实际摒弃假设，是现实。作为人类群体中的个体，要活的有特色。生活中需要现实，也需要幻想。想要在一片蓝天看见彩虹，需要幻想才能看到诗一般的远方。想要在一片蓝天之下有自己的立足之地，需要现实才能占到属于自己的一份领地。无论如何，良好的心态，是我们拥有灿烂时光的根基。</p><p align="right">二〇一六年十月六日</p>]]></content>
      
      
      
        <tags>
            
            <tag> 工作 </tag>
            
            <tag> 生活 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>对当下的思考</title>
      <link href="/2016/10/02/living-in-the-present/"/>
      <url>/2016/10/02/living-in-the-present/</url>
      
        <content type="html"><![CDATA[<p>　　 当下是未来的基础，未来的憧憬犹如当下的场景，都离不开物质和精神的依赖。由于工作的变动，身心很是疲惫，看事待物都游离着低迷的气息。表面上的光鲜，私底下的痛楚和悲凉，只有在夜深人静的时候，在心底强行抹掉，把当前遇到的事情当作一种对人生的考验，痛而高仰头颅散发出坚而不催的积极向上的气息。</p><p>　　 在北京的日子，自己的忙碌，无暇接听家人的电话。当自己闲下来的时候，觉得自己真的好无力。生活的现实，不得不让人在最应该珍惜一种感情的时候，却以一种强硬的语气和态度应对。父母面容的沧桑，不断苍老的白发袭来，身体没有以前那样灵活，我将这些看在心里，说不出的酸楚。我信奉的一句话是“美好的东西，都是煎熬之后才得到的”，同时欲望的膨胀，也是煎熬的过程中加剧痛苦的催化剂。没有美好的结局，只希望捕捉到的过程中的瞬间和阶段是一段美好的回忆。珍惜平时所见所遇，无需过急赶往远方，柔和的心态才是体验生活的缓冲剂。</p><p>　　 回顾自己的生活，走得太快，提前透支自己，脑中搜寻近几年美好的记忆寥寥无几，大部分是自己为了追逐欲望的场面。近几年活过吗，为谁活过，答案是为了欲望活着。</p><a id="more"></a><p>　　 在北京的日子，很感谢一起走过七年的同学，在自己精神压力最大的时候，约我一起出去游玩，驱除我的压力。在自己需要找人诉说的时候，Jane 学妹能够倾听我的充满情绪化的言语。人生阶段，该散的人散了，还在身边的，那就是自己最应该珍惜的人。人生中有几个知己，自己应该知足了。</p><p>　　 毕业2年多一点，心中最愧疚面对的人，是自己的父母。自己大大小小的事情，他们都为我操心。看着父母的付出，我有着意志前行。一个人，精神是根基，精神若没了，也就废了。</p><p>　　 念博士，这一直是我心中放不下的一件事。以我现在的精力已经根本无力施行。就把它当做一个美好的憧憬，进而不断激励自己去努力、去奋斗。</p><p>　　 什么时候是创业的时机，我认为是在三十五岁左右。</p><p>　　 当下就是认清自己，知长补短，让自己具备审时度势作出决策的能力。</p><p>　　 人生之乐，有一乐是阅读，品着茶，看着书，思绪萦绕，穿越内心和精神是多么的充实。</p><p align="right">二〇一六年十月二日</p>]]></content>
      
      
      
        <tags>
            
            <tag> 生活 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>对OpenGL开发实践的思考</title>
      <link href="/2016/09/29/opengl-practice-description/"/>
      <url>/2016/09/29/opengl-practice-description/</url>
      
        <content type="html"><![CDATA[<p>　　在使用一个工具的时候，首先要搞清楚它的定义［见 wiki ：<a href="https://en.wikipedia.org/wiki/OpenGL" target="_blank" rel="noopener">OpenGL</a>］，其次才是用它来做实践开发。我个人对它的理解是，OpenGL 是一个用于做图形处理的工具库，基于 GPU 硬件资源用来绘制和渲染 2D，3D 图形。要做比较炫的图形渲染，图形变化，选择 OpenGL 来开发可以降低设备对 CPU 资源的消耗。现在流行的 VR 开发，无外乎也是基于 OpenGL 来做的。知道 OpenGL 能干什么了，随之而来的是写个小程序把我们对 OpenGL 的好奇心实践下。</p><a id="more"></a><p>　　怎样写出一个自己能懂的程序？自己写的程序难道自己不懂吗，可能你真的不懂。接触一个新的事物时，我们大多数时候，就是寻找资源去仿造，至于原理和用法为什么是那样，我们其实是一头雾水。人类的本质是具备探索新事物运行原理的，在本质的驱动下，我们或多或少会去研究为什么是那样。研究的深入层度，无形中划分了不同人在该领域的级别。那么如何去探究 OpenGL？网络博客，论坛，QQ群，还是书籍。我的看法是，快速入门就是筛选一些写的精简的博客，然后买几本该方向很权威和专业的书籍细看。</p><p>　　写了这么多，我想表达的是，要有自己学习新东西的方法和策略。</p>]]></content>
      
      
      
        <tags>
            
            <tag> iOS </tag>
            
            <tag> OpenGL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>在上海总部工作一周的感受</title>
      <link href="/2016/09/25/a-week-in-Shanghai-City/"/>
      <url>/2016/09/25/a-week-in-Shanghai-City/</url>
      
        <content type="html"><![CDATA[<p>　　2016年9月19日～2016年9月24日，在上海总部工作了一周，收获颇多。对于我而言，很感谢团队和公司的付出。</p><p>　　人到一定阶段，处在一个和谐进取的团队中，人的感官和认识不再是那种不入流的小民市井看法。</p><p>　　以前，看到某些颁奖典礼上一些人说的大客套话，感谢公司，感谢团队，让人听起来真的好假。为什么觉得好假，在于没有经历过别人的处境。在上海的一周，我确实体会到了一个人在舞台的光鲜，其背后有很多默默付出和支持的小伙伴们，说一些感谢的话，看起来是大话，用心去体验，那是发自内心最真实的声音。现在的社会，是群体，单打独斗不是主流，合群求同化异是趋势。对于知识交流，人际交流，只有放开，才能拥抱更大更广的空间。保持谦逊，保持温和，保持敬畏，保持进取，视野就会大一点，进步就会快一点。</p><a id="more"></a><p>　　溪水会长流，溪水也会干涸，身处的世界有无所不在的变化。害怕变化，就是拒绝机会，结果就是细水断流。保持拥抱变化的接受态度，以变应变来维持细水长流。细水聚集，见泉眼。</p><p align="right">二〇一六年九月二十五日，北京，昌平区</p>]]></content>
      
      
      
        <tags>
            
            <tag> 工作 </tag>
            
            <tag> 生活 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>近一个月在北京的感受</title>
      <link href="/2016/09/06/the-feeling-of-Beijing-the-latest-month/"/>
      <url>/2016/09/06/the-feeling-of-Beijing-the-latest-month/</url>
      
        <content type="html"><![CDATA[<p>　　来北京了近一个月了，感觉不太适应。从生活方面，工作节奏上，都显出很多问题。</p><p>　　生活方面，不适应这边的饮食，没南方吃的东西多，也没南方吃饭的地方多。在北京没有吃好过一顿早餐，也只吃过几顿比较满意的中午餐。我觉得要是这样下去，身体营养肯定跟不上，精力也会出现不足的问题。我准备每天自己做饭，早餐自己做，如果去公司上班，就带午饭过去。要是在家办公，就一天三顿都自己做。做饭，有助于培养耐心，细心，有助于做事流程上的统筹规划，最重要的是能吃上比较满意的饭菜。来北京近一个月了，对于我住的地方我都不熟悉，不知道附近有哪些大型超市，大型商场。每天都宅在家里办公，感觉整个人的状态都不打对劲。现在正当年，身体恢复都很快，但是人要活动，要呼吸新的空气，才能持久保持正常以及健康的状态。</p><a id="more"></a><p>　　工作方面，不适应远程办公的节奏。以前，都是早上去公司，晚上从公司离开。现在，突然不需要去公司办公，找不到上班工作的感觉了，我的工作时间安排出现了问题。自由办公，关键在于时间协调，每天工作任务的安排，这所有的东西都离不开时间的合理安排。在这种工作环境下，我的拖延症表现的很明显，时间的利用率也不高。反思了这段时间的工作，我首先要解决的是我的执行力问题，即解决拖延症，要在有效的时间里完成规定的计划和任务。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 工作 </tag>
            
            <tag> 生活 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>对远程办公和时间统筹的思考</title>
      <link href="/2016/09/03/think-of-telecommuting-and-time-co-ordination/"/>
      <url>/2016/09/03/think-of-telecommuting-and-time-co-ordination/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
        <tags>
            
            <tag> 工作 </tag>
            
            <tag> 生活 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>生命的精神支柱</title>
      <link href="/2016/08/31/spiritual-handholds-on-life/"/>
      <url>/2016/08/31/spiritual-handholds-on-life/</url>
      
        <content type="html"><![CDATA[<p>　　    人太拼，总有累的时候，当疲惫驱入身心，人很容易垮掉。古语有云“休养生息”，疲惫的身躯需要休整，劳累的精神需要调节。在现在这个快节奏的社会，停下来去看看身边的风景是多么的奢侈。一味地向前，时间匆匆而过，记忆中却了无良辰美景。</p><p>　　    累了，想放下，仔细一想身上肩负的担子，家人的期望，只能继续行走在疲惫的人生路上。逼近而立之年，心态不复以前，岁月不知不觉让人明白每个年龄段该有的心智，该有的责任感，该有的生活观，该有的工作价值。</p><a id="more"></a><p>　　    每当自己很疲惫的时候，家人是自己最强大的精神信念，这种信念让我有勇气有决心面对眼前的疲惫不堪。</p><p>　　    人生的意义是，能有充裕的时间和家人一起看看风景。</p><p align="right">二〇一六年八月三十一日，北京，昌平区</p>]]></content>
      
      
      
        <tags>
            
            <tag> 工作 </tag>
            
            <tag> 生活 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>北京见闻</title>
      <link href="/2016/08/25/see-in-Beijing/"/>
      <url>/2016/08/25/see-in-Beijing/</url>
      
        <content type="html"><![CDATA[<p>　　    在上海待了一周，就从上海乘动车来北京了。我想起了汪峰的一首歌《北京北京》</p><a id="more"></a><pre><code>歌曲名:北京北京演唱:汪峰当我走在这里的每一条街道我的心似乎从来都不能平静就让花朵妒忌红名和电气致意我似乎听到了他这不慢的心跳我在这里欢笑我在这里哭泣我在这里活着也在这死去我在这里祈祷 我在这里迷惘我在这里寻找 在这里寻求北京 北京咖啡管与广场又散着天气就象夜空的哪月亮的距离人们在挣扎中相互告慰和拥抱寻找着 追著着 夜夜时的睡梦我在这欢笑 我们在这哭泣我在这活着也在这死去我在这祈祷 我在这迷惘我在这寻找 在这追求如果有一天我不得不离去我希望人们把我埋葬在这里在这忘了感觉到我在存在在这有太多有我眷恋的东西我在这欢笑 我在这哭泣我在这里活着也在这死去我在这里祈祷 我在这里迷惘我在这里寻找 也在这死去</code></pre><p>　　    我的认知是，不管在哪里都有竞争，都有失落，都有灿烂。山不转路转，路不转人转，人不转心转。心念一转，自在逍遥。</p><p>　　    8月13号到的北京，现在已经有2周了，我对北京没什么感觉，就是一个工作的地方而已。看重会变成负担，平常心能体验到生活中的美。工作是我们不碌碌无为的物质基础，生活是我们平常心感受美的精神基础。我对北京的感受就这么多，谈不上喜欢，也谈不上不喜欢，平平淡淡的感觉。<br>　　<br><code>2016年8月 写于北京 亲笔</code></p><p align="right">二〇一六年八月，北京</p>]]></content>
      
      
      
        <tags>
            
            <tag> 工作 </tag>
            
            <tag> 生活 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>上海见闻</title>
      <link href="/2016/08/24/see-in-Shanghai/"/>
      <url>/2016/08/24/see-in-Shanghai/</url>
      
        <content type="html"><![CDATA[<p>　　    从深圳乘动车去上海的旅程中，我是兴奋的，可以增加新的阅历，丰富自己思考人生的素材。带着一颗充满期待的心，经历一夜的行程到了上海。</p><p>　　 第一次到上海，上海并不是电视宣传和网络上宣称的那样华丽，我的第一感受是一个有着沧桑和陈旧感的都市。或许这就是她的魅力，释放着她的历史与过去。</p><p>　　 我的落脚点是张江高科（张江软件园），到的那天是周六，在出租车上看张江软件园，看不到人影，这和深圳高新园一样，这里只是上班的地点而已，周一到周五上完班，周末软件园显得那么的安静，静的有一丝可怕和空寂。在张江全季酒店办了一周的入住手续，一路过来有点累，到上海的当天休息了半天。第一次来上海，可不能浪费了时间，总得出去转转呀，见识下所谓的大上海。</p><p>　　 当一种东西，可以说是憧憬到来时，其实并没有想象中的完美和无暇，更多的是得到一种残缺，十全十美只是一种美好的期待，只是一种对人生充满美好信念的驱动力。正因为我们得到的是不完美的，有瑕疵的，我们才继续有动力去追寻我们心中那趋于完美，趋于内心期望值的远方。</p><a id="more"></a><p>　　 上海，一个活在口碑相传的都市，真正去感受一番，终归只会得到一句“不过如此”。确实是，不过如此而已。</p><p>　　 不论一个城市怎样，都寄载了不同人的梦想，不同人的期望。任何东西只存在单面是不可能的，双面或多面才丰富了整个世界和人生观。在上海，和硕士同学、师弟们游览了下黄浦江附近的景点，夜色下的黄浦江周边都被笼罩在霓虹灯下，更凸显了都市的浮华和不实。虽然不喜欢这种浮华的场景，但是不能因为不喜欢而排斥。</p><p>　　 和同学、师弟们相聚，我感叹时间易逝，青春不在，感叹在学校的学生过早期望步入繁杂的社会而不安抚躁动的心去感受在学校学习的生涯。在这越来越快节奏的社会，学生们充满着躁动，急于步入看似美好的凡尘。学校培养机制的问题，学生为了将来生存的问题，一些问题交错在一起，社会源源不断的新生力量都处在一场莫名的躁动和追逐的历史河流中。</p><p>　　 我试图摆脱第一份工作给我带来的不利影响，但现在仍没有彻底平复。我希望自己能心态自然，平和的去接受和觉悟，我发现我很难做到。活在一场人生追逐的决斗场中，结局无外乎胜利了继续战斗，失败了就出局。</p><p>　　 上海的小伙伴，让我感受了一种有柔有刚的氛围，比较喜欢。期望不要过高，一起走过，一起奋进，几年后看现在至少是充实的，有收获的。每个人都有自己的角色，我找到了我扮演的角色，我喜欢做技术，喜欢接触一些新的自己不懂的东西然后掌握它，这就是工作。生活中以一种坦然开放的心态去融入去表达。</p><p>　　 硕士毕业2年2个月了，我希望自己一直保持一颗学习的心态，以谦卑的心态去汲取别人身上的优点，学习是伴随我们一生的灵魂工程。学会爱，学会包容，学会理解，学会提升，人生才会过的如灿烂阳光，绚烂星夜。</p><p align="right">二〇一六年八月，北京</p>　 　　 　　 　　 　　 　　　　    　　    　　    　　    　　    　　    ]]></content>
      
      
      
        <tags>
            
            <tag> 工作 </tag>
            
            <tag> 生活 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>启程去上海</title>
      <link href="/2016/08/05/go-to-Shanghai/"/>
      <url>/2016/08/05/go-to-Shanghai/</url>
      
        <content type="html"><![CDATA[<p>　　    今天办完了离职手续。先去上海待一段时间。对于上海之行，我还是很期待的。 </p><p>　　    路线安排是深圳北站到上海虹桥站。我在广州待过近3个月，深圳待过2年多，北京还是2011年3月去过一次，上海我没有去过。不到北上广深看一圈，不足以了解现今的互联网圈。对于此次行程，我有点兴奋。世界那么大，我想出去看看。</p><a id="more"></a><p>　　    真正到了那里我会有什么样的感受，见后续博文。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 工作 </tag>
            
            <tag> 生活 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>关于雷霄骅离世的思考</title>
      <link href="/2016/08/04/lei-xiao-hua-passed-away/"/>
      <url>/2016/08/04/lei-xiao-hua-passed-away/</url>
      
        <content type="html"><![CDATA[<p>　　8月3号晚上6点多，坐在我旁边的同事说“网上有新闻说雷霄骅过世了”，听到这个消息，我的看法是这肯定是假消息，雷博士被人黑了。后来，各大门户网站包括凤凰网，人民日报官微都有报道雷神过世了。当确认这个消息时，我感觉到身边缺少了点东西，就是那种亲近事物忽然不在的痛楚。不想说雷神是人才，这个是事实，不用我多说。说天妒英才，我认为没有表达出一种更真诚更真切的惋惜。</p><a id="more"></a><p>　　雷神在流媒体行业做出的贡献很大，因为有很多做音视频技术的人员都有拜读过他写过的文章，博客中的文章在流媒体技术方面有广度和深度，条理清晰，易懂。作为音视频行业中的一员，曾经我从他的文章中获益匪浅。</p><p>　　网上的报道和音视频技术qq群中，都说到雷博是一个认真负责，谦逊，好学的人，这些毫无争议。昨天，也就是8月3号，从晚上6点多一直到凌晨1点，雷博创建的音视频技术群，以及其它音视频技术开发群都表达了对这位年仅25岁即将博三的大神的不幸离世的可惜。谈论的焦点有以下几点：</p><p>　　第一，募捐。对于募捐，有跟雷博父母沟通过的人说雷博父母不需要捐助。</p><p>　　第二，创立基金。对于基金，有人表示成立有难度，有人同意。根据网上的消息以及跟雷博父母交流过人的说法，创立基金帮助一些学生是雷博父母的意愿，雷博父母将孩子的存款和学校的赔偿都用于这个基金。对于父母的这种做法，我非常敬佩。斯坦福大学的创建，不也是内心强大的父母为了孩子创立的吗。</p><p>　　第三，完成雷博未完成的项目。雷博创建的音视频技术qq群中不乏音视频技术大牛，提议共同维护和开发雷博未完成的项目。对于这种做法，在项目方许可情形下，我是认同的，可以聊以慰藉离开的雷博，也可以让雷博的导师以及学校通过这件事能够深刻认识到学校研究生培养中的问题。</p><p>　　第四，继续维护雷博创建的音视频技术论坛。雷博的音视频技术论坛，上线没多久，需要后期完善，我相信在广大音视频技术人才和IT开发人员的努力下，能够将雷博的精神延续下去。这种精神，是一种无偿分享技术心得的奉献。</p><p>　　第五，工作和身体的权衡。身体是革命的本钱，但是很多时候我们身不由己，不得不为了工作，学习，生活去做损害自身身体健康的事情。有人说，遇到这种事博士不念了、换导师，经历过研究生学习生涯的人都会觉得这种说法是不靠谱的。说出这种看法的人，有没有身临其境，有没有经历过真正的高压科研，有没有从事过为老板卖命做项目的事。如果没有，我只想说你是幸运的，但同时你的看法是粗浅的。</p><p>　　网上消息说中国传媒大学说雷博是酗酒死亡，还说雷博家属没有做尸检无法确认死因。对于国内这种遇事就撇清责任的做法，只有畜生可苟同。出事前在实验室工作，而且过世在实验室所在楼宇，学校有脸说没有责任。也没见雷博的导师发声，遇事躲闪，恐怕是深谙厚黑之学、中庸之道，却有违师德、良知。</p><p>　　不谈论国家体制，不谈论高校体制，不谈论高校研究生培养方式，不谈论道德良知，不谈论法制，我真不知道该谈什么了，我不知道在我们这个国有什么是不能干的了。当博导硕导变身为老板，当学生变为被奴役被压榨的打工仔，我们所谓的师生之礼仪，传道解惑是不是都被现实的金钱和权欲吞噬了。</p><p align="right">二〇一六年八月四日，周四，深圳，南山区科技园</p>]]></content>
      
      
      
        <tags>
            
            <tag> 工作 </tag>
            
            <tag> 生活 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>离开深圳去北京</title>
      <link href="/2016/08/03/leave-Shenzhen-for-Beijing/"/>
      <url>/2016/08/03/leave-Shenzhen-for-Beijing/</url>
      
        <content type="html"><![CDATA[<p>　　工作近3年，在深圳这个地方也待了2年半了。从毕业前对深圳的憧憬，到如今的匆匆离开，最终会被尘封到记忆深处。</p><a id="more"></a><p>　　在深圳的这几年，担任过iOS应用开发工程师，播放器开发工程师，编解码工程师，个人的职业经历比大部分 IT 职场人士丰富些。经历过飘在眼前的大额金钱，源于自己初入社会被人带偏离，其中也有自己个人的原因，浮华之物本能入进口袋却失之交臂，但是看清了社会的一角；经历过给很多公司接入所在公司业务的技术支持，看到了形形色色、层次不齐的 IT 职场人士，自己的提升非常之快；经历过公司被上市公司收购之后的资产重组和裁员；经历过一个人干一个平台底层开发，从无到有，到线上版本迭代多次。在深圳的2年多时间里，自己收获了什么？</p><p>　　第一，个人的价值得到了提升。衡量自己价值最直接的标准是市场的薪资待遇。</p><p>　　第二，个人的身体状况欠佳。这对于it人士来说，精力充沛和身体状况佳才能走的更高。</p><p>　　第三，经历的事情太多，发现自己对人不那么热情了，受第一份工作的影响很大。</p><p>　　人生所到之处，有爱、有恨、有悔、有悟。如何让自己活的更有价值，更有意义才是自己存于世的根本。</p><p align="right">二〇一六年八月三日，深圳，南山区科技园</p>]]></content>
      
      
      
        <tags>
            
            <tag> 工作 </tag>
            
            <tag> 生活 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>利用openh264将iOS摄像头实时视频流编码为h264文件</title>
      <link href="/2016/07/11/use-openh264-encode-iOS-camera-video-to-h264/"/>
      <url>/2016/07/11/use-openh264-encode-iOS-camera-video-to-h264/</url>
      
        <content type="html"><![CDATA[<a id="more"></a>]]></content>
      
      
      
        <tags>
            
            <tag> iOS </tag>
            
            <tag> 音视频处理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>利用fdk-aac将iOS麦克风实时音频流编码为aac文件</title>
      <link href="/2016/07/08/use-fdk-aac-encode-iOS-mic-pcm-to-aac/"/>
      <url>/2016/07/08/use-fdk-aac-encode-iOS-mic-pcm-to-aac/</url>
      
        <content type="html"><![CDATA[<p>　　    近几天终于有点空闲时间写写东西了，将之前项目中自己做的东西更新上来，写写自己的心得感想。</p><p>　　iOS系统上的音频硬编码器，可实现将pcm音频数据编码为aac格式的数据。但是，对于低码率下的音频编码，就是它的软肋了。通过函数扫描iOS各系统上音频硬编码支持的情况发现，aac-lc编码都是支持的，苹果的官方文档也说的很清楚。对于aac-he-v2编码，iOS现在所有的系统都不支持，aac-he编码需要iOS9.0以上系统才支持音频硬编码。</p><a id="more"></a><p>　　做直播的时候，利用iOS的音频硬编码器可以将码率降到80Kb/s，用128Kb/s虽然可以让音质更好，但有点浪费带宽，当主播的网络状况不好时，这就成了一个影响观众流畅观看的一个负面因子，一般选用96Kb/s的码率，这个码率在现今国内网络条件下，还是显得有那么点大。为降低码率同时保证音频音质的情形下，选择合适的编码器才是在有限带宽下优化直播体验的最好武器。</p><p>　　音频编码器有很多，比如常见的有faac，vo_aacenc，fdk-aac，以及ffmpeg自带的音频编码器。ffmpeg3.0及之后的版本都已经移除了对faac，vo_aacenc的支持，对于ffmpeg3.0之后版本音频编码器的支持情况可以看看它的官网说明，从官网上看，ffmpeg组织建议使用他们的原生native音频编码器，可见，ffmpeg自带的编码器还是不错的。但是，为了一个音频编码功能引入一个这么强壮且庞大的库，有点不划算，虽然可裁剪ffmpeg，也可以将fdk-aac编译进ffmpeg中，但是如果应用中引入了基于ffmpeg开发的播放器的时候，ffmpeg库冲突的情形可能会出现。再说，有比ffmpeg原生音频编码器更好的fdk-aac音频编码器存在，就不需要考虑ffmpeg了，即便用ffmpeg做编码很方便。因为我们是用ffmpeg时间长了，就习惯依赖于ffmpeg了。</p><p>　　fdk-aac音频编码器用起来也很简单，跟单独用faac差不多，但比faac编码效果好。使用fdk-aac实现了aac-lc，aac-he，aac-he-v2 采样率为44.1KHz，通道数为2（立体声），码率为32Kb/s的aac编码。</p>]]></content>
      
      
      
        <tags>
            
            <tag> iOS </tag>
            
            <tag> 音视频处理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>对理论学习与应用的一些思考</title>
      <link href="/2016/07/07/talk-about-theory-study-and-application/"/>
      <url>/2016/07/07/talk-about-theory-study-and-application/</url>
      
        <content type="html"><![CDATA[<p>待续。。。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 工作 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>硕士毕业2年对现阶段的思考</title>
      <link href="/2016/07/06/feeling-of-TwoYear-after-master-graduation/"/>
      <url>/2016/07/06/feeling-of-TwoYear-after-master-graduation/</url>
      
        <content type="html"><![CDATA[<p>　　目前，鉴于对自己的人生规划，做出了离开深圳去北京发展的决定。为什么去北京？第一是工作赚钱，第二是找个学校读个博士，第三是有了一定物质基础和条件要走出国门。</p><a id="more"></a><p>　　首先谈第一点，工作赚钱。毕业前我就在深圳正式工作了，到目前已经2年3个月时间了，做过iOS应用开发工程师，播放器开发工程师，以及如今的编解码工程师。其实，2014年做iOS应用开发工程师，要是坚持做到现在待遇也不会差，但是，我认为一个硕士出身，还是做理论的，要我天天画一些界面简直是羞耻，没前途，那就换方向。对于iOS开发这块，2011年3月，就去北京中关村实习过，本科毕业后，硕士阶段也做过iOS应用开发，内心底是抵触的，是拒绝的。读博士，才是我的真爱。后来发生了很多事情，放下读博的念头到深圳找了份iOS开发的工作，这家公司最后被**互动用6个亿收购了，该公司的1个月的收入顶1个一般互联网公司1年的收入，我在里面做什么，时间过去这么久了不想再多说了。人就是得不到的就会憧憬，说句不好听的话，就是犯贱。但是，骨子里的犯贱从另一方面来讲，这人有激情。2015年年后，找了一家在音视频行业有口碑的工作，正式进入流媒体行业工作，这也是我非常喜欢的一个工作方向，该公司还不错，做过2008年北京奥运会手机端直播，2015年给中国好声音提供终端视频直播平台，还有一些其它的比如什么青运会视频直播什么的。在该公司，是我个人学习和发展最快的时间段，做自己喜欢的事，是一种享受。后来，公司被收购重组，我决定离开了，拿了赔偿走人了。内心深处，挺感谢给我一个机会，一个平台进入流媒体的部门boss的。工作在换，薪资在涨，人心也越来越膨胀，这也符合我的个性，但这也是一大性格弊端。如今的我，在那个人人都欠它一个会员的公司工作着，感觉到了工作方向上遇到了瓶颈，突然间我就有种“你什么都会，其实你什么都不会”的迷失感，以前读博的念头又重新燃起，换工作加薪的想法也随之而来。更多时候，享受这种很变态的痛苦中有快感的感觉。</p><p>　　其次，对于读博这件事，其实我本身有兴趣的，也有欲望的。但是，我深入剖析自己后，读博也只是自己赚钱的一个支撑条件。物质基础决定精神世界，精神世界没有物质口粮支撑说什么都会沦为瞎扯淡。拿个博士学历，我敢肯定的说我自己就是为了满足自己的那么点欲望，其实对我赚钱能有多大的帮助作用，其实没什么影响。</p><p>　　再次，至于出国这个事，有多少人都是很憧憬的，因为看到了国内的种种乱象。对于搞研究，我是特别喜欢的，但是要我没钱去干自己喜欢的事，我是不情愿的。活都活不起了，喜欢的事能持续多久呢。</p><p>　　现在是2016年7月，硕士毕业2年了，2年中发生了很多事情，经历了职场的万象，被人当枪使，经历过裁员风波，经历过家人生病自己无能为力的痛楚。如今，虽然待遇有每月＊万人民币，但是我觉得很少，因为我觉得自身的价值还没有发挥出来，可提升的地方很多，也没有达到我的预期值。我给自己定的规划是工作3年内月薪要超过＊万人民币。我觉得这不是一个口号，是一个可行的，可实现的目标。当一个人的追求，就是为了钱的时候，某种程度上会限制自身更快的发展，这也是一种悲哀。</p><p>　　前2天向公司上级提了离职的事情，谈论了自己最真实的最直接的想法。</p><p>　　直播项目做了半年多了，自身没什么提升，每天就是各种需求导致各种改代码，时间就这么过去了，可惜。</p><p>　　接下去会做视频算法方面，什么编码解码器用现成的玩没什么意思，改进或者搞些新的策略，我喜欢图像这快，嗯，这就是兴趣。为什么不选择音频算法方向，毕竟这个太小众了，到头来在合理的时间内拿不到期望的结果无疑是一种精力的浪费。选择做什么，是关键。</p><p>　　明年，也要考虑找个合适的人谈谈人生。</p><p>　　明年，我就29岁了。哈哈，时间过的好快，结婚是个什么玩意，婚姻又是个什么玩意。一年后再发表感受。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 工作 </tag>
            
            <tag> 生活 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>移动端直播应用的开发流程</title>
      <link href="/2016/05/09/live-broadcast-development-process/"/>
      <url>/2016/05/09/live-broadcast-development-process/</url>
      
        <content type="html"><![CDATA[<h2 id="Part-1-推流端"><a href="#Part-1-推流端" class="headerlink" title="Part 1. 推流端"></a>Part 1. 推流端</h2><p>推流，就是将采集到的音频，视频数据通过流媒体协议发送到流媒体服务器。</p><h3 id="一、选择流媒体协议"><a href="#一、选择流媒体协议" class="headerlink" title="一、选择流媒体协议"></a>一、选择流媒体协议</h3><p>现在直播应用，采用 RTMP 协议居多，也有部分使用 HLS 协议。</p><p>采用RTMP协议，就要看下它与流媒体服务器交互的过程，RTMP协议的默认端口是1935，采用 TCP 协议。并且需要了解 FLV 的封装格式。</p><p>采用 HLS 协议，因为涉及到切片，延时会比较大，需要了解 TS 流。</p><a id="more"></a><h3 id="二、采集音视频数据"><a href="#二、采集音视频数据" class="headerlink" title="二、采集音视频数据"></a>二、采集音视频数据</h3><p>做直播，数据的来源不可缺少，就是采集摄像头，麦克风的数据。</p><p>iOS 平台上采集音视频数据，需要使用 AVFoundation.Framework 框架，从 captureSession 会话的回调中获取音频，视频数据。</p><h3 id="三、硬编码，软编码音视频数据"><a href="#三、硬编码，软编码音视频数据" class="headerlink" title="三、硬编码，软编码音视频数据"></a>三、硬编码，软编码音视频数据</h3><p>软编码就是利用 CPU 资源来压缩音视频数据，硬编码与之相反。</p><p>软编码的话，现在广泛采用 FFmpeg 库结合编码库来实现，FFmpeg+X624 来编码视频数据 YUV/RGB 输出 H264 数据，<br>FFmpeg+fdk_aac 来编码音频数据 PCM 输出 AAC 数据。</p><h3 id="四、根据所选流媒体协议封包音视频数据"><a href="#四、根据所选流媒体协议封包音视频数据" class="headerlink" title="四、根据所选流媒体协议封包音视频数据"></a>四、根据所选流媒体协议封包音视频数据</h3><p>将音频，视频打包成 packet。</p><h3 id="五、与服务器交互发送封包数据"><a href="#五、与服务器交互发送封包数据" class="headerlink" title="五、与服务器交互发送封包数据"></a>五、与服务器交互发送封包数据</h3><p>根据所选流媒体协议，发送相应指令连接服务器，连接服务器成功后，就可以发送 packet 数据了。</p><h2 id="Part-2-拉流端"><a href="#Part-2-拉流端" class="headerlink" title="Part 2. 拉流端"></a>Part 2. 拉流端</h2><p>拉流，就是从流媒体服务器获取音频，视频数据。</p><h3 id="一、解析协议"><a href="#一、解析协议" class="headerlink" title="一、解析协议"></a>一、解析协议</h3><p>播放器端根据URL解析所用的流媒体协议（RTMP，HLS）。</p><h3 id="二、解封装"><a href="#二、解封装" class="headerlink" title="二、解封装"></a>二、解封装</h3><p>解封装，就是 demux 的过程，从容器格式（FLV，TS）中，分离出音视频数据。</p><h3 id="三、解码"><a href="#三、解码" class="headerlink" title="三、解码"></a>三、解码</h3><p>解码，就是把获取到的数据解压缩，恢复成原始数据。解码就是将 H264 变成 YUV，AAC 变成 PCM。</p><p>解码可以使用软解码，硬解码。</p><p>软解码就是利用 CPU 资源去解压缩数据，采用的方式是FFmpeg解码。</p><p>硬解码，对于 iOS 平台来说，可以使用 VideoToolbox.Framework（该框架只能在iOS 8.0及以上系统使用）<br>硬解码视频数据。Android 平台上，可以使用 MediaCodec 来硬解码视频数据。</p><h3 id="四、渲染数据"><a href="#四、渲染数据" class="headerlink" title="四、渲染数据"></a>四、渲染数据</h3><p>采用 OpenGL 渲染 YUV 数据，呈现视频画面。将PCM送入设备的硬件资源播放，产生声音。</p><p>iOS 播放流式音频，使用 Audio Queue 的方式，即，利用 AudioToolbox.Framework 框架。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 音视频处理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>重温《Objective-C高级编程iOS与OSX多线程和内存管理》一书</title>
      <link href="/2016/03/24/review-multithreading-and-memory-management-for-ios-and-osx/"/>
      <url>/2016/03/24/review-multithreading-and-memory-management-for-ios-and-osx/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
        <tags>
            
            <tag> iOS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>在iOS上硬编码推流－编码aac（六）</title>
      <link href="/2016/03/23/hw-encode-and-transfer-in-ios-platform-encode-aac-part6/"/>
      <url>/2016/03/23/hw-encode-and-transfer-in-ios-platform-encode-aac-part6/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
        <tags>
            
            <tag> iOS </tag>
            
            <tag> 音视频处理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>在iOS上硬编码推流－麦克风数据采集（五）</title>
      <link href="/2016/03/22/hw-encode-and-transfer-in-ios-platform-mic-part5/"/>
      <url>/2016/03/22/hw-encode-and-transfer-in-ios-platform-mic-part5/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
        <tags>
            
            <tag> iOS </tag>
            
            <tag> 音视频处理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>在iOS上硬编码推流－硬编码h264（四）</title>
      <link href="/2016/03/20/hw-encode-and-transfer-in-ios-platform-videotoolbox-encode-h264-part4/"/>
      <url>/2016/03/20/hw-encode-and-transfer-in-ios-platform-videotoolbox-encode-h264-part4/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
        <tags>
            
            <tag> iOS </tag>
            
            <tag> 音视频处理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>在iOS上硬编码推流－实时图像滤镜（三）</title>
      <link href="/2016/03/19/hw-encode-and-transfer-in-ios-platform-real-time-image-filter-part3/"/>
      <url>/2016/03/19/hw-encode-and-transfer-in-ios-platform-real-time-image-filter-part3/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
        <tags>
            
            <tag> iOS </tag>
            
            <tag> 音视频处理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>在iOS上硬编码推流－图像融合（二）</title>
      <link href="/2016/03/18/hw-encode-and-transfer-in-ios-platform-image-merging-part2/"/>
      <url>/2016/03/18/hw-encode-and-transfer-in-ios-platform-image-merging-part2/</url>
      
        <content type="html"><![CDATA[<p>采用UIGraphics将两幅图绘制到同一个画布上输出，达到图像融合的简单效果。</p><a id="more"></a><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">    <span class="built_in">UIImage</span> *supermanImage = [<span class="built_in">UIImage</span> imageNamed:<span class="string">@"superman.png"</span>];</span><br><span class="line">    <span class="built_in">UIImage</span> *moneyImage = [<span class="built_in">UIImage</span> imageNamed:<span class="string">@"money.png"</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">CGSize</span> supermanSize = [supermanImage size];</span><br><span class="line">    <span class="built_in">CGSize</span> moneySize = [moneyImage size];</span><br><span class="line">    </span><br><span class="line"><span class="comment">//    NSLog(@"s : %f,%f \n m : %f,%f", supermanSize.width, supermanSize.height, moneySize.width, moneySize.height);</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">UIGraphicsBeginImageContext</span>(supermanSize);</span><br><span class="line">    </span><br><span class="line">    [supermanImage drawInRect:<span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, supermanSize.width, supermanSize.height)];</span><br><span class="line">    [moneyImage drawInRect:<span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, moneySize.width, moneySize.height)];</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">UIImage</span> *mergeImage = <span class="built_in">UIGraphicsGetImageFromCurrentImageContext</span>();</span><br><span class="line">    <span class="built_in">UIGraphicsEndImageContext</span>();</span><br><span class="line">    </span><br><span class="line">    mergeImageView = [[<span class="built_in">UIImageView</span> alloc] init];</span><br><span class="line">    mergeImageView.image = mergeImage;</span><br><span class="line">    mergeImageView.frame = <span class="keyword">self</span>.view.bounds;</span><br><span class="line">    [<span class="keyword">self</span>.view addSubview:mergeImageView];</span><br></pre></td></tr></table></figure><p>demo地址：<a href="https://github.com/depthlove/STMImageMerging" target="_blank" rel="noopener">https://github.com/depthlove/STMImageMerging</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> iOS </tag>
            
            <tag> 音视频处理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>在iOS上硬编码推流－摄像头数据采集（一）</title>
      <link href="/2016/03/17/hw-encode-and-transfer-in-ios-platform-camera-part1/"/>
      <url>/2016/03/17/hw-encode-and-transfer-in-ios-platform-camera-part1/</url>
      
        <content type="html"><![CDATA[<p>该文的内容在我之前的文章中已经实现过，但是为了结构清晰起见，本文将相机控制和采集视频数据功能封装为单独的库。</p><p>iOS上使用AVFoundation.framework框架来调用系统相机并获取视频数据。视频数据可以根据设定的参数，可采集到RGB或YUV数据，一般使用的是GBRA32，420v，420f，下面演示相机的调用和视频数据的获取。</p><p>a)引入框架的头文件<code>#import &lt;AVFoundation/AVFoundation.h&gt;</code></p><p>b)调用的类遵守协议<code>AVCaptureVideoDataOutputSampleBufferDelegate</code></p><a id="more"></a><p>c)声明变量</p><pre><code>AVCaptureSession            *captureSession;AVCaptureDevice             *captureDevice;AVCaptureDeviceInput        *captureDeviceInput;AVCaptureVideoDataOutput    *captureVdieoDataOutput;</code></pre><p>d)实现</p><p>e)demo地址 <a href="https://github.com/depthlove/STMCamera" target="_blank" rel="noopener">https://github.com/depthlove/STMCamera</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> iOS </tag>
            
            <tag> 音视频处理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>个人在音视频开发方面的经历分享启动啦</title>
      <link href="/2016/03/16/share-my-project-experience-in-audio-and-video-development/"/>
      <url>/2016/03/16/share-my-project-experience-in-audio-and-video-development/</url>
      
        <content type="html"><![CDATA[<p>本人小硕一枚，科班出身，毕业后在公司做过iOS应用开发工程师，搞过iOS项目移植到flash、unity3d平台的开发，在流媒体行业内实力不错的公司做过播放器开发工程师，现在在一家互联网公司做音视频编解码工程师。</p><p>以前，就想着把自己实战经历过的项目经验总结并分享下，个人觉得在分享的过程中，会加深对知识点和技术的认识，同时也能帮助下一些人。值得开心的是，去年4月份左右，具体时间记不得请了，北京的一家做游戏应用内支付的公司的iOS工程师看到我的博客园博客后，联系我寻求iOS项目移植到flash平台的帮助。经过半个月时间与我沟通，项目移植成功上线了。在小型互联网公司，工程师可谓是孤军奋战。分享自己所学和经历是一件很兴奋，很开心的事。</p><a id="more"></a><p>分享安排：先分享iOS平台上的音视频开发<br>        再分享Android平台上的音视频开发<br>        最后分享PC平台上的音视频开发</p>]]></content>
      
      
      
        <tags>
            
            <tag> 工作 </tag>
            
            <tag> 音视频处理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iOS平台上编码之CMTime，CMTimeMake，CMTimeMakeWithSeconds的作用</title>
      <link href="/2016/03/15/CMTime-CMTimeMake-CMTimeMakeWithSeconds-in-iOS-encode/"/>
      <url>/2016/03/15/CMTime-CMTimeMake-CMTimeMakeWithSeconds-in-iOS-encode/</url>
      
        <content type="html"><![CDATA[<p>在iOS平台上使用iOS8及以上系统的VideoToolbox进行硬编码，会涉及到CMTime，CMTimeMake，CMTimeMakeWithSeconds的使用。下面说下这几个结构体的作用。</p><p>CoreMedia.framework的CMTime.h中CMTime，CMTimeMake，CMTimeMakeWithSeconds的定义如下：</p><a id="more"></a><p>（备注：关于CMTime可翻看下苹果官网api文档<br><a href="http://developer.apple.com/library/mac/#documentation/CoreMedia/Reference/CMTime/Reference/reference.html" target="_blank" rel="noopener">http://developer.apple.com/library/mac/#documentation/CoreMedia/Reference/CMTime/Reference/reference.html</a>）</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*!</span></span><br><span class="line"><span class="comment"><span class="doctag">@typedef</span>CMTime</span></span><br><span class="line"><span class="comment"><span class="doctag">@abstract</span>Rational time value represented as int64/int32.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">typedef struct</span><br><span class="line">&#123;</span><br><span class="line">CMTimeValuevalue;<span class="comment">/*! <span class="doctag">@field</span> value The value of the CMTime. value/timescale = seconds. */</span></span><br><span class="line">CMTimeScaletimescale;<span class="comment">/*! <span class="doctag">@field</span> timescale The timescale of the CMTime. value/timescale = seconds.  */</span></span><br><span class="line">CMTimeFlagsflags;<span class="comment">/*! <span class="doctag">@field</span> flags The flags, eg. kCMTimeFlags_Valid, kCMTimeFlags_PositiveInfinity, etc. */</span></span><br><span class="line">CMTimeEpochepoch;<span class="comment">/*! <span class="doctag">@field</span> epoch Differentiates between equal timestamps that are actually different because</span></span><br><span class="line"><span class="comment"> of looping, multi-item sequencing, etc.  </span></span><br><span class="line"><span class="comment"> Will be used during comparison: greater epochs happen after lesser ones. </span></span><br><span class="line"><span class="comment"> Additions/subtraction is only possible within a single epoch,</span></span><br><span class="line"><span class="comment"> however, since epoch length may be unknown/variable. */</span></span><br><span class="line">&#125; CMTime;</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*!</span></span><br><span class="line"><span class="comment"><span class="doctag">@function</span>CMTimeMake</span></span><br><span class="line"><span class="comment"><span class="doctag">@abstract</span>Make a valid CMTime with value and timescale.  Epoch is implied to be 0.</span></span><br><span class="line"><span class="comment"><span class="doctag">@result</span>The resulting CMTime.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">CM_EXPORT </span><br><span class="line">CMTime CMTimeMake(</span><br><span class="line">int64_t value,<span class="comment">/*! <span class="doctag">@param</span> valueInitializes the value field of the resulting CMTime. */</span></span><br><span class="line">int32_t timescale)<span class="comment">/*! <span class="doctag">@param</span> timescaleInitializes the timescale field of the resulting CMTime. */</span></span><br><span class="line">__OSX_AVAILABLE_STARTING(__MAC_10_7,__IPHONE_4_0);</span><br></pre></td></tr></table></figure><pre><code>/*!    @function    CMTimeMakeWithSeconds    @abstract    Make a CMTime from a Float64 number of seconds, and a preferred timescale.    @discussion    The epoch of the result will be zero.  If preferredTimeScale is &lt;= 0, the result                will be an invalid CMTime.  If the preferred timescale will cause an overflow, the                timescale will be halved repeatedly until the overflow goes away, or the timescale                is 1.  If it still overflows at that point, the result will be +/- infinity.  The                kCMTimeFlags_HasBeenRounded flag will be set if the result, when converted back to                seconds, is not exactly equal to the original seconds value.    @result        The resulting CMTime.*/CM_EXPORT CMTime CMTimeMakeWithSeconds(                Float64 seconds,                int32_t preferredTimeScale)                            __OSX_AVAILABLE_STARTING(__MAC_10_7,__IPHONE_4_0);</code></pre><pre><code>CMTime firstframe=CMTimeMake(1,10);CMTime lastframe=CMTimeMake(10, 10);</code></pre><p>CMTime是专门用来表示影片事件用的类别，用法为：CMTimeMake(time, timeScale)。其中，time指的是时间，而不是秒，而时间要换算成秒，此时就要用到第二个参数timeScale。timeScale指的是1秒需要有几个frame构成（可以看作为fps），因此真正要表达的时间就是 time/timeScale，才会是秒。</p><p>上面的代码可以理解为，视频的fps（帧率）是10，firstframe是第一帧，在视频中的时间为0.1秒，lastframe是第10帧，在视频中的时间为1秒。</p><p>或者换种写法：CMTime curFrame = CMTimeMake(第几帧， 帧率）。看看另一篇博客的写法：<a href="http://blog.riaproject.com/objective-c/1745/解釋何謂ios中的cmtimemake.html" target="_blank" rel="noopener">解釋何謂iOS中的CMTimeMake</a>， 要使用VPN翻墙才能打开这篇文章。这么看，CMTime firstframe=CMTimeMake(32，16);<br>CMTime lastframe=CMTimeMake(48, 24); 这两个都表示2秒的时间。但是帧率是完全不同的。</p><p>CMTimeMakeWithSeconds和CMTimeMake区别在于，第一个函数的第一个参数可以是float，其他一样。</p><p>以上解释的比较清楚了，为加深印象，可看下stackoverflow上<a href="http://stackoverflow.com/questions/12902410/trying-to-understand-cmtime" target="_blank" rel="noopener">Trying to understand CMTime</a>一文。</p><p>综述如下：</p><pre><code>CMTimeMake(a,b)                   a当前第几帧, b每秒钟多少帧.当前播放时间a/bCMTimeMakeWithSeconds(a,b)    a当前时间,b每秒钟多少帧.</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> iOS </tag>
            
            <tag> 音视频处理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>在iOS平台上编译WebRTC</title>
      <link href="/2016/03/14/use-webrtc-codec-in-ios-platform/"/>
      <url>/2016/03/14/use-webrtc-codec-in-ios-platform/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
        <tags>
            
            <tag> iOS </tag>
            
            <tag> 音视频处理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2016年3月买房纪实</title>
      <link href="/2016/03/10/buy-house-in-2016-03/"/>
      <url>/2016/03/10/buy-house-in-2016-03/</url>
      
        <content type="html"><![CDATA[<p>　　去年11月就计划着今年要买房，根据市场行情，我看涨房价走势。但是没有快速入手，原因有很多。主要原因有考虑将来自己要待在哪里生活和发展。今年春节后，一线城市，强二线城市的房价蹭蹭蹭往上窜，此时不入手，更待何时。中国的房地产行情是独具中国特色的，按照市场经济规律来评判在中国行不通，身在中国看懂国家大政策就足够用来分析行情，市场经济规律与我等百姓干系不大。这也是中国房地产的奇特之处。很多经济学者和评论员看衰中国房地产，不如任志强的一句“有钱就买”来的深刻、清晰、明了。任志强，咱们的任大炮同志开炮中国房地产、政府，政府封了他的新浪微博，并发文批判他丧失党性人性，政治上的事千丝万缕，咱百姓插不上嘴，但是房地产这码事，明眼人都能看出点道道。这里不讨论任大炮同志，也不想讨论大部分网民。网民怎么怎么样，大炮同志所作所说怎样怎样，互联网这个大平台充当了事件辐射的工具，跟政府作对能有好果子吃么，跟大部分网民对着干实属浪费精力。事实上，2016年春节到现在，房地产市场普涨，这里不考虑三四线城市的行情，除非实在活不下去了，才有人回三四线城市的。</p><a id="more"></a><p>　　2月25号下定决心入手，马上开始搜集楼盘信息，3月4号下午，3月5号上午家里人看了一些楼盘后，经过与我商量，在3月5号中午交了定金，9号我与开发商签了商品房购买合同，就这样把房买了。3月1号国家发布降准的信息后，楼市一片涨涨涨，对于刚需者来说是利好。对于是否充当了开发商的接盘侠，我觉得有刚需、楼市利好、能拿出钱付首付、能承受每月还贷，那就买。中国文化中，家这个概念在每个人心中都占很大的分量。</p><p>　　计划买第二套房，但是考虑到还有一些重要的事情上花钱的地方很多，这个想法只能搁浅了。4月份开始，一线城市，二线城市的房价肯定是唰唰唰的往上涨，涨的会更猛。想买房，就不要指望房价跌，至于什么时候是拐点，刚需者有时间等吗？我觉得一等，就更没机会买房了。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 生活 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>回顾2015，展望2016</title>
      <link href="/2015/12/31/review-2015-outlook-2016/"/>
      <url>/2015/12/31/review-2015-outlook-2016/</url>
      
        <content type="html"><![CDATA[<p>　　今天是2015年12月31号，2015年最后的一天，这一年过的真快，自己在这一年中做了什么，在2016年需要做什么，我需要花点时间来总结和规划下。2015年的最后一天，没有了以往的那种希望时间快速过去的欲望，而是一种淡淡的对时间流逝的可惜和害怕，害怕变老，害怕时间过得太快，要做的事情没有按时完成。</p><a id="more"></a>]]></content>
      
      
      
        <tags>
            
            <tag> 工作 </tag>
            
            <tag> 生活 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>rtmp直播推流（二）－－将音频／视频推送到流媒体服务器</title>
      <link href="/2015/11/16/push-video-or-audio-to-server-in-rtmp-live-play/"/>
      <url>/2015/11/16/push-video-or-audio-to-server-in-rtmp-live-play/</url>
      
        <content type="html"><![CDATA[<p>参考我之前写的一篇文章<a href="https://depthlove.github.io/2015/09/18/use-ffmpeg-and-x264-encode-iOS-camera-video-to-h264/">利用FFmpeg+x264将iOS摄像头实时视频流编码为h264文件</a></p><p>参看文章<a href="http://blog.csdn.net/nonmarking/article/details/48022387" target="_blank" rel="noopener">ffmpeg综合应用示例（一）——摄像头直播 </a>，       <a href="http://blog.csdn.net/nonmarking/article/details/50522413" target="_blank" rel="noopener">ffmpeg综合应用示例（四）——摄像头直播的视音频同步</a></p><p>参看文章<a href="http://blog.csdn.net/leixiaohua1020/article/details/47072519" target="_blank" rel="noopener">最简单的基于FFmpeg的移动端例子：IOS 推流器</a>，      <a href="http://blog.csdn.net/leixiaohua1020/article/details/39803457" target="_blank" rel="noopener"> 最简单的基于FFmpeg的推流器（以推送RTMP为例）</a></p><a id="more"></a><p>使用librtmp发布h.264可参看文章<a href="http://blog.csdn.net/leixiaohua1020/article/details/42105049" target="_blank" rel="noopener">最简单的基于librtmp的示例：发布H.264（H.264通过RTMP发布）</a>，     <a href="http://blog.csdn.net/leixiaohua1020/article/details/42104945" target="_blank" rel="noopener">最简单的基于librtmp的示例：发布（FLV通过RTMP发布）</a></p><p>通过以上文章，就可以将采集到的音频／视频数据推送到流媒体服务器，至于观看延迟方面，需要结合实际情况区处理了。</p>]]></content>
      
      
      
        <tags>
            
            <tag> iOS </tag>
            
            <tag> 音视频处理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>rtmp直播推流（一）－－flv格式解析与封装</title>
      <link href="/2015/11/13/flv-analysis-in-rtmp-live-play/"/>
      <url>/2015/11/13/flv-analysis-in-rtmp-live-play/</url>
      
        <content type="html"><![CDATA[<p>flv文件格式分析，可参看<a href="http://www.cnblogs.com/chef/archive/2012/07/18/2597279.html" target="_blank" rel="noopener">RTMP中FLV流到标准h264、aac的转换</a>，该文章写的很清晰。</p><p>flv封装格式解析，可参看<a href="http://blog.csdn.net/leixiaohua1020/article/details/50535082" target="_blank" rel="noopener">视音频数据处理入门：FLV封装格式解析</a>，文章图文并貌，很直观。</p><p>flv文件封装，可参看<a href="http://blog.csdn.net/yeyumin89/article/details/7932368" target="_blank" rel="noopener">将h.264视频流封装成flv格式文件（一.flv格式）</a><br>，    <a href="http://blog.csdn.net/yeyumin89/article/details/7932431" target="_blank" rel="noopener">将h.264视频流封装成flv格式文件（二.开始动手）</a></p><p>使用rtmp协议发送flv文件，可参看<a href="http://blog.csdn.net/yeyumin89/article/details/8011362" target="_blank" rel="noopener">rtmp协议简单解析以及用其发送h264的flv文件</a></p><a id="more"></a><p>通过以上几篇好文，对flv文件格式，封装flv文件以及通过rtmp协议与流媒体服务器交互就有清晰的认识。</p><p>附上两张图</p><p>图一为 FLV Format with AVC Video Tag （H.264）</p><p><img src="https://raw.githubusercontent.com/depthlove/depthloveBlog/cd5e12823ac4e243a62893f9c942fad766a6c908/source/images/flv-analysis-in-rtmp-live-play/flv-analysis-in-rtmp-live-play-00.png" alt="flv video"></p><p>图二为 FLV Format with AAC Audio Tag (AAC)</p><p><img src="https://raw.githubusercontent.com/depthlove/depthloveBlog/cd5e12823ac4e243a62893f9c942fad766a6c908/source/images/flv-analysis-in-rtmp-live-play/flv-analysis-in-rtmp-live-play-01.png" alt="flv audio"></p>]]></content>
      
      
      
        <tags>
            
            <tag> 音视频处理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iOS开发需要掌握的知识点</title>
      <link href="/2015/10/29/iOS-development-need-abilities/"/>
      <url>/2015/10/29/iOS-development-need-abilities/</url>
      
        <content type="html"><![CDATA[<p>任何一个方向，都需要基本功扎实。软件开发领域，数据结构与算法，操作系统，网络协议（tcp/ip协议族）是立足的基础。</p><p>下面列举iOS开发需要掌握的知识点：</p><a id="more"></a><h2 id="一、数据结构与算法"><a href="#一、数据结构与算法" class="headerlink" title="一、数据结构与算法"></a>一、数据结构与算法</h2><h3 id="（一）数据结构"><a href="#（一）数据结构" class="headerlink" title="（一）数据结构"></a>（一）数据结构</h3><h4 id="1-链表"><a href="#1-链表" class="headerlink" title="1. 链表"></a>1. 链表</h4><h4 id="2-队列"><a href="#2-队列" class="headerlink" title="2. 队列"></a>2. 队列</h4><h4 id="3-树（二叉树）"><a href="#3-树（二叉树）" class="headerlink" title="3. 树（二叉树）"></a>3. 树（二叉树）</h4><h4 id="4-哈希表（即散列表）"><a href="#4-哈希表（即散列表）" class="headerlink" title="4. 哈希表（即散列表）"></a>4. 哈希表（即散列表）</h4><h3 id="（二）算法"><a href="#（二）算法" class="headerlink" title="（二）算法"></a>（二）算法</h3><h4 id="1-查找算法"><a href="#1-查找算法" class="headerlink" title="1. 查找算法"></a>1. 查找算法</h4><h4 id="2-排序算法"><a href="#2-排序算法" class="headerlink" title="2. 排序算法"></a>2. 排序算法</h4><h2 id="二、操作系统"><a href="#二、操作系统" class="headerlink" title="二、操作系统"></a>二、操作系统</h2><h3 id="（一）缓存"><a href="#（一）缓存" class="headerlink" title="（一）缓存"></a>（一）缓存</h3><h3 id="（二）分页"><a href="#（二）分页" class="headerlink" title="（二）分页"></a>（二）分页</h3><h3 id="（三）生产者与消费者"><a href="#（三）生产者与消费者" class="headerlink" title="（三）生产者与消费者"></a>（三）生产者与消费者</h3><h2 id="三、网络协议（tcp-ip协议族）"><a href="#三、网络协议（tcp-ip协议族）" class="headerlink" title="三、网络协议（tcp/ip协议族）"></a>三、网络协议（tcp/ip协议族）</h2><h3 id="（一）http协议（http-https）"><a href="#（一）http协议（http-https）" class="headerlink" title="（一）http协议（http/https）"></a>（一）http协议（http/https）</h3><h3 id="（二）tcp协议"><a href="#（二）tcp协议" class="headerlink" title="（二）tcp协议"></a>（二）tcp协议</h3><h3 id="（三）udp协议"><a href="#（三）udp协议" class="headerlink" title="（三）udp协议"></a>（三）udp协议</h3><h3 id="（四）ip协议"><a href="#（四）ip协议" class="headerlink" title="（四）ip协议"></a>（四）ip协议</h3><h2 id="四、Socket、Thread（套接字、线程）"><a href="#四、Socket、Thread（套接字、线程）" class="headerlink" title="四、Socket、Thread（套接字、线程）"></a>四、Socket、Thread（套接字、线程）</h2><h3 id="（一）Socket（套接字）"><a href="#（一）Socket（套接字）" class="headerlink" title="（一）Socket（套接字）"></a>（一）Socket（套接字）</h3><h3 id="（二）Thread（线程）"><a href="#（二）Thread（线程）" class="headerlink" title="（二）Thread（线程）"></a>（二）Thread（线程）</h3><h2 id="四、iOS方向知识点"><a href="#四、iOS方向知识点" class="headerlink" title="四、iOS方向知识点"></a>四、iOS方向知识点</h2><h3 id="（一）AutoLayout-SizeClass"><a href="#（一）AutoLayout-SizeClass" class="headerlink" title="（一）AutoLayout / SizeClass"></a>（一）AutoLayout / SizeClass</h3><h3 id="（二）KVO-KVC"><a href="#（二）KVO-KVC" class="headerlink" title="（二）KVO/KVC"></a>（二）KVO/KVC</h3><h3 id="（三）NSNotification"><a href="#（三）NSNotification" class="headerlink" title="（三）NSNotification"></a>（三）NSNotification</h3><h3 id="（四）Block"><a href="#（四）Block" class="headerlink" title="（四）Block"></a>（四）Block</h3><h3 id="（五）Protocol-Delegate"><a href="#（五）Protocol-Delegate" class="headerlink" title="（五）Protocol/Delegate"></a>（五）Protocol/Delegate</h3><h3 id="（六）Grand-Central-Dispatch"><a href="#（六）Grand-Central-Dispatch" class="headerlink" title="（六）Grand Central Dispatch"></a>（六）Grand Central Dispatch</h3><h3 id="（七）NSOperation-Queue"><a href="#（七）NSOperation-Queue" class="headerlink" title="（七）NSOperation Queue"></a>（七）NSOperation Queue</h3><h3 id="（八）NSRunloop"><a href="#（八）NSRunloop" class="headerlink" title="（八）NSRunloop"></a>（八）NSRunloop</h3><h3 id="（九）Runtime"><a href="#（九）Runtime" class="headerlink" title="（九）Runtime"></a>（九）Runtime</h3><h3 id="（十）HTTP-Request：Post、Get"><a href="#（十）HTTP-Request：Post、Get" class="headerlink" title="（十）HTTP Request：Post、Get"></a>（十）HTTP Request：Post、Get</h3><h3 id="（十一）Json、XML"><a href="#（十一）Json、XML" class="headerlink" title="（十一）Json、XML"></a>（十一）Json、XML</h3><h3 id="（十二）CoreData、Sqlite"><a href="#（十二）CoreData、Sqlite" class="headerlink" title="（十二）CoreData、Sqlite"></a>（十二）CoreData、Sqlite</h3><h3 id="（十三）LLDB"><a href="#（十三）LLDB" class="headerlink" title="（十三）LLDB"></a>（十三）LLDB</h3>]]></content>
      
      
      
        <tags>
            
            <tag> iOS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>音视频编解码中常用的编译脚本</title>
      <link href="/2015/10/29/frequently-used-audio-and-video-codec-script/"/>
      <url>/2015/10/29/frequently-used-audio-and-video-codec-script/</url>
      
        <content type="html"><![CDATA[<h3 id="FFmpeg"><a href="#FFmpeg" class="headerlink" title="FFmpeg"></a>FFmpeg</h3><p>iOS：<a href="https://github.com/kewlbear/FFmpeg-iOS-build-script" target="_blank" rel="noopener">https://github.com/kewlbear/FFmpeg-iOS-build-script</a></p><h3 id="x264"><a href="#x264" class="headerlink" title="x264"></a>x264</h3><p>iOS：<a href="https://github.com/kewlbear/x264-ios" target="_blank" rel="noopener">https://github.com/kewlbear/x264-ios</a></p><h3 id="fdk-aac"><a href="#fdk-aac" class="headerlink" title="fdk-aac"></a>fdk-aac</h3><p>iOS：<a href="https://github.com/verybigdog/fdk-aac-ios" target="_blank" rel="noopener">https://github.com/verybigdog/fdk-aac-ios</a></p><p>或 <a href="https://github.com/kewlbear/fdk-aac-build-script-for-iOS" target="_blank" rel="noopener">https://github.com/kewlbear/fdk-aac-build-script-for-iOS</a>，不支持iOS arm64，但是可以借鉴</p><h3 id="librtmp"><a href="#librtmp" class="headerlink" title="librtmp"></a>librtmp</h3><p>iOS：<a href="https://github.com/saiten/ios-librtmp" target="_blank" rel="noopener">https://github.com/saiten/ios-librtmp</a></p><h3 id="OpenSSL"><a href="#OpenSSL" class="headerlink" title="OpenSSL"></a>OpenSSL</h3><p>iOS：<a href="https://github.com/x2on/OpenSSL-for-iPhone" target="_blank" rel="noopener">https://github.com/x2on/OpenSSL-for-iPhone</a></p><a id="more"></a>]]></content>
      
      
      
        <tags>
            
            <tag> 音视频处理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iOS上使用VideoToolBox硬解码h264</title>
      <link href="/2015/10/24/use-VideoToolBox-decode-h264/"/>
      <url>/2015/10/24/use-VideoToolBox-decode-h264/</url>
      
        <content type="html"><![CDATA[<p>　　以下内容摘自我博客的<a href="https://depthlove.github.io/2015/09/16/build-X264-library-for-iOS-platform/">编译iOS平台上使用的X264库</a>一文。</p><p>　　从iOS8开始，苹果开放了硬解码和硬编码API，框架为VideoToolbox.framework， 此框架需要在iOS8及以上的系统上才能使用。</p><p>　　此框架中的硬解码API是几个纯C函数，在任何OC或者 C++代码里都可以使用。使用的时候，首先，要把 VideoToolbox.framework 添加到工程里，并且在要使用该API的文件中包含头文件 #include &lt;VideoToolbox/VideoToolbox.h&gt;，然后，就可以畅快的高效的对视频流进行硬编码了。</p><p>　　其实至少从iPhone4开始，苹果就是支持硬件解码了，但是硬解码API框架VideoToolBox一直是私有API，如果调用这个私有库，那么app在必须在越狱的设备上运行，正常的App如果想提交到AppStore是不允许使用私有API的。</p><p>点评：对于如何使用iOS平台上的VideoToolbox框架对图像数据进行硬编码，github上已经有很多demo了，虽然苹果官方文档对VideoToolbox介绍的不全面，但足以搞清楚整个流程，至于细节需要花些时间自己去搞了，比如时间戳的计算。</p><a id="more"></a>]]></content>
      
      
      
        <tags>
            
            <tag> iOS </tag>
            
            <tag> 音视频处理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>利用FFmpeg和rtmp实现iOS设备上摄像头视频流的推送</title>
      <link href="/2015/10/13/use-ffmpeg-and-rtmp-to-push-iOS-camera-streaming/"/>
      <url>/2015/10/13/use-ffmpeg-and-rtmp-to-push-iOS-camera-streaming/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
        <tags>
            
            <tag> iOS </tag>
            
            <tag> 音视频处理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mac上安装Android Studio</title>
      <link href="/2015/10/09/install-android-studio-ide/"/>
      <url>/2015/10/09/install-android-studio-ide/</url>
      
        <content type="html"><![CDATA[<p>　　Google在国内被墙，有关android开发的一些工具在Google上下载都需要使用VPN服务。我使用过一些免费与付费的VPN，想使用较好的服务质量就需要花点小钱，付费VPN中 <a href="http://v.uuu.net/" target="_blank" rel="noopener">uuu vpn</a> 很好用，有windows，Mac客户端，使用比较方便，代理服务稳定，快速，比 <a href="http://www.greenvpncn.com/" target="_blank" rel="noopener">green vpn</a> 好用多了，green vpn很烂，买过几次包月的套餐，向其客服吐槽过其VPN简直烂的让人无语，总之，对green vpn 没有什么好印象了。</p><a id="more"></a><h3 id="一、使用VPN服务"><a href="#一、使用VPN服务" class="headerlink" title="一、使用VPN服务"></a>一、使用VPN服务</h3><p>　　具体使用什么VPN看个人喜好，我使用的是uuu vpn。在Mac上启用 uuu vpn，翻墙。　　</p><h3 id="二、在Google官网下载Android-Studio"><a href="#二、在Google官网下载Android-Studio" class="headerlink" title="二、在Google官网下载Android Studio"></a>二、在Google官网下载Android Studio</h3><p>　　Android Studio 的官方下载地址为：<a href="http://developer.android.com/sdk/index.html" target="_blank" rel="noopener">http://developer.android.com/sdk/index.html</a>。我的系统是Mac，选择Mac版的Android Studio IDE。</p><p>　　下载android studio：</p><p><img src="http://images2015.cnblogs.com/blog/719115/201510/719115-20151009102102393-1885681577.png" alt="下载进度"></p><p>　　下载后，下载页面出现一下安装提示信息 <a href="http://developer.android.com/sdk/installing/index.html?pkg=studio" target="_blank" rel="noopener">Installing Android Studio</a>，重要信息如下：</p><p><img src="http://images2015.cnblogs.com/blog/719115/201510/719115-20151009102135112-514568119.png" alt="安装步骤提示"></p><p>　　在安装android studio 之前，必须安装 JDK 6 或者 JDK 的更高版本，只安装 JRE 是不够的。要开发 android 5.0 或更高的android系统版本程序，就必须安装 JDK 7。要知道自己的Mac系统上是否安装了 JDK ，在Mac终端执行命令 <code>javac -version</code>，如下：</p><p><img src="http://images2015.cnblogs.com/blog/719115/201510/719115-20151009103638831-972699102.png" alt="检查jdk安装信息"></p><p>从图中的命令执行结果可知，Mac上安装的 JDK 的版本为 JDK 8 Update 40 。</p><p>　　如果检查到 JDK 没有安装，或者版本低于6，那么，就需要下载新版本的JDK，并安装。</p><p>　　</p>]]></content>
      
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用FFmpeg开发iOS播放器（第一部分）</title>
      <link href="/2015/10/08/use-ffmpeg-to-create-a-iOS-player-part1/"/>
      <url>/2015/10/08/use-ffmpeg-to-create-a-iOS-player-part1/</url>
      
        <content type="html"><![CDATA[<h3 id="一、开发需求"><a href="#一、开发需求" class="headerlink" title="一、开发需求"></a>一、开发需求</h3><ul><li><h4 id="支持多种流媒体协议（rtsp-rtmp-hls）"><a href="#支持多种流媒体协议（rtsp-rtmp-hls）" class="headerlink" title="支持多种流媒体协议（rtsp, rtmp, hls）"></a>支持多种流媒体协议（rtsp, rtmp, hls）</h4></li><li><h4 id="播放，暂停，拖动"><a href="#播放，暂停，拖动" class="headerlink" title="播放，暂停，拖动"></a>播放，暂停，拖动</h4></li><li><h4 id="录像，截图"><a href="#录像，截图" class="headerlink" title="录像，截图"></a>录像，截图</h4></li><li><h4 id="语音对讲，视频对讲"><a href="#语音对讲，视频对讲" class="headerlink" title="语音对讲，视频对讲"></a>语音对讲，视频对讲</h4></li><li><h4 id="视频上传流媒体服务器"><a href="#视频上传流媒体服务器" class="headerlink" title="视频上传流媒体服务器"></a>视频上传流媒体服务器</h4></li></ul><a id="more"></a><h3 id="二、开发准备工作"><a href="#二、开发准备工作" class="headerlink" title="二、开发准备工作"></a>二、开发准备工作</h3><ul><li><h4 id="查看流媒体协议知识点"><a href="#查看流媒体协议知识点" class="headerlink" title="查看流媒体协议知识点"></a>查看流媒体协议知识点</h4></li><li><h4 id="理解音视频流的分离与复合"><a href="#理解音视频流的分离与复合" class="headerlink" title="理解音视频流的分离与复合"></a>理解音视频流的分离与复合</h4></li><li><h4 id="编译FFmpeg库"><a href="#编译FFmpeg库" class="headerlink" title="编译FFmpeg库"></a>编译FFmpeg库</h4></li><li><h4 id="通读FFmpeg源码中ffplay-c"><a href="#通读FFmpeg源码中ffplay-c" class="headerlink" title="通读FFmpeg源码中ffplay.c"></a>通读FFmpeg源码中ffplay.c</h4></li><li><h4 id="理解OpengGL-ES的渲染流程"><a href="#理解OpengGL-ES的渲染流程" class="headerlink" title="理解OpengGL ES的渲染流程"></a>理解OpengGL ES的渲染流程</h4></li></ul><h3 id="三、开发执行"><a href="#三、开发执行" class="headerlink" title="三、开发执行"></a>三、开发执行</h3><ul><li><h4 id="记录开发过程中的心得"><a href="#记录开发过程中的心得" class="headerlink" title="记录开发过程中的心得"></a>记录开发过程中的心得</h4></li><li><h4 id="完成iOS播放器库-a"><a href="#完成iOS播放器库-a" class="headerlink" title="完成iOS播放器库(*.a)"></a>完成iOS播放器库(*.a)</h4></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> iOS </tag>
            
            <tag> 音视频处理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>在Mac OSX上安装ffmpeg &amp;&amp; ffmpeg命令行将h264封装为mp4</title>
      <link href="/2015/09/24/install-ffmpeg-to-MacOSX-and-use-ffmpeg-to-transform-h264-to-mp4/"/>
      <url>/2015/09/24/install-ffmpeg-to-MacOSX-and-use-ffmpeg-to-transform-h264-to-mp4/</url>
      
        <content type="html"><![CDATA[<p>ffmpeg功能强大，可以通过命令行来对音视频进行处理。为了使用其功能，我在Mac上对其进行了安装。</p><p>我的Mac OS X 系统版本：OS X Yosemite, 10.10.14</p><a id="more"></a><p>关于ffmpeg在Mac OS X上的编译，FFmpeg上有官方文档说明：<a href="https://trac.ffmpeg.org/wiki/CompilationGuide/MacOSX" target="_blank" rel="noopener">https://trac.ffmpeg.org/wiki/CompilationGuide/MacOSX</a>。该文档给出了3种方法：</p><ul><li>ffmpeg through Homebrew</li><li>Compiling FFmpeg yourself</li><li>Manual install of the dependencies without Homebrew</li></ul><p>看了这三种方法的官方说明后，我选择了第一种，因为最简单。</p><h3 id="首先，Mac上要安装Homebrew"><a href="#首先，Mac上要安装Homebrew" class="headerlink" title="首先，Mac上要安装Homebrew"></a>首先，Mac上要安装Homebrew</h3><p>在终端执行命令，<strong>ruby -e “$(curl -fsSL <a href="https://raw.githubusercontent.com/Homebrew/install/master/install)&quot;" target="_blank" rel="noopener">https://raw.githubusercontent.com/Homebrew/install/master/install)&quot;</a></strong></p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">devtemobideMac-<span class="string">mini:</span>~ sunminmin$ ruby -e <span class="string">"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"</span></span><br><span class="line"></span><br><span class="line">==&gt; This script will <span class="string">install:</span></span><br><span class="line"></span><br><span class="line"><span class="regexp">/usr/</span>local<span class="regexp">/bin/</span>brew</span><br><span class="line"></span><br><span class="line"><span class="regexp">/usr/</span>local<span class="regexp">/Library/</span>...</span><br><span class="line"></span><br><span class="line"><span class="regexp">/usr/</span>local<span class="regexp">/share/</span>man<span class="regexp">/man1/</span>brew<span class="number">.1</span></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">Press RETURN to <span class="keyword">continue</span> or any other key to abort</span><br><span class="line"></span><br><span class="line">==&gt; <span class="regexp">/usr/</span>bin<span class="regexp">/sudo /</span>bin<span class="regexp">/chmod g+rwx /</span>Library<span class="regexp">/Caches/</span>Homebrew</span><br><span class="line"></span><br><span class="line"><span class="string">Password:</span></span><br><span class="line"></span><br><span class="line">==&gt; Downloading and installing Homebrew...</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="string">remote:</span> Counting <span class="string">objects:</span> <span class="number">225571</span>, done.</span><br><span class="line"></span><br><span class="line"><span class="string">remote:</span> Compressing <span class="string">objects:</span> <span class="number">100</span>% (<span class="number">59354</span>/<span class="number">59354</span>), done.</span><br><span class="line"></span><br><span class="line"><span class="string">remote:</span> Total <span class="number">225571</span> (delta <span class="number">165037</span>), reused <span class="number">225482</span> (delta <span class="number">164969</span>)</span><br><span class="line"></span><br><span class="line">Receiving <span class="string">objects:</span> <span class="number">100</span>% (<span class="number">225571</span><span class="regexp">/225571), 51.57 MiB | 1.19 MiB/</span>s, done.</span><br><span class="line"></span><br><span class="line">Resolving <span class="string">deltas:</span> <span class="number">100</span>% (<span class="number">165037</span>/<span class="number">165037</span>), done.</span><br><span class="line"></span><br><span class="line">From <span class="string">https:</span><span class="comment">//github.com/Homebrew/homebrew</span></span><br><span class="line"></span><br><span class="line"> * [<span class="keyword">new</span> branch]      master     -&gt; origin/master</span><br><span class="line"></span><br><span class="line">HEAD is now at <span class="number">82</span>d7dc4 <span class="string">tomcat:</span> update <span class="number">8.0</span><span class="number">.17</span> bottle.</span><br><span class="line"></span><br><span class="line">==&gt; Installation successful!</span><br><span class="line"></span><br><span class="line">==&gt; Next steps</span><br><span class="line"></span><br><span class="line">Run `brew doctor` before you install anything</span><br><span class="line"></span><br><span class="line">Run `brew help` to get started</span><br></pre></td></tr></table></figure><h3 id="其次，安装ffmpeg"><a href="#其次，安装ffmpeg" class="headerlink" title="其次，安装ffmpeg"></a>其次，安装ffmpeg</h3><p>在终端执行命令，<strong>brew install ffmpeg</strong></p><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">devtemobideMac-mini:~ sunminmin$ brew install ffmpeg</span><br><span class="line">==&gt; Installing dependencies for ffmpeg: x264, lame, libvo-aacenc, xvid</span><br><span class="line">==&gt; Installing ffmpeg dependency: x264</span><br><span class="line">==&gt; Downloading https:<span class="comment">//homebrew.bintray.com/bottles/x264-r2533.yosemite.bottle.</span></span><br><span class="line">######################################################################## <span class="number">100.0</span>%</span><br><span class="line">==&gt; Pouring x264-r2533.yosemite.bottle.tar.gz</span><br><span class="line">🍺  /usr/local/Cellar/x264/r2533: <span class="number">9</span> files, <span class="number">3.4</span>M</span><br><span class="line">==&gt; Installing ffmpeg dependency: lame</span><br><span class="line">==&gt; Downloading https:<span class="comment">//homebrew.bintray.com/bottles/lame-3.99.5.yosemite.bottle</span></span><br><span class="line">######################################################################## <span class="number">100.0</span>%</span><br><span class="line">==&gt; Pouring lame<span class="number">-3.99</span><span class="number">.5</span>.yosemite.bottle<span class="number">.1</span>.tar.gz</span><br><span class="line">🍺  /usr/local/Cellar/lame/<span class="number">3.99</span><span class="number">.5</span>: <span class="number">25</span> files, <span class="number">2.1</span>M</span><br><span class="line">==&gt; Installing ffmpeg dependency: libvo-aacenc</span><br><span class="line">==&gt; Downloading https:<span class="comment">//homebrew.bintray.com/bottles/libvo-aacenc-0.1.3.yosemite</span></span><br><span class="line">######################################################################## <span class="number">100.0</span>%</span><br><span class="line">==&gt; Pouring libvo-aacenc<span class="number">-0.1</span><span class="number">.3</span>.yosemite.bottle.tar.gz</span><br><span class="line">🍺  /usr/local/Cellar/libvo-aacenc/<span class="number">0.1</span><span class="number">.3</span>: <span class="number">15</span> files, <span class="number">336</span>K</span><br><span class="line">==&gt; Installing ffmpeg dependency: xvid</span><br><span class="line">==&gt; Downloading https:<span class="comment">//homebrew.bintray.com/bottles/xvid-1.3.3.yosemite.bottle.</span></span><br><span class="line">######################################################################## <span class="number">100.0</span>%</span><br><span class="line">==&gt; Pouring xvid<span class="number">-1.3</span><span class="number">.3</span>.yosemite.bottle<span class="number">.2</span>.tar.gz</span><br><span class="line">🍺  /usr/local/Cellar/xvid/<span class="number">1.3</span><span class="number">.3</span>: <span class="number">9</span> files, <span class="number">1.3</span>M</span><br><span class="line">==&gt; Installing ffmpeg</span><br><span class="line">==&gt; Downloading https:<span class="comment">//homebrew.bintray.com/bottles/ffmpeg-2.6.3.yosemite.bottle.ta</span></span><br><span class="line">######################################################################## <span class="number">100.0</span>%</span><br><span class="line">==&gt; Pouring ffmpeg<span class="number">-2.6</span><span class="number">.3</span>.yosemite.bottle.tar.gz</span><br><span class="line">==&gt; Caveats</span><br><span class="line">FFmpeg has been built without libfaac for licensing reasons;</span><br><span class="line">libvo-aacenc is used by default.</span><br><span class="line">To install <span class="keyword">with</span> libfaac, you can:</span><br><span class="line">  brew reinstall ffmpeg --<span class="keyword">with</span>-faac</span><br><span class="line"></span><br><span class="line">You can also use the experimental FFmpeg encoder, libfdk-aac, or</span><br><span class="line">libvo_aacenc to encode AAC audio:</span><br><span class="line">  ffmpeg -i input.wav -c:a aac -strict experimental output.m4a</span><br><span class="line">Or:</span><br><span class="line">  brew reinstall ffmpeg --<span class="keyword">with</span>-fdk-aac</span><br><span class="line">  ffmpeg -i input.wav -c:a libfdk_aac output.m4a</span><br><span class="line">==&gt; Summary</span><br><span class="line">🍺  /usr/local/Cellar/ffmpeg/<span class="number">2.6</span><span class="number">.3</span>: <span class="number">204</span> files, <span class="number">42</span>M</span><br></pre></td></tr></table></figure><h3 id="再次，查看ffmpeg-info"><a href="#再次，查看ffmpeg-info" class="headerlink" title="再次，查看ffmpeg info"></a>再次，查看ffmpeg info</h3><p>在终端执行命令，<strong>brew info ffmpeg</strong></p><figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line">devtemobideMac-mini:~ sunminmin$ brew info ffmpeg</span><br><span class="line">ffmpeg: stable 2.6.3 (bottled), HEAD</span><br><span class="line">Play, record, convert, and stream audio and video</span><br><span class="line">https://ffmpeg.org/</span><br><span class="line"><span class="comment">/usr/local/Cellar/ffmpeg/2.6.3 (204 files, 42M) *</span></span><br><span class="line">  Poured from bottle</span><br><span class="line">From: https://github.com/Homebrew/homebrew/blob/master/Library/Formula/ffmpeg.rb</span><br><span class="line">=<span class="ruby">=&gt; Dependencies</span></span><br><span class="line"><span class="ruby"><span class="symbol">Build:</span> pkg-config ✘, texi2html ✘, yasm ✘</span></span><br><span class="line"><span class="ruby"><span class="symbol">Recommended:</span> x264 ✔, lame ✔, libvo-aacenc ✔, xvid ✔</span></span><br><span class="line"><span class="ruby"><span class="symbol">Optional:</span> faac ✘, fontconfig ✘, freetype ✘, theora ✘, libvorbis ✘, libvpx ✘, rtmpdump ✘, opencore-amr ✘, libass ✘, openjpeg ✘, speex ✘, schroedinger ✘, fdk-aac ✘, opus ✘, frei0r ✘, libcaca ✘, libbluray ✘, libsoxr ✘, libquvi ✘, libvidstab ✘, x265 ✘, openssl ✘, libssh ✘, webp ✘</span></span><br><span class="line"><span class="ruby">==&gt; Options</span></span><br><span class="line"><span class="ruby">--with-faac</span></span><br><span class="line"><span class="ruby">Build with faac support</span></span><br><span class="line"><span class="ruby">--with-fdk-aac</span></span><br><span class="line"><span class="ruby">Enable the Fraunhofer FDK AAC library</span></span><br><span class="line"><span class="ruby">--with-ffplay</span></span><br><span class="line"><span class="ruby">Enable FFplay media player</span></span><br><span class="line"><span class="ruby">--with-fontconfig</span></span><br><span class="line"><span class="ruby">Build with fontconfig support</span></span><br><span class="line"><span class="ruby">--with-freetype</span></span><br><span class="line"><span class="ruby">Build with freetype support</span></span><br><span class="line"><span class="ruby">--with-frei0r</span></span><br><span class="line"><span class="ruby">Build with frei0r support</span></span><br><span class="line"><span class="ruby">--with-libass</span></span><br><span class="line"><span class="ruby">Enable ASS/SSA subtitle format</span></span><br><span class="line"><span class="ruby">--with-libbluray</span></span><br><span class="line"><span class="ruby">Build with libbluray support</span></span><br><span class="line"><span class="ruby">--with-libcaca</span></span><br><span class="line"><span class="ruby">Build with libcaca support</span></span><br><span class="line"><span class="ruby">--with-libquvi</span></span><br><span class="line"><span class="ruby">Build with libquvi support</span></span><br><span class="line"><span class="ruby">--with-libsoxr</span></span><br><span class="line"><span class="ruby">Enable the soxr resample library</span></span><br><span class="line"><span class="ruby">--with-libssh</span></span><br><span class="line"><span class="ruby">Enable SFTP protocol via libssh</span></span><br><span class="line"><span class="ruby">--with-libvidstab</span></span><br><span class="line"><span class="ruby">Enable vid.stab support <span class="keyword">for</span> video stabilization</span></span><br><span class="line"><span class="ruby">--with-libvorbis</span></span><br><span class="line"><span class="ruby">Build with libvorbis support</span></span><br><span class="line"><span class="ruby">--with-libvpx</span></span><br><span class="line"><span class="ruby">Build with libvpx support</span></span><br><span class="line"><span class="ruby">--with-opencore-amr</span></span><br><span class="line"><span class="ruby">Enable Opencore AMR NR/WB audio format</span></span><br><span class="line"><span class="ruby">--with-openjpeg</span></span><br><span class="line"><span class="ruby">Enable JPEG <span class="number">2000</span> image format</span></span><br><span class="line"><span class="ruby">--with-openssl</span></span><br><span class="line"><span class="ruby">Enable SSL support</span></span><br><span class="line"><span class="ruby">--with-opus</span></span><br><span class="line"><span class="ruby">Build with opus support</span></span><br><span class="line"><span class="ruby">--with-rtmpdump</span></span><br><span class="line"><span class="ruby">Enable RTMP protocol</span></span><br><span class="line"><span class="ruby">--with-schroedinger</span></span><br><span class="line"><span class="ruby">Enable Dirac video format</span></span><br><span class="line"><span class="ruby">--with-speex</span></span><br><span class="line"><span class="ruby">Build with speex support</span></span><br><span class="line"><span class="ruby">--with-theora</span></span><br><span class="line"><span class="ruby">Build with theora support</span></span><br><span class="line"><span class="ruby">--with-tools</span></span><br><span class="line"><span class="ruby">Enable additional FFmpeg tools</span></span><br><span class="line"><span class="ruby">--with-webp</span></span><br><span class="line"><span class="ruby">Enable using libwebp to encode WEBP images</span></span><br><span class="line"><span class="ruby">--with-x265</span></span><br><span class="line"><span class="ruby">Enable x265 encoder</span></span><br><span class="line"><span class="ruby">--without-lame</span></span><br><span class="line"><span class="ruby">Disable MP3 encoder</span></span><br><span class="line"><span class="ruby">--without-libvo-aacenc</span></span><br><span class="line"><span class="ruby">Disable VisualOn AAC encoder</span></span><br><span class="line"><span class="ruby">--without-qtkit</span></span><br><span class="line"><span class="ruby">Disable deprecated QuickTime framework</span></span><br><span class="line"><span class="ruby">--without-x264</span></span><br><span class="line"><span class="ruby">Disable H.<span class="number">264</span> encoder</span></span><br><span class="line"><span class="ruby">--without-xvid</span></span><br><span class="line"><span class="ruby">Disable Xvid MPEG-<span class="number">4</span> video encoder</span></span><br><span class="line"><span class="ruby">--HEAD</span></span><br><span class="line"><span class="ruby">Install HEAD version</span></span><br><span class="line"><span class="ruby">==&gt; Caveats</span></span><br><span class="line"><span class="ruby">FFmpeg has been built without libfaac <span class="keyword">for</span> licensing reasons;</span></span><br><span class="line"><span class="ruby">libvo-aacenc is used by default.</span></span><br><span class="line"><span class="ruby">To install with libfaac, you <span class="symbol">can:</span></span></span><br><span class="line"><span class="ruby">  brew reinstall ffmpeg --with-faac</span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby">You can also use the experimental FFmpeg encoder, libfdk-aac, <span class="keyword">or</span></span></span><br><span class="line"><span class="ruby">libvo_aacenc to encode AAC <span class="symbol">audio:</span></span></span><br><span class="line"><span class="ruby">  ffmpeg -i input.wav -<span class="symbol">c:</span>a aac -strict experimental output.m4a</span></span><br><span class="line"><span class="ruby"><span class="symbol">Or:</span></span></span><br><span class="line"><span class="ruby">  brew reinstall ffmpeg --with-fdk-aac</span></span><br><span class="line"><span class="ruby">  ffmpeg -i input.wav -<span class="symbol">c:</span>a libfdk_aac output.m4a</span></span><br></pre></td></tr></table></figure><p>经过这3步，现在就可以使用ffmpeg的强大功能了。</p><p>现在ffmpeg的版本更新很快，今年3月份发布了 FFmpeg 2.6.1，7月份发布了 FFmpeg 2.7.2，中间还有一些其它版本，比如2.7，2.7.1，这些版本我都在iOS平台上编译使用过，今年9月份，FFmpeg 的版本更新到了2.8。今年，我见证了FFmpeg更新最频繁的的时刻。</p><p>经过前面的3步，在Mac上安装了 ffmpeg 2.6.3 的版本，过段时间，homebrew上ffmpeg 的安装源就会更新，若想升级ffmpeg，就需要执行下面的第4步操作了。</p><h3 id="最后，升级ffmpeg的版本"><a href="#最后，升级ffmpeg的版本" class="headerlink" title="最后，升级ffmpeg的版本"></a>最后，升级ffmpeg的版本</h3><p>若想升级ffmpeg的版本，可以在终端执行命令，<strong>brew update &amp;&amp; brew upgrade ffmpeg</strong></p><h2 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h2><p>安装好了ffmpeg，就要试试其功能了。采用文章<a href="http://depthlove.github.io/2015/09/17/use-x264-encode-iOS-camera-video-to-h264/">利用x264将iOS摄像头实时视频流编码为h264文件</a>配套工程<a href="https://github.com/depthlove/X264-Encode-for-iOS" target="_blank" rel="noopener">X264-Encode-for-iOS</a>中的<strong>h264文件</strong>，该文件地址为<a href="https://github.com/depthlove/X264-Encode-for-iOS/blob/master/myRecordH264Vieo/2015-09-17%2018:05:20.h264" target="_blank" rel="noopener">2015-09-17 18:05:20.h264</a>，使用ffmpeg 命令将其打包为 <strong>.mp4容器格式的文件</strong></p><p>将该h264文件下载，在终端上，执行命令进入存放该文件的目录</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">devtemobideMac-<span class="string">mini:</span>~ sunminmin$ cd <span class="regexp">/Users/</span>dev.temobi<span class="regexp">/Desktop/</span>sunmmMainPrj/ZZ_Z_Github_clone</span><br></pre></td></tr></table></figure><p>进入到该目录后，执行命令，<strong>ffmpeg -i 2015-09-17\ 18_05_20.h264  2015-09-17.mp4</strong></p><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">devtemobideMac-mini:ZZ_Z_Github_clone sunminmin$ ffmpeg -i <span class="number">2015</span>-<span class="number">09</span>-<span class="number">17</span>\ <span class="number">18</span>_05_20.h264  <span class="number">2015</span>-<span class="number">09</span>-<span class="number">17</span>.mp4</span><br><span class="line">ffmpeg version <span class="number">2.6</span>.<span class="number">3</span> Copyright (c) <span class="number">2000</span>-<span class="number">2015</span> the FFmpeg developers</span><br><span class="line">  built <span class="keyword">with</span> Apple LLVM version <span class="number">6.1</span>.<span class="number">0</span> (clang-<span class="number">602.0</span>.<span class="number">53</span>) (based on LLVM <span class="number">3.6</span>.<span class="number">0</span>svn)</span><br><span class="line">  configuration: <span class="attr">--prefix=/usr/local/Cellar/ffmpeg/2.6.3</span> --enable-shared --enable-pthreads --enable-gpl --enable-version3 --enable-hardcoded-tables --enable-avresample <span class="attr">--cc=clang</span> <span class="attr">--host-cflags=</span> <span class="attr">--host-ldflags=</span> --enable-libx264 --enable-libmp3lame --enable-libvo-aacenc --enable-libxvid --enable-vda</span><br><span class="line">  libavutil      <span class="number">54</span>. <span class="number">20.100</span> / <span class="number">54</span>. <span class="number">20.100</span></span><br><span class="line">  libavcodec     <span class="number">56</span>. <span class="number">26.100</span> / <span class="number">56</span>. <span class="number">26.100</span></span><br><span class="line">  libavformat    <span class="number">56</span>. <span class="number">25.101</span> / <span class="number">56</span>. <span class="number">25.101</span></span><br><span class="line">  libavdevice    <span class="number">56</span>.  <span class="number">4.100</span> / <span class="number">56</span>.  <span class="number">4.100</span></span><br><span class="line">  libavfilter     <span class="number">5</span>. <span class="number">11.102</span> /  <span class="number">5</span>. <span class="number">11.102</span></span><br><span class="line">  libavresample   <span class="number">2</span>.  <span class="number">1</span>.  <span class="number">0</span> /  <span class="number">2</span>.  <span class="number">1</span>.  <span class="number">0</span></span><br><span class="line">  libswscale      <span class="number">3</span>.  <span class="number">1.101</span> /  <span class="number">3</span>.  <span class="number">1.101</span></span><br><span class="line">  libswresample   <span class="number">1</span>.  <span class="number">1.100</span> /  <span class="number">1</span>.  <span class="number">1.100</span></span><br><span class="line">  libpostproc    <span class="number">53</span>.  <span class="number">3.100</span> / <span class="number">53</span>.  <span class="number">3.100</span></span><br><span class="line">Input <span class="comment">#0, h264, from '2015-09-17 18_05_20.h264':</span></span><br><span class="line">  Duration: N/A, bitrate: N/A</span><br><span class="line">    Stream <span class="comment">#0:0: Video: h264 (Constrained Baseline), yuv420p, 480x360, 15 fps, 15 tbr, 1200k tbn, 30 tbc</span></span><br><span class="line">[libx264 @ <span class="number">0</span>x7fada2818000] using cpu capabilities: MMX2 SSE2Fast SSSE3 SSE4.<span class="number">2</span> AVX</span><br><span class="line">[libx264 @ <span class="number">0</span>x7fada2818000] profile High, level <span class="number">2.1</span></span><br><span class="line">[libx264 @ <span class="number">0</span>x7fada2818000] <span class="number">264</span> - core <span class="number">144</span> r2533 c8a773e - H.<span class="number">264</span>/MPEG-<span class="number">4</span> AVC codec - Copyleft <span class="number">2003</span>-<span class="number">2015</span> - http://www.videolan.org/x264.html - options: <span class="attr">cabac=1</span> <span class="attr">ref=3</span> <span class="attr">deblock=1:0:0</span> <span class="attr">analyse=0x3:0x113</span> <span class="attr">me=hex</span> <span class="attr">subme=7</span> <span class="attr">psy=1</span> <span class="attr">psy_rd=1.00:0.00</span> <span class="attr">mixed_ref=1</span> <span class="attr">me_range=16</span> <span class="attr">chroma_me=1</span> <span class="attr">trellis=1</span> <span class="number">8</span><span class="attr">x8dct=1</span> <span class="attr">cqm=0</span> <span class="attr">deadzone=21,11</span> <span class="attr">fast_pskip=1</span> <span class="attr">chroma_qp_offset=-2</span> <span class="attr">threads=6</span> <span class="attr">lookahead_threads=1</span> <span class="attr">sliced_threads=0</span> <span class="attr">nr=0</span> <span class="attr">decimate=1</span> <span class="attr">interlaced=0</span> <span class="attr">bluray_compat=0</span> <span class="attr">constrained_intra=0</span> <span class="attr">bframes=3</span> <span class="attr">b_pyramid=2</span> <span class="attr">b_adapt=1</span> <span class="attr">b_bias=0</span> <span class="attr">direct=1</span> <span class="attr">weightb=1</span> <span class="attr">open_gop=0</span> <span class="attr">weightp=2</span> <span class="attr">keyint=250</span> <span class="attr">keyint_min=15</span> <span class="attr">scenecut=40</span> <span class="attr">intra_refresh=0</span> <span class="attr">rc_lookahead=40</span> <span class="attr">rc=crf</span> <span class="attr">mbtree=1</span> <span class="attr">crf=23.0</span> <span class="attr">qcomp=0.60</span> <span class="attr">qpmin=0</span> <span class="attr">qpmax=69</span> <span class="attr">qpstep=4</span> <span class="attr">ip_ratio=1.40</span> <span class="attr">aq=1:1.00</span></span><br><span class="line">Output <span class="comment">#0, mp4, to '2015-09-17.mp4':</span></span><br><span class="line">  Metadata:</span><br><span class="line">    encoder         : Lavf56.<span class="number">25.101</span></span><br><span class="line">    Stream <span class="comment">#0:0: Video: h264 (libx264) ([33][0][0][0] / 0x0021), yuv420p, 480x360, q=-1--1, 15 fps, 15360 tbn, 15 tbc</span></span><br><span class="line">    Metadata:</span><br><span class="line">      encoder         : Lavc56.<span class="number">26.100</span> libx264</span><br><span class="line">Stream mapping:</span><br><span class="line">  Stream <span class="comment">#0:0 -&gt; #0:0 (h264 (native) -&gt; h264 (libx264))</span></span><br><span class="line">Press [q] to stop, [?] for help</span><br><span class="line"><span class="attr">frame=</span>   <span class="number">64</span> <span class="attr">fps=0.0</span> <span class="attr">q=27.0</span> <span class="attr">size=</span>      <span class="number">60</span>kB <span class="attr">time=00:00:00.80</span> <span class="attr">bitrate=</span> <span class="number">609.7</span>kbits/s   <span class="attr">frame=</span>   <span class="number">87</span> <span class="attr">fps=</span> <span class="number">85</span> <span class="attr">q=27.0</span> <span class="attr">size=</span>     <span class="number">187</span>kB <span class="attr">time=00:00:02.33</span> <span class="attr">bitrate=</span> <span class="number">655.2</span>kbits/s   <span class="attr">frame=</span>  <span class="number">120</span> <span class="attr">fps=</span> <span class="number">77</span> <span class="attr">q=27.0</span> <span class="attr">size=</span>     <span class="number">366</span>kB <span class="attr">time=00:00:04.53</span> <span class="attr">bitrate=</span> <span class="number">661.5</span>kbits/s   <span class="attr">frame=</span>  <span class="number">149</span> <span class="attr">fps=</span> <span class="number">72</span> <span class="attr">q=27.0</span> <span class="attr">size=</span>     <span class="number">444</span>kB <span class="attr">time=00:00:06.46</span> <span class="attr">bitrate=</span> <span class="number">562.4</span>kbits/s   <span class="attr">frame=</span>  <span class="number">178</span> <span class="attr">fps=</span> <span class="number">69</span> <span class="attr">q=27.0</span> <span class="attr">size=</span>     <span class="number">508</span>kB <span class="attr">time=00:00:08.40</span> <span class="attr">bitrate=</span> <span class="number">495.4</span>kbits/s   <span class="attr">frame=</span>  <span class="number">196</span> <span class="attr">fps=</span> <span class="number">56</span> <span class="attr">q=-1.0</span> <span class="attr">Lsize=</span>     <span class="number">651</span>kB <span class="attr">time=00:00:12.93</span> <span class="attr">bitrate=</span> <span class="number">412.2</span>kbits/s    </span><br><span class="line">video:<span class="number">648</span>kB audio:<span class="number">0</span>kB subtitle:<span class="number">0</span>kB other streams:<span class="number">0</span>kB global headers:<span class="number">0</span>kB muxing overhead: <span class="number">0.389284</span>%</span><br><span class="line">[libx264 @ <span class="number">0</span>x7fada2818000] frame I:<span class="number">2</span>     Avg QP:<span class="number">20.10</span>  size:  <span class="number">5888</span></span><br><span class="line">[libx264 @ <span class="number">0</span>x7fada2818000] frame P:<span class="number">126</span>   Avg QP:<span class="number">22.22</span>  size:  <span class="number">4340</span></span><br><span class="line">[libx264 @ <span class="number">0</span>x7fada2818000] frame B:<span class="number">68</span>    Avg QP:<span class="number">23.94</span>  size:  <span class="number">1537</span></span><br><span class="line">[libx264 @ <span class="number">0</span>x7fada2818000] consecutive B-frames: <span class="number">43.9</span>% <span class="number">27.6</span>%  <span class="number">6.1</span>% <span class="number">22.4</span>%</span><br><span class="line">[libx264 @ <span class="number">0</span>x7fada2818000] mb I  I16..<span class="number">4</span>: <span class="number">31.4</span>% <span class="number">51.4</span>% <span class="number">17.2</span>%</span><br><span class="line">[libx264 @ <span class="number">0</span>x7fada2818000] mb P  I16..<span class="number">4</span>:  <span class="number">8.6</span>% <span class="number">10.2</span>%  <span class="number">4.6</span>%  P16..<span class="number">4</span>: <span class="number">46.2</span>% <span class="number">11.9</span>%  <span class="number">4.2</span>%  <span class="number">0.0</span>%  <span class="number">0.0</span>%    skip:<span class="number">14.2</span>%</span><br><span class="line">[libx264 @ <span class="number">0</span>x7fada2818000] mb B  I16..<span class="number">4</span>:  <span class="number">1.1</span>%  <span class="number">0.6</span>%  <span class="number">0.6</span>%  B16..<span class="number">8</span>: <span class="number">52.3</span>%  <span class="number">4.9</span>%  <span class="number">0.8</span>%  direct: <span class="number">3.2</span>%  skip:<span class="number">36.5</span>%  L0:<span class="number">51.0</span>% L1:<span class="number">45.1</span>% BI: <span class="number">3.9</span>%</span><br><span class="line">[libx264 @ <span class="number">0</span>x7fada2818000] <span class="number">8</span>x8 transform intra:<span class="number">43.2</span>% inter:<span class="number">63.2</span>%</span><br><span class="line">[libx264 @ <span class="number">0</span>x7fada2818000] coded y,uvDC,uvAC intra: <span class="number">42.6</span>% <span class="number">57.1</span>% <span class="number">10.4</span>% inter: <span class="number">19.2</span>% <span class="number">28.2</span>% <span class="number">0.7</span>%</span><br><span class="line">[libx264 @ <span class="number">0</span>x7fada2818000] i16 v,h,dc,p: <span class="number">20</span>% <span class="number">51</span>% <span class="number">10</span>% <span class="number">19</span>%</span><br><span class="line">[libx264 @ <span class="number">0</span>x7fada2818000] i8 v,h,dc,ddl,ddr,vr,hd,vl,hu: <span class="number">24</span>% <span class="number">38</span>% <span class="number">22</span>%  <span class="number">2</span>%  <span class="number">2</span>%  <span class="number">2</span>%  <span class="number">4</span>%  <span class="number">2</span>%  <span class="number">5</span>%</span><br><span class="line">[libx264 @ <span class="number">0</span>x7fada2818000] i4 v,h,dc,ddl,ddr,vr,hd,vl,hu: <span class="number">21</span>% <span class="number">43</span>% <span class="number">12</span>%  <span class="number">3</span>%  <span class="number">3</span>%  <span class="number">3</span>%  <span class="number">6</span>%  <span class="number">4</span>%  <span class="number">5</span>%</span><br><span class="line">[libx264 @ <span class="number">0</span>x7fada2818000] i8c dc,h,v,p: <span class="number">51</span>% <span class="number">32</span>% <span class="number">14</span>%  <span class="number">3</span>%</span><br><span class="line">[libx264 @ <span class="number">0</span>x7fada2818000] Weighted P-Frames: Y:<span class="number">7.1</span>% UV:<span class="number">5.6</span>%</span><br><span class="line">[libx264 @ <span class="number">0</span>x7fada2818000] ref P L0: <span class="number">78.9</span>% <span class="number">10.4</span>%  <span class="number">8.3</span>%  <span class="number">2.3</span>%  <span class="number">0.1</span>%</span><br><span class="line">[libx264 @ <span class="number">0</span>x7fada2818000] ref B L0: <span class="number">93.9</span>%  <span class="number">5.6</span>%  <span class="number">0.5</span>%</span><br><span class="line">[libx264 @ <span class="number">0</span>x7fada2818000] ref B L1: <span class="number">96.2</span>%  <span class="number">3.8</span>%</span><br><span class="line">[libx264 @ <span class="number">0</span>x7fada2818000] kb/s:<span class="number">405.98</span></span><br></pre></td></tr></table></figure><p>到此，h264文件封装为.mp4格式的过程结束。</p><p>查看2015-09-17.mp4 文件，如图</p><p><img src="http://images2015.cnblogs.com/blog/719115/201509/719115-20150924200951959-1409932132.png" alt="mp4文件详情"></p><p>2015-09-17.mp4 文件可以使用Quick Time Player，VLC 正常播放。</p><ul><li>2015-09-17.mp4 文件的下载地址为：<a href="https://github.com/depthlove/test-files/blob/master/2015-09-17.mp4" target="_blank" rel="noopener">2015-09-17.mp4</a></li><li>2015-09-17 18:05:20.h264 文件的下载地址为：<a href="https://github.com/depthlove/X264-Encode-for-iOS/blob/master/myRecordH264Vieo/2015-09-17%2018:05:20.h264" target="_blank" rel="noopener">2015-09-17 18:05:20.h264</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> 音视频处理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>采用工具软件分析h264文件</title>
      <link href="/2015/09/23/use-tool-to-analyze-h264-file/"/>
      <url>/2015/09/23/use-tool-to-analyze-h264-file/</url>
      
        <content type="html"><![CDATA[<p>　　通过文章<a href="https://depthlove.github.io/2015/09/17/use-x264-encode-iOS-camera-video-to-h264/">利用x264将iOS摄像头实时视频流编码为h264文件</a> 和 <a href="https://depthlove.github.io/2015/09/18/use-ffmpeg-and-x264-encode-iOS-camera-video-to-h264/">利用FFmpeg+x264将iOS摄像头实时视频流编码为h264文件</a>，实现了如何采集实时视频流并压缩为h264编码格式的文件。对于采集到h264文件，里面究竟有些什么，下面就通过工具软件来一探究竟。</p><ul><li><p>采用文章<a href="https://depthlove.github.io/2015/09/17/use-x264-encode-iOS-camera-video-to-h264/">利用x264将iOS摄像头实时视频流编码为h264文件</a>配套工程<a href="https://github.com/depthlove/X264-Encode-for-iOS" target="_blank" rel="noopener">X264-Encode-for-iOS</a>中的h264文件，该文件地址为<a href="https://github.com/depthlove/X264-Encode-for-iOS/blob/master/myRecordH264Vieo/2015-09-17%2018:05:20.h264" target="_blank" rel="noopener">2015-09-17 18:05:20.h264</a></p></li><li><p>工具软件 UITraEdit</p></li></ul><a id="more"></a><p>　　H.264 的基本流（elementary stream,ES）的结构分为两层，包括视频编码层（VCL）和网络适配层（NAL）。视频编码层负责高效的视频内容表示，而网络适配层负责以网络所要求的恰当的方式对数据进行打包和传送。引入NAL并使之与VCL分离带来的好处包括两方面：其一、使信号处理和网络传输分离，VCL 和NAL 可以在不同的处理平台上实现；其二、VCL 和NAL 分离设计，使得在不同的网络环境内，网关不需要因为网络环境不同而对VCL比特流进行重构和重编码。</p><p>　　H.264 的基本流由一系列NALU （Network Abstraction Layer Unit ）组成，不同的NALU数据量各不相同。H.264 草案指出，当数据流是储存在介质上时，<strong>在每个NALU 前添加起始码：0x000001 或 0x00000001，用来指示一个NALU 的起始和终止位置</strong>。在这样的机制下，在码流中检测起始码，作为一个NALU得起始标识，当检测到下一个起始码时，当前NALU结束。</p><p>　　<strong>H.264 码流中每个帧的开头的3~4个字节是H.264 的start_code（起始码），0x00000001或者0x000001。3字节的0x000001只有一种场合下使用，就是一个完整的帧被编为多个slice（片）的时候，包含这些slice的NALU 使用3字节起始码。其余场合都是4字节0x00000001的。</strong></p><p>　　每个NALU单元由一个字节的 NALU头（NALU Header）和若干个字节的载荷数据（RBSP）组成。其中NALU 头的格式如图所示：</p><p><img src="http://images2015.cnblogs.com/blog/719115/201509/719115-20150923173814084-917352993.png" alt="img"></p><p> <strong>NALU头结构</strong></p><p>长度：1byte</p><p>forbidden_bit(1bit) + nal_reference_bit(2bit) + nal_unit_type(5bit)</p><ul><li><p>F：forbidden_zero_bit.1 位，如果有语法冲突，则为 1。当网络识别此单元存在比特错误时，可将其设为 1，以便接收方丢掉该单元。 </p></li><li><p>NRI：nal_ref_idc.2 位，用来指示该NALU 的重要性等级。值越大，表示当前NALU越重要。具体大于0 时取何值，没有具体规定。</p></li><li><p>Type：5 位，指出NALU 的类型。</p></li></ul><p>h264中NALU类型取值如下图(图片来至《新一代视频压缩编码标准H.264》)</p><p><img src="http://my.csdn.net/uploads/201205/11/1336727471_3857.png" alt="nal单元类型图"></p><p>　　将 <a href="https://github.com/depthlove/X264-Encode-for-iOS/blob/master/myRecordH264Vieo/2015-09-17%2018:05:20.h264" target="_blank" rel="noopener">2015-09-17 18:05:20.h264</a> 文件用UITraEdit打开，效果如下图</p><p><img src="http://images2015.cnblogs.com/blog/719115/201509/719115-20150923160926115-439296052.png" alt="img"></p><p>　　由于数据量较大，我挑选了其中3段数据来分析。</p><h3 id="分析第一段数据："><a href="#分析第一段数据：" class="headerlink" title="分析第一段数据："></a><strong>分析第一段数据：</strong></h3><p><img src="http://images2015.cnblogs.com/blog/719115/201509/719115-20150923170442975-1838666657.png" alt="img"></p><ul><li><h4 id="00-00-00-01-67"><a href="#00-00-00-01-67" class="headerlink" title="00 00 00 01 67"></a><strong>00 00 00 01 67</strong></h4></li></ul><p><strong>00 00 00 01</strong> 为NALU的起始标志。</p><p><strong>00 00 00 01</strong> 后面的 67 为前面说的占1个字节的NALU头。将十六进制的67转换为二进制，得 <strong>0110 0111</strong>。</p><table><thead><tr><th>字段</th><th>所占bit位数</th><th>二进制</th><th>十进制</th><th>类型</th></tr></thead><tbody><tr><td>forbidden_bit</td><td>1</td><td>0</td><td>0</td><td></td></tr><tr><td>nal_reference_bit</td><td>2</td><td>11</td><td>3</td><td>NALU 的重要性等级系数</td></tr><tr><td>nal_unit_type</td><td>5</td><td>00111</td><td>7</td><td>序列参数集，sps</td></tr></tbody></table><ul><li><h4 id="00-00-00-01-68"><a href="#00-00-00-01-68" class="headerlink" title="00 00 00 01 68"></a><strong>00 00 00 01 68</strong></h4></li></ul><p><strong>00 00 00 01</strong> 为NALU的起始标志。</p><p><strong>00 00 00 01</strong> 后面的 68 为前面说的占1个字节的NALU头。将十六进制的68转换为二进制，得 <strong>0110 1000</strong>。</p><table><thead><tr><th>字段</th><th>所占bit位数</th><th>二进制</th><th>十进制</th><th>类型</th></tr></thead><tbody><tr><td>forbidden_bit</td><td>1</td><td>0</td><td>0</td><td></td></tr><tr><td>nal_reference_bit</td><td>2</td><td>11</td><td>3</td><td>NALU 的重要性等级系数</td></tr><tr><td>nal_unit_type</td><td>5</td><td>01000</td><td>8</td><td>图像参数集，pps</td></tr></tbody></table><ul><li><h4 id="00-00-03-00"><a href="#00-00-03-00" class="headerlink" title="00 00 03 00"></a><strong>00 00 03 00</strong></h4></li></ul><p>　　H.264规定，当检测到0x000000时，也可以表征当前NAL的结束。那么NAL中数据出现0x000001或0x000000时怎么办？H.264引入了防止竞争机制，如果编码器检测到NAL数据存在0x000001或0x000000时，编码器会在最后个字节前插入一个新的字节0x03，这样：</p><p>0x000000－&gt;0x00000300</p><p>0x000001－&gt;0x00000301</p><p>0x000002－&gt;0x00000302</p><p>0x000003－&gt;0x00000303</p><p>　　解码器检测到0x000003时，把03抛弃，恢复原始数据（脱壳操作）。解码器在解码时，首先逐个字节读取NAL的数据，统计NAL的长度，然后再开始解码。</p><h3 id="分析第二段数据："><a href="#分析第二段数据：" class="headerlink" title="分析第二段数据："></a><strong>分析第二段数据：</strong></h3><p><img src="http://images2015.cnblogs.com/blog/719115/201509/719115-20150924095706865-430226903.png" alt="img"></p><ul><li><h4 id="00-00-00-01-65-或-00-00-01-65"><a href="#00-00-00-01-65-或-00-00-01-65" class="headerlink" title="00 00 00 01 65 或 00 00 01 65"></a><strong>00 00 00 01 65</strong> 或 <strong>00 00 01 65</strong></h4></li></ul><p><strong>00 00 00 01</strong> 或 <strong>00 00 01</strong> 为NALU的起始标志。</p><p><strong>00 00 00 01</strong> 或 <strong>00 00 01</strong> 后面的 65 为前面说的占1个字节的NALU头。将十六进制的65转换为二进制，得 <strong>0110 0101</strong>。</p><table><thead><tr><th>字段</th><th>所占bit位数</th><th>二进制</th><th>十进制</th><th>类型</th></tr></thead><tbody><tr><td>forbidden_bit</td><td>1</td><td>0</td><td>0</td><td></td></tr><tr><td>nal_reference_bit</td><td>2</td><td>11</td><td>3</td><td>NALU 的重要性等级系数</td></tr><tr><td>nal_unit_type</td><td>5</td><td>00101</td><td>5</td><td>IDR图像中的片</td></tr></tbody></table><p>IDR图像中的片，即 I帧。</p><p>　　我在用UITraEdit打开的<a href="https://github.com/depthlove/X264-Encode-for-iOS/blob/master/myRecordH264Vieo/2015-09-17%2018:05:20.h264" target="_blank" rel="noopener">2015-09-17 18:05:20.h264</a>文件中搜索 00 00 00 01 65，没有找到该标志。搜索 00 00 01 65，存在该标志，说明一个完整的帧被编为多个slice（片）。</p><h3 id="分析第三段数据："><a href="#分析第三段数据：" class="headerlink" title="分析第三段数据："></a><strong>分析第三段数据：</strong></h3><p><img src="http://images2015.cnblogs.com/blog/719115/201509/719115-20150923170450522-678610212.png" alt="img"></p><ul><li><h4 id="00-00-00-01-41"><a href="#00-00-00-01-41" class="headerlink" title="00 00 00 01 41"></a><strong>00 00 00 01 41</strong></h4></li></ul><p><strong>00 00 00 01</strong> 为NALU的起始标志。</p><p><strong>00 00 00 01</strong> 后面的 41 为前面说的占1个字节的NALU头。将十六进制的41转换为二进制，得 <strong>0100 0001</strong>。</p><table><thead><tr><th>字段</th><th>所占bit位数</th><th>二进制</th><th>十进制</th><th>类型</th></tr></thead><tbody><tr><td>forbidden_bit</td><td>1</td><td>0</td><td>0</td><td></td></tr><tr><td>nal_reference_bit</td><td>2</td><td>10</td><td>2</td><td>NALU 的重要性等级系数</td></tr><tr><td>nal_unit_type</td><td>5</td><td>00001</td><td>1</td><td>不分区，非IDR图像的片</td></tr></tbody></table><p>在baseline的档次中nal_unit_type表示的就是P帧，因为baseline没有B帧。</p><p>　　以上，就是对H264的结构和机制的一些分析。</p><ul><li>扩展阅读：</li></ul><p><a href="http://blog.csdn.net/yangzhongxuan/article/details/8003504" target="_blank" rel="noopener">H264–1–编码原理以及I帧B帧P帧 </a></p><p><a href="http://blog.csdn.net/yangzhongxuan/article/details/8003494" target="_blank" rel="noopener"> H264–2–语法及结构 </a></p>]]></content>
      
      
      
        <tags>
            
            <tag> 音视频处理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>利用FFmpeg+x264将iOS摄像头实时视频流编码为h264文件</title>
      <link href="/2015/09/18/use-ffmpeg-and-x264-encode-iOS-camera-video-to-h264/"/>
      <url>/2015/09/18/use-ffmpeg-and-x264-encode-iOS-camera-video-to-h264/</url>
      
        <content type="html"><![CDATA[<h3 id="一、编译x264库"><a href="#一、编译x264库" class="headerlink" title="一、编译x264库"></a>一、编译x264库</h3><p>如何编译x264源码获取支持iOS平台的静态库，可参考我的文章<a href="https://depthlove.github.io/2015/09/16/build-X264-library-for-iOS-platform/">《编译iOS平台上使用的X264库》</a></p><h3 id="二、编译FFmpeg库"><a href="#二、编译FFmpeg库" class="headerlink" title="二、编译FFmpeg库"></a>二、编译FFmpeg库</h3><p>如何编译FFmpeg源码获取支持iOS平台的静态库，可参考我的博客园上的文章<a href="http://www.cnblogs.com/sunminmin/p/4463741.html#3195954" target="_blank" rel="noopener">《实战FFmpeg－－编译iOS平台使用的FFmpeg库（支持arm64的FFmpeg2.6.2）》</a></p><h3 id="三、将x264库编译进FFmpeg库"><a href="#三、将x264库编译进FFmpeg库" class="headerlink" title="三、将x264库编译进FFmpeg库"></a>三、将x264库编译进FFmpeg库</h3><p>通过步骤二，知道了如何编译FFmpeg库，但是要在FFmpeg中使用x264进行h264编码，还需要修改步骤二中的脚本。</p><p>步骤二中，使用的脚本的下载地址为：<a href="https://github.com/kewlbear/FFmpeg-iOS-build-script" target="_blank" rel="noopener">build-ffmpeg.sh</a></p><p>现在，FFmpeg的最新版本是 2.8，iOS系统的最新版本是 iOS 9.0.2，Xcode 最新版本是 Xcode 7.0.1，从 Xcode 7.0 开始支持 bitcode 选项了，bitcode 是什么，在百度上搜一搜就知道了。</p><a id="more"></a><p>看一看从下载地址获取的脚本，脚本内容如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># directories</span></span><br><span class="line">SOURCE=<span class="string">"ffmpeg-2.8"</span></span><br><span class="line">FAT=<span class="string">"FFmpeg-iOS"</span></span><br><span class="line"></span><br><span class="line">SCRATCH=<span class="string">"scratch"</span></span><br><span class="line"><span class="comment"># must be an absolute path</span></span><br><span class="line">THIN=`<span class="built_in">pwd</span>`/<span class="string">"thin"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># absolute path to x264 library</span></span><br><span class="line"><span class="comment">#X264=`pwd`/fat-x264</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#FDK_AAC=`pwd`/fdk-aac/fdk-aac-ios</span></span><br><span class="line"></span><br><span class="line">CONFIGURE_FLAGS=<span class="string">"--enable-cross-compile --disable-debug --disable-programs \</span></span><br><span class="line"><span class="string">                 --disable-doc --enable-pic"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ <span class="string">"<span class="variable">$X264</span>"</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">CONFIGURE_FLAGS=<span class="string">"<span class="variable">$CONFIGURE_FLAGS</span> --enable-gpl --enable-libx264"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ <span class="string">"<span class="variable">$FDK_AAC</span>"</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">CONFIGURE_FLAGS=<span class="string">"<span class="variable">$CONFIGURE_FLAGS</span> --enable-libfdk-aac"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># avresample</span></span><br><span class="line"><span class="comment">#CONFIGURE_FLAGS="$CONFIGURE_FLAGS --enable-avresample"</span></span><br><span class="line"></span><br><span class="line">ARCHS=<span class="string">"arm64 armv7 x86_64 i386"</span></span><br><span class="line"></span><br><span class="line">COMPILE=<span class="string">"y"</span></span><br><span class="line">LIPO=<span class="string">"y"</span></span><br><span class="line"></span><br><span class="line">DEPLOYMENT_TARGET=<span class="string">"6.0"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ <span class="string">"$*"</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="string">"$*"</span> = <span class="string">"lipo"</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line"><span class="comment"># skip compile</span></span><br><span class="line">COMPILE=</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">ARCHS=<span class="string">"$*"</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$#</span> -eq 1 ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line"><span class="comment"># skip lipo</span></span><br><span class="line">LIPO=</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ <span class="string">"<span class="variable">$COMPILE</span>"</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line"><span class="keyword">if</span> [ ! `<span class="built_in">which</span> yasm` ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">'Yasm not found'</span></span><br><span class="line"><span class="keyword">if</span> [ ! `<span class="built_in">which</span> brew` ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">'Homebrew not found. Trying to install...'</span></span><br><span class="line">                        ruby -e <span class="string">"<span class="variable">$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)</span>"</span> \</span><br><span class="line">|| <span class="built_in">exit</span> 1</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">'Trying to install Yasm...'</span></span><br><span class="line">brew install yasm || <span class="built_in">exit</span> 1</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="keyword">if</span> [ ! `<span class="built_in">which</span> gas-preprocessor.pl` ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">'gas-preprocessor.pl not found. Trying to install...'</span></span><br><span class="line">(curl -L https://github.com/libav/gas-preprocessor/raw/master/gas-preprocessor.pl \</span><br><span class="line">-o /usr/<span class="built_in">local</span>/bin/gas-preprocessor.pl \</span><br><span class="line">&amp;&amp; chmod +x /usr/<span class="built_in">local</span>/bin/gas-preprocessor.pl) \</span><br><span class="line">|| <span class="built_in">exit</span> 1</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ ! -r <span class="variable">$SOURCE</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">'FFmpeg source not found. Trying to download...'</span></span><br><span class="line">curl http://www.ffmpeg.org/releases/<span class="variable">$SOURCE</span>.tar.bz2 | tar xj \</span><br><span class="line">|| <span class="built_in">exit</span> 1</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">CWD=`<span class="built_in">pwd</span>`</span><br><span class="line"><span class="keyword">for</span> ARCH <span class="keyword">in</span> <span class="variable">$ARCHS</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"building <span class="variable">$ARCH</span>..."</span></span><br><span class="line">mkdir -p <span class="string">"<span class="variable">$SCRATCH</span>/<span class="variable">$ARCH</span>"</span></span><br><span class="line"><span class="built_in">cd</span> <span class="string">"<span class="variable">$SCRATCH</span>/<span class="variable">$ARCH</span>"</span></span><br><span class="line"></span><br><span class="line">CFLAGS=<span class="string">"-arch <span class="variable">$ARCH</span>"</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="string">"<span class="variable">$ARCH</span>"</span> = <span class="string">"i386"</span> -o <span class="string">"<span class="variable">$ARCH</span>"</span> = <span class="string">"x86_64"</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">    PLATFORM=<span class="string">"iPhoneSimulator"</span></span><br><span class="line">    CFLAGS=<span class="string">"<span class="variable">$CFLAGS</span> -mios-simulator-version-min=<span class="variable">$DEPLOYMENT_TARGET</span>"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    PLATFORM=<span class="string">"iPhoneOS"</span></span><br><span class="line">    CFLAGS=<span class="string">"<span class="variable">$CFLAGS</span> -mios-version-min=<span class="variable">$DEPLOYMENT_TARGET</span> -fembed-bitcode"</span></span><br><span class="line">    <span class="keyword">if</span> [ <span class="string">"<span class="variable">$ARCH</span>"</span> = <span class="string">"arm64"</span> ]</span><br><span class="line">    <span class="keyword">then</span></span><br><span class="line">        EXPORT=<span class="string">"GASPP_FIX_XCODE5=1"</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">XCRUN_SDK=`<span class="built_in">echo</span> <span class="variable">$PLATFORM</span> | tr <span class="string">'[:upper:]'</span> <span class="string">'[:lower:]'</span>`</span><br><span class="line">CC=<span class="string">"xcrun -sdk <span class="variable">$XCRUN_SDK</span> clang"</span></span><br><span class="line">CXXFLAGS=<span class="string">"<span class="variable">$CFLAGS</span>"</span></span><br><span class="line">LDFLAGS=<span class="string">"<span class="variable">$CFLAGS</span>"</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="string">"<span class="variable">$X264</span>"</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">CFLAGS=<span class="string">"<span class="variable">$CFLAGS</span> -I<span class="variable">$X264</span>/include"</span></span><br><span class="line">LDFLAGS=<span class="string">"<span class="variable">$LDFLAGS</span> -L<span class="variable">$X264</span>/lib"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="string">"<span class="variable">$FDK_AAC</span>"</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">CFLAGS=<span class="string">"<span class="variable">$CFLAGS</span> -I<span class="variable">$FDK_AAC</span>/include"</span></span><br><span class="line">LDFLAGS=<span class="string">"<span class="variable">$LDFLAGS</span> -L<span class="variable">$FDK_AAC</span>/lib"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">TMPDIR=<span class="variable">$&#123;TMPDIR/%\/&#125;</span> <span class="variable">$CWD</span>/<span class="variable">$SOURCE</span>/configure \</span><br><span class="line">    --target-os=darwin \</span><br><span class="line">    --arch=<span class="variable">$ARCH</span> \</span><br><span class="line">    --cc=<span class="string">"<span class="variable">$CC</span>"</span> \</span><br><span class="line">    <span class="variable">$CONFIGURE_FLAGS</span> \</span><br><span class="line">    --extra-cflags=<span class="string">"<span class="variable">$CFLAGS</span>"</span> \</span><br><span class="line">    --extra-ldflags=<span class="string">"<span class="variable">$LDFLAGS</span>"</span> \</span><br><span class="line">    --prefix=<span class="string">"<span class="variable">$THIN</span>/<span class="variable">$ARCH</span>"</span> \</span><br><span class="line">|| <span class="built_in">exit</span> 1</span><br><span class="line"></span><br><span class="line">make -j3 install <span class="variable">$EXPORT</span> || <span class="built_in">exit</span> 1</span><br><span class="line"><span class="built_in">cd</span> <span class="variable">$CWD</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ <span class="string">"<span class="variable">$LIPO</span>"</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"building fat binaries..."</span></span><br><span class="line">mkdir -p <span class="variable">$FAT</span>/lib</span><br><span class="line"><span class="built_in">set</span> - <span class="variable">$ARCHS</span></span><br><span class="line">CWD=`<span class="built_in">pwd</span>`</span><br><span class="line"><span class="built_in">cd</span> <span class="variable">$THIN</span>/<span class="variable">$1</span>/lib</span><br><span class="line"><span class="keyword">for</span> LIB <span class="keyword">in</span> *.a</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"><span class="built_in">cd</span> <span class="variable">$CWD</span></span><br><span class="line"><span class="built_in">echo</span> lipo -create `find <span class="variable">$THIN</span> -name <span class="variable">$LIB</span>` -output <span class="variable">$FAT</span>/lib/<span class="variable">$LIB</span> 1&gt;&amp;2</span><br><span class="line">lipo -create `find <span class="variable">$THIN</span> -name <span class="variable">$LIB</span>` -output <span class="variable">$FAT</span>/lib/<span class="variable">$LIB</span> || <span class="built_in">exit</span> 1</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">cd</span> <span class="variable">$CWD</span></span><br><span class="line">cp -rf <span class="variable">$THIN</span>/<span class="variable">$1</span>/include <span class="variable">$FAT</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> Done</span><br></pre></td></tr></table></figure><h4 id="三（一）、注意内容1"><a href="#三（一）、注意内容1" class="headerlink" title="三（一）、注意内容1"></a>三（一）、注意内容1</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># absolute path to x264 library</span></span><br><span class="line"><span class="comment">#X264=`pwd`/fat-x264</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#FDK_AAC=`pwd`/fdk-aac/fdk-aac-ios</span></span><br><span class="line"></span><br><span class="line">CONFIGURE_FLAGS=<span class="string">"--enable-cross-compile --disable-debug --disable-programs \</span></span><br><span class="line"><span class="string">                 --disable-doc --enable-pic"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ <span class="string">"<span class="variable">$X264</span>"</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">CONFIGURE_FLAGS=<span class="string">"<span class="variable">$CONFIGURE_FLAGS</span> --enable-gpl --enable-libx264"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ <span class="string">"<span class="variable">$FDK_AAC</span>"</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">CONFIGURE_FLAGS=<span class="string">"<span class="variable">$CONFIGURE_FLAGS</span> --enable-libfdk-aac"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># avresample</span></span><br><span class="line"><span class="comment">#CONFIGURE_FLAGS="$CONFIGURE_FLAGS --enable-avresample"</span></span><br></pre></td></tr></table></figure><p>要将x264编译进FFmpeg中，需要取消对该句代码的注销 </p><pre><code>X264=`pwd`/fat-x264</code></pre><p>即，</p><pre><code>#X264=`pwd`/fat-x264</code></pre><p>改为</p><pre><code>X264=`pwd`/fat-x264</code></pre><h4 id="三（二）、注意内容2"><a href="#三（二）、注意内容2" class="headerlink" title="三（二）、注意内容2"></a>三（二）、注意内容2</h4><p>经过步骤三（一）的修改后，在Mac终端执行FFmpeg，脚本的时候，可能会存在因为bitcode引起编译出错。</p><p>需要将脚本中</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">CFLAGS</span>=<span class="string">"<span class="variable">$CFLAGS</span> -mios-version-min=<span class="variable">$DEPLOYMENT_TARGET</span> -fembed-bitcode"</span></span><br></pre></td></tr></table></figure><p>修改为</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">CFLAGS</span>=<span class="string">"<span class="variable">$CFLAGS</span> -mios-version-min=<span class="variable">$DEPLOYMENT_TARGET</span>"</span></span><br></pre></td></tr></table></figure><h3 id="四、总结编译x264以及支持x264的FFmpeg的步骤"><a href="#四、总结编译x264以及支持x264的FFmpeg的步骤" class="headerlink" title="四、总结编译x264以及支持x264的FFmpeg的步骤"></a>四、总结编译x264以及支持x264的FFmpeg的步骤</h3><ol><li>编译得到 x264 静态库</li><li>将存放x264静态库（头文件，库文件）的文件夹名称改为 fat-x264 （因为编译FFmpeg的脚本中定义存放x264文件的文件夹名称为fat-x264，看步骤三（一）中的内容）</li><li>修改编译FFmpeg的脚本build-ffmpeg.sh，具体见步骤 三（一），三（二）</li><li>将编译FFmpeg的脚本build-ffmpeg.sh 与 fat-x264 存放到同一个目录下</li><li>在Mac终端执行脚本build-ffmpeg.sh</li><li>最后x264静态库，支持x264的FFmpeg静态库，内容如下</li></ol><p><img src="http://images2015.cnblogs.com/blog/719115/201510/719115-20151012182722241-1784823013.png" alt="x264静态库"></p><p><img src="http://images2015.cnblogs.com/blog/719115/201510/719115-20151012182739491-661413965.png" alt="FFmpeg静态库"></p><h3 id="五、获取iOS设备摄像头实时视频"><a href="#五、获取iOS设备摄像头实时视频" class="headerlink" title="五、获取iOS设备摄像头实时视频"></a>五、获取iOS设备摄像头实时视频</h3><h3 id="六，采用x264和FFmpeg对iOS实时视频流编码为h264"><a href="#六，采用x264和FFmpeg对iOS实时视频流编码为h264" class="headerlink" title="六，采用x264和FFmpeg对iOS实时视频流编码为h264"></a>六，采用x264和FFmpeg对iOS实时视频流编码为h264</h3><h3 id="七、完整的代码下载地址"><a href="#七、完整的代码下载地址" class="headerlink" title="七、完整的代码下载地址"></a>七、完整的代码下载地址</h3><p>采用FFmpeg+x264将iOS摄像头实时视频流编码为h264文件的工程的下载地址为：<a href="https://github.com/depthlove/FFmpeg-X264-Encode-for-iOS" target="_blank" rel="noopener">FFmpeg-X264-Encode-for-iOS</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> iOS </tag>
            
            <tag> 音视频处理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>利用x264将iOS摄像头实时视频流编码为h264文件</title>
      <link href="/2015/09/17/use-x264-encode-iOS-camera-video-to-h264/"/>
      <url>/2015/09/17/use-x264-encode-iOS-camera-video-to-h264/</url>
      
        <content type="html"><![CDATA[<p>代码见我的Github代码托管区域：<a href="https://github.com/depthlove/X264-Encode-for-iOS" target="_blank" rel="noopener">X264-Encode-for-iOS</a></p><a id="more"></a>]]></content>
      
      
      
        <tags>
            
            <tag> iOS </tag>
            
            <tag> 音视频处理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>编译iOS平台上使用的X264库</title>
      <link href="/2015/09/16/build-X264-library-for-iOS-platform/"/>
      <url>/2015/09/16/build-X264-library-for-iOS-platform/</url>
      
        <content type="html"><![CDATA[<p>　　x264是一种免费的、具有更优秀算法的符合H.264/MPEG-4 AVC视频压缩编码标准格式的编码库。它同xvid一样都是开源项目，但x264是采用H.264标准的，而xvid是采用MPEG-4早期标准的。由于H.264是2003年正式发布的最新的视频编码标准，因此，在通常情况下，x264压缩出的视频文件在相同质量下要比xvid压缩出的文件要小，或者也可以说，在相同体积下比xvid压缩出的文件质量要好。它符合GPL许可证。</p><p>　　从iOS8开始，苹果开放了硬解码和硬编码API，框架为 <strong>VideoToolbox.framework</strong>， 此框架需要在iOS8及以上的系统上才能使用。<br>　　此框架中的硬解码API是几个纯C函数，在任何OC或者 C++代码里都可以使用。使用的时候，首先，要把 VideoToolbox.framework 添加到工程里，并且在要使用该API的文件中包含头文件 <strong>#include &lt;VideoToolbox/VideoToolbox.h&gt;</strong>，然后，就可以畅快的高效的对视频流进行硬编码了。</p><a id="more"></a><p>　　其实至少从iPhone4开始，苹果就是支持硬件解码了，但是硬解码API框架<strong>VideoToolBox</strong>一直是私有API，如果调用这个私有库，那么app在必须在越狱的设备上运行，正常的App如果想提交到AppStore是不允许使用私有API的。</p><p>　　此处，不讨论iOS硬编解码框架<strong>VideoToolbox.framework</strong>的使用。现在，使用较多的h264编码工具还是X264开源库。要想在iOS平台上使用X264编码视频流，首先要知道如何编译运行在iOS上的X264静态库。</p><p>　　编译X264的一个靠谱的脚本为<a href="https://github.com/kewlbear/x264-ios" target="_blank" rel="noopener">https://github.com/kewlbear/x264-ios</a>，但是，使用该脚本有个不方便的，就是要先下载X264并解压好，同时要下载<a href="https://github.com/libav/gas-preprocessor" target="_blank" rel="noopener">https://github.com/libav/gas-preprocessor</a>并将gas-preprocessor.pl拷贝到/usr/local/bin/下，并且赋予管理员权限，才能启动脚本进行编译。</p><p>　　为了使用脚本一步到位得到X264静态库，我在该脚本的基础上做了一些修改。</p><h5 id="第一处修改："><a href="#第一处修改：" class="headerlink" title="第一处修改："></a>第一处修改：</h5><pre><code># sunminmin blog: http://depthlove.github.io/# modified by sunminmin, 2015/09/07#ARCHS=&quot;arm64 armv7s x86_64 i386 armv7&quot;ARCHS=&quot;arm64 x86_64 i386 armv7&quot;</code></pre><h5 id="第二处修改："><a href="#第二处修改：" class="headerlink" title="第二处修改："></a>第二处修改：</h5><pre><code># begin: added by sunminmin, 2015/09/07if [ ! -r $GAS_PREPROCESSOR ]thenecho &apos;gas-preprocessor.pl not found. Trying to install...&apos;(curl -L https://github.com/libav/gas-preprocessor/blob/master/gas-preprocessor.pl \-o /usr/local/bin/gas-preprocessor.pl \&amp;&amp; chmod +x /usr/local/bin/gas-preprocessor.pl) \|| exit 1fiif [ ! -r $SOURCE ]thenecho &apos;x264 source not found. Trying to download...&apos;curl https://download.videolan.org/pub/x264/snapshots/x264-snapshot-20140930-2245.tar.bz2 | tar xj &amp;&amp; ln -s x264-snapshot-20140930-2245 x264 || exit 1fi# end: added by sunminmin, 2015/09/07</code></pre><h5 id="第三处修改："><a href="#第三处修改：" class="headerlink" title="第三处修改："></a>第三处修改：</h5><pre><code># begin: added by sunminmin, 2015/09/07echo &quot;copy config.h to ...&quot;for ARCH in $ARCHSdocd $CWDecho &quot;copy $SCRATCH/$ARCH/config.h to $THIN/$ARCH/$include&quot;cp -rf $SCRATCH/$ARCH/config.h $THIN/$ARCH/$include || exit 1doneecho &quot;building success!&quot;# end: added by sunminmin, 2015/09/07</code></pre><p>　　<strong>修改后的脚本下载地址：<a href="https://github.com/depthlove/x264-iOS-build-script" target="_blank" rel="noopener">https://github.com/depthlove/x264-iOS-build-script</a></strong></p><p>　　<strong>原始脚本下载地址：<a href="https://github.com/kewlbear/x264-ios" target="_blank" rel="noopener">https://github.com/kewlbear/x264-ios</a></strong></p><p>　　后续文章后写如何使用x264库对iOS设备摄像头实时视频流进行h264软编码。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 音视频处理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>音视频传输解决方案</title>
      <link href="/2015/07/02/audio-video-transmission-plan/"/>
      <url>/2015/07/02/audio-video-transmission-plan/</url>
      
        <content type="html"><![CDATA[<h2 id="协议"><a href="#协议" class="headerlink" title="协议"></a>协议</h2><p>流媒体协议：RTSP（Real Time Streaming Protocol），RTMP（Real Time Messaging Protocol），HLS(http live streaming)</p><p>会话描述协议：SDP（Session Description Protocol）</p><p>实时传输控制协议：RTCP（Real-time Transport Control Protocol或RTP Control Protocol）</p><p>实时传输协议：RTP（Real-time Transport Protocol）</p><h2 id="流的类型"><a href="#流的类型" class="headerlink" title="流的类型"></a>流的类型</h2><p>流的类型：TS流，RTP流</p><a id="more"></a><h2 id="容器类型"><a href="#容器类型" class="headerlink" title="容器类型"></a>容器类型</h2><ul><li><h5 id="mp4"><a href="#mp4" class="headerlink" title=".mp4"></a>.mp4</h5></li></ul><h2 id="音频编解码格式"><a href="#音频编解码格式" class="headerlink" title="音频编解码格式"></a>音频编解码格式</h2><h2 id="视频编解码格式"><a href="#视频编解码格式" class="headerlink" title="视频编解码格式"></a>视频编解码格式</h2><h2 id="BSD-socket"><a href="#BSD-socket" class="headerlink" title="BSD socket"></a>BSD socket</h2><ul><li><h5 id="Introduction-to-BSD-Sockets"><a href="#Introduction-to-BSD-Sockets" class="headerlink" title="Introduction to BSD Sockets"></a><a href="http://wiki.treck.com/Introduction_to_BSD_Sockets" target="_blank" rel="noopener">Introduction to BSD Sockets</a></h5></li></ul><h2 id="知识点的维基百科解释"><a href="#知识点的维基百科解释" class="headerlink" title="知识点的维基百科解释"></a>知识点的维基百科解释</h2><p>维基百科：rtsp－<a href="https://en.wikipedia.org/wiki/Real_Time_Streaming_Protocol" target="_blank" rel="noopener">实时流协议</a></p><p>维基百科：rtmp－<a href="https://en.wikipedia.org/wiki/Real_Time_Messaging_Protocol" target="_blank" rel="noopener">实时消息传递协议</a></p><p>维基百科：HLS－<a href="https://en.wikipedia.org/wiki/HTTP_Live_Streaming" target="_blank" rel="noopener">HTTP实时流</a></p><p>维基百科：SDP－<a href="https://en.wikipedia.org/wiki/Session_Description_Protocol" target="_blank" rel="noopener">会话描述协议</a></p><p>维基百科：RTCP－<a href="https://zh.wikipedia.org/wiki/%E5%AE%9E%E6%97%B6%E4%BC%A0%E8%BE%93%E6%8E%A7%E5%88%B6%E5%8D%8F%E8%AE%AE" target="_blank" rel="noopener">实时传输控制协议</a></p><p>维基百科：RTP－<a href="https://zh.wikipedia.org/wiki/%E5%AE%9E%E6%97%B6%E4%BC%A0%E8%BE%93%E5%8D%8F%E8%AE%AE" target="_blank" rel="noopener">实时传输协议</a></p><p>维基百科：<a href="https://zh.wikipedia.org/wiki/Berkeley%E5%A5%97%E6%8E%A5%E5%AD%97" target="_blank" rel="noopener">BSD socket</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> 音视频处理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>硕士毕业一年的感受</title>
      <link href="/2015/07/01/feeling-of-OneYear-after-master-graduation/"/>
      <url>/2015/07/01/feeling-of-OneYear-after-master-graduation/</url>
      
        <content type="html"><![CDATA[<p>　　时间过的很快，转眼毕业一年了，去年的今天拿到硕士毕业证和庆祝毕业的场景在脑海中清晰可见。可是，时间就这么过去了。</p><p>　　在一个北方的城市，待了七年（2007～2014），自己从奔二的年纪跨越到奔三的年纪，想想觉得时间真的好可怕。在自己渴望成长的年龄段，父母变老了，弟弟妹妹们都已到了读大学的年纪，小外甥都上幼儿园了。现在回忆过去，我的感受是处在最美最纯的场景中的时候，却拼命的渴望摆脱这个单纯的生活，追求复杂而且功利的生活，眼前的美好却不曾珍惜。而今，处在自己曾今刻意追赶的生活中，不过是人生阶段必经的过程，可惜的是以往该放慢脚步体验生活的阶段再也回不去了。</p><p>　　深处在一个以学习就是为了找一份好工作，拿到高薪的大环境中，作为学生深受这种氛围的影响，变得唯利是图，变得焦躁不安，变得对未来恐慌，而不把握当下和珍惜当下最美的时光。对过去的追忆无外乎两种，一种是结合现在的处境反思以前的人生阶段的遗憾，一种是回想过去美好的记忆。是甜蜜是懊悔，只有当事人知道，毕竟个人的经历是独一无二的。</p><a id="more"></a><p>　　2011年本科毕业的时候，我说我不想家，可是自从读研之后，体验到人生滋味，家就是心灵休憩和疗伤的港湾，开始念家了。人生的每个阶段，都有其明显的特点，当明白这些道理的时候，可是已经从时间的长河中走过来了，想回去却再也回不去，明白又能怎样，最多向比自己小的弟弟妹妹们说，或者充当和下一辈人的经验之谈，但是这有什么用呢，他们不曾经历，听过或许就忘了。</p><p>　　现在，对于生活已经不做太多指望，最好的奋斗阶段过去了，奋斗的条件也不在。年龄决定了选择生活的范围。这就是为什么工作几年之后的人，激情不在，平平淡淡的原因。</p><p>　　对于在大学期间是否找对象这件事，我在学生期间计划是自己要读博士，很多未知的因素，没有生存能力，还是不谈为好。虽然，现在年纪不小了，有基本生存能力了，自己的心态，以及社会的因素，周围环境的变化，我选择顺其自然。我对自己的认识是，不喜欢强求别人，所谓的死缠烂打只会让自己显得无聊，没什么意思，也最烦这样的场面。</p><p>　　硕士毕业前就参加工作了，没有体会到一般学生能在暑假休息一段时间才上班的感觉，现在想来，毕业后的一段时间应该是调整心态，做好规划，休整疲惫身躯的好光阴。</p><p>　　过往似云烟，珍惜当下。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 生活 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>我对毕业生进大公司与小公司的看法</title>
      <link href="/2015/06/18/view-graduates-which-enter-the-large-companies-or-small-companies/"/>
      <url>/2015/06/18/view-graduates-which-enter-the-large-companies-or-small-companies/</url>
      
        <content type="html"><![CDATA[<p>　　2014年7月1日毕业，2014年4月23日第一天正式上班，1个半月就从试用期转正，到今天已经工作1年2个月了。工作了1年多，重新思考以前自己面对的问题，以前对毕业之后究竟要找一个什么样的公司很模糊，听到的是进大公司好，福利好，做颗小螺丝钉，小公司加班多，待遇差，锻炼人。究竟大公司与小公司对初入社会的毕业生今后的职业生涯与生存状态有多大影响？</p><p>　　小公司与大公司的直接明了的区别就是职员人数，几十个人的公司虽在业务经济效益上可能取胜人数上百的大公司，但是整个公司的建制体系跟数百人上千人的公司是无法比的。</p><a id="more"></a><p>　　我的第一份工作是在一家小型互联网公司，在小公司行为与装束可以随意，上班可以穿个拖鞋就啪啪啪的去公司开工了。若想在小公司开拓眼界以及技术的延伸，就不要指望公司的条件了，自个掏钱自个多关注信息。以前，总想着公司能请些牛人给我们做讲座，给我们充充电，或者希望公司能安排去参加一些好的讲座，这些在小公司简直就是自己在瞎想，不切实际。</p><p>　　对于小公司锻炼人这个说法，其实我并不认同，为什么能锻炼人，不就是公司在使用少的人力资源在员工上获取更大的回报。但是，员工收到利益上的回报有变化吗，没有。锻炼人，也是在员工花更多的私人时间泡在公司加班或在家加班的投入所致，这是投入大量时间之后，应有的收获。与小公司能锻炼人其实并无因果关系。小公司能发挥自己更大的能力，有更大的自由发挥空间？公司项目与业务的决策，一个小职员究竟有多大的份量，刚出来的毕业生懂得不多，几乎是不懂，就是想发挥也没地。</p><p>　　小公司做事的流程好吗？没有大公司复杂的流程，但面临的是上面的指令下达后，朝令夕改。这个对于程序员来说，实在是不堪重负的。在小公司天天见到老板，在大公司除了能看见或认识所在部门的一些人，其它部门的人基本就是陌生的，好像在另一个未知区域。</p><p>　　在大一点的公司里面做事，首先是格局与视野层面上对自己以后的发展有好处，其次，现在就职的公司就是以后跳槽或转行的平台，对加薪和升职影响很大。</p><p>　　非诚勿扰里面有句经典话语，“宁愿坐在宝马车上哭，也不愿坐在自行车上笑”，虽然这句对人的道德观和价值观有很大的扭曲，但是直接反映了这个社会的真实情况，作为工薪一族，“宁愿在大公司拼，也不愿在小公司做”，好的职业背景，带给自己的不仅仅是金钱上的优势，更有助于成就一番或大或小的事业。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 生活 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>帮助平台部解决重庆项目的bug</title>
      <link href="/2015/06/15/help-platform-department-to-solve-the-bug-of-chongqing-project/"/>
      <url>/2015/06/15/help-platform-department-to-solve-the-bug-of-chongqing-project/</url>
      
        <content type="html"><![CDATA[<p>　　属于网络研发部的我，职位是播放器开发工程师，主要工作是播放器库的开发与维护。今天，收到老大（网络研发部经理）的工作安排，帮助平台部iOS工程师做重庆的项目，为期十五天左右。</p><p>　　工作就是修项目的bug，好比接手烂尾工程紧急修复在规定的时间段完工。百分之九十的程序员，是不愿意看别人写的代码的，因为代码不规矩，看一句代码要吐槽N句。</p><a id="more"></a><p>　　既然接手了，就要完成工作，花了点时间看了质量部测试技术提交上来的bug反馈单，带着些疑问又与测试技术沟通了下，确定解决这些问题一个星期内可以完成。但是经过我亲自去测试这个项目的时候，bug远不止反馈单上的那么点，只能说写这个项目的人太渣了。</p><p>　　维修师傅，is me!</p>]]></content>
      
      
      
        <tags>
            
            <tag> 工作 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mac搭建hexo博客</title>
      <link href="/2015/06/12/use-hexo-create-blog-in-mac/"/>
      <url>/2015/06/12/use-hexo-create-blog-in-mac/</url>
      
        <content type="html"><![CDATA[<h2 id="一、安装git"><a href="#一、安装git" class="headerlink" title="一、安装git"></a>一、安装git</h2><h4 id="启动Mac终端，在终端执行命令"><a href="#启动Mac终端，在终端执行命令" class="headerlink" title="启动Mac终端，在终端执行命令"></a>启动Mac终端，在终端执行命令</h4><pre><code>ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&quot;brew install git</code></pre><h2 id="二、安装Node-js"><a href="#二、安装Node-js" class="headerlink" title="二、安装Node.js"></a>二、安装Node.js</h2><h4 id="nvm-Node-Version-Manager-，详见官方介绍：https-github-com-creationix-nvm-node-version-manager"><a href="#nvm-Node-Version-Manager-，详见官方介绍：https-github-com-creationix-nvm-node-version-manager" class="headerlink" title="nvm (Node Version Manager)，详见官方介绍：https://github.com/creationix/nvm#node-version-manager"></a>nvm (Node Version Manager)，详见官方介绍：<a href="https://github.com/creationix/nvm#node-version-manager" target="_blank" rel="noopener">https://github.com/creationix/nvm#node-version-manager</a></h4><a id="more"></a><p>在终端执行命令</p><pre><code>git clone git://github.com/creationix/nvm.git ~/.nvmcd /Users/dev.temobi/.nvm  （备注：/Users/dev.temobi/.nvm 是执行上一条命令的结果显示.nvm所在的路径）sh install.sh</code></pre><h4 id="补充说明：对于Mac系统而言，可以跳过步骤一、步骤二，直接去node-js官网https-nodejs-org-en-download下载软件，然后安装到Mac电脑上，node-js-就成功安装到了电脑上了，采用这种方法更简单，更直接。"><a href="#补充说明：对于Mac系统而言，可以跳过步骤一、步骤二，直接去node-js官网https-nodejs-org-en-download下载软件，然后安装到Mac电脑上，node-js-就成功安装到了电脑上了，采用这种方法更简单，更直接。" class="headerlink" title="补充说明：对于Mac系统而言，可以跳过步骤一、步骤二，直接去node.js官网https://nodejs.org/en/#download下载软件，然后安装到Mac电脑上，node.js 就成功安装到了电脑上了，采用这种方法更简单，更直接。"></a>补充说明：对于Mac系统而言，可以跳过步骤一、步骤二，直接去node.js官网<a href="https://nodejs.org/en/#download" target="_blank" rel="noopener">https://nodejs.org/en/#download</a>下载软件，然后安装到Mac电脑上，node.js 就成功安装到了电脑上了，采用这种方法更简单，更直接。</h4><h2 id="三、安装hexo"><a href="#三、安装hexo" class="headerlink" title="三、安装hexo"></a>三、安装hexo</h2><p>在终端执行命令</p><pre><code>npm install -g hexo</code></pre><h4 id="创建文件夹，根据自己实际情况，文件夹名可以任取，文件夹的路径可以选择你想放文件夹的路径。"><a href="#创建文件夹，根据自己实际情况，文件夹名可以任取，文件夹的路径可以选择你想放文件夹的路径。" class="headerlink" title="创建文件夹，根据自己实际情况，文件夹名可以任取，文件夹的路径可以选择你想放文件夹的路径。"></a>创建文件夹，根据自己实际情况，文件夹名可以任取，文件夹的路径可以选择你想放文件夹的路径。</h4><p>我创建的文件夹为 ZZ_HexoBlog，路径为 /Users/dev.temobi/Desktop/sunmmMainPrj/ZZ_HexoBlog</p><p>进入文件夹ZZ_HexoBlog所在路径，在终端执行命令</p><pre><code>cd /Users/dev.temobi/Desktop/sunmmMainPrj/ZZ_HexoBlog</code></pre><p>继续执行命令</p><pre><code>hexo initnpm install</code></pre><p>现在已经搭建起本地的hexo博客了。</p><p>执行命令</p><pre><code>hexo generatehexo server</code></pre><p>然后到浏览器输入 <a href="http://0.0.0.0:4000/" target="_blank" rel="noopener">http://0.0.0.0:4000/</a> 就可以预览博客了</p><h2 id="四、部署hexo博客到github"><a href="#四、部署hexo博客到github" class="headerlink" title="四、部署hexo博客到github"></a>四、部署hexo博客到github</h2><h4 id="在自己的github账号中创建Repository"><a href="#在自己的github账号中创建Repository" class="headerlink" title="在自己的github账号中创建Repository"></a>在自己的github账号中创建Repository</h4><p>Repository name需要符合username.github.io的命名规则。比如我的Github账号是depthlove，我就要创建名为depthlove.github.io 的仓库。</p><h4 id="获取自己的Repository地址"><a href="#获取自己的Repository地址" class="headerlink" title="获取自己的Repository地址"></a>获取自己的Repository地址</h4><p>我的为 <a href="https://github.com/depthlove/depthlove.github.io.git" target="_blank" rel="noopener">https://github.com/depthlove/depthlove.github.io.git</a></p><h4 id="修改-config-yml文件"><a href="#修改-config-yml文件" class="headerlink" title="修改_config.yml文件"></a>修改_config.yml文件</h4><p>在终端上执行命令 </p><pre><code>vim _config.yml</code></pre><p>找到 </p><pre><code>deploy:  type:</code></pre><p>修改为：</p><pre><code>deploy:     type: git     repo: https://github.com/depthlove/depthlove.github.io.git  branch: master</code></pre><p>保存退出</p><p>在终端执行命令 ls -al ~/.ssh，查看是否已经有SSH keys，如果之前在该电脑上使用过git管理过代码，结果是~/.ssh中会存在 id_rsa id_rsa.pub known_hosts 三个文件</p><p>在终端继续执行命令 </p><pre><code>ls -al ~/.ssh</code></pre><p>若之前没有使用过git，该目录就是空的。有用过git管理项目结果如下</p><pre><code>total 32drwx------   5 dev.temobi  staff   170  6  8 17:00 .drwxr-xr-x+ 69 dev.temobi  staff  2346  6 12 13:47 ..-rw-------   1 dev.temobi  staff  1675  6  8 16:46 id_rsa-rw-r--r--@  1 dev.temobi  staff   399  6  8 17:04 id_rsa.pub-rw-r--r--   1 dev.temobi  staff  1593  6  8 18:27 known_hosts</code></pre><p>执行命令 </p><pre><code>ssh-keygen -t rsa -C &quot;depthlove@163.com&quot;  </code></pre><p><a href="mailto:depthlove@163.com" target="_blank" rel="noopener">depthlove@163.com</a> 是注册github账号时所用的邮箱</p><p>执行上面的命令后，会出现一些提示，什么都不用管，直接回车，再回车</p><p>继续输入命令</p><pre><code>ssh-agent -s</code></pre><p>结果为</p><pre><code>SSH_AUTH_SOCK=/var/folders/0r/y1__8yjx579743zfttfrflsr0000gq/T//ssh-a9zU09oKAnpw/agent.17852;export SSH_AUTH_SOCK;SSH_AGENT_PID=17853; export SSH_AGENT_PID;echo Agent pid 17853;</code></pre><p>继续输入命令 </p><pre><code>ssh-add ~/.ssh/id_rsa</code></pre><p>结果为</p><pre><code>Identity added: /Users/dev.temobi/.ssh/id_rsa (/Users/dev.temobi/.ssh/id_rsa)</code></pre><p>如果执行ssh-add ~/.ssh/id_rsa 出错，就输入以下指令：</p><pre><code>eval `ssh-agent -s`ssh-add</code></pre><p>现在就成功生成了 SSH keys。</p><h4 id="把SSH-keys添加到github账户中。"><a href="#把SSH-keys添加到github账户中。" class="headerlink" title="把SSH keys添加到github账户中。"></a>把SSH keys添加到github账户中。</h4><p>前往文件夹 ~/.ssh，用文本编辑器打开文件id_rsa.pub，复制其中的内容，然后粘贴到github add SSH keys的文本框中。操作完之后，github会要求输入github的登陆密码，输入完密码就成功添加了 SSH keys。</p><p>若还不放心，还可以通过 ssh -T <a href="mailto:git@github.com" target="_blank" rel="noopener">git@github.com</a> 命令查看SSH keys是否添加成功，继续在终端执行命令</p><pre><code>ssh -T git@github.com</code></pre><p>结果如下</p><pre><code>Are you sure you want to continue connecting (yes/no)?yes // 输入yesWarning: Permanently added the RSA host key for IP address &apos;192.xx.xxx.xxx’ to the list of known hosts.Hi depthlove! You&apos;ve successfully authenticated, but GitHub does not provide shell access.</code></pre><p>到这里准备工作都已做好，现在就是部署了。</p><p>继续在终端执行命令</p><pre><code>hexo generatehexo deploy</code></pre><p>结果出现错误</p><pre><code>ERROR Deployer not found: git</code></pre><p>此时，就要检查为什么出现这种错误了，解决方法是上网百度寻求解决方案，还有一种就是靠自己的经验了。我发现在我修改文件_config.yml的时候发现</p><pre><code># Deployment## Docs: http://hexo.io/docs/deployment.htmldeploy:  type:</code></pre><p>发现有个word文档说明，而且我在执行hexo deploy出错，说明解决方法肯定在word链接中，结果是答案真的就在这里面。</p><p>在浏览器中输入 <a href="http://hexo.io/docs/deployment.html" target="_blank" rel="noopener">http://hexo.io/docs/deployment.html</a></p><p>然后按照网页上的文档说明，继续在终端上执行命令</p><pre><code>npm install hexo-deployer-git --save</code></pre><p>最后在终端上执行命令 </p><pre><code>hexo deploy</code></pre><p>OK，成功了！结果如下</p><pre><code>INFO  Deploying: gitINFO  Setting up Git deployment...初始化空的 Git 版本库于 /Users/dev.temobi/Desktop/sunmmMainPrj/ZZ_HexoBlog/.deploy_git/.git/[master（根提交） e8f14ef] First commit Committer: dev.temobi &lt;dev.temobi@devtemobideMac-mini.local&gt;您的姓名和邮件地址基于登录名和主机名进行了自动设置。请检查它们正确与否。您可以通过下面的命令对其进行明确地设置以免再出现本提示信息：git config --global user.name &quot;Your Name&quot;git config --global user.email you@example.com设置完毕后，您可以用下面的命令来修正本次提交所使用的用户身份：git commit --amend --reset-author………………create mode 100644 index.htmlcreate mode 100644 js/script.jsdelete mode 100644 placeholderUsername for &apos;https://github.com&apos;: depthlove  // 输入自己的github用户名Password for &apos;https://depthlove@github.com&apos;:  // 输入自己的github密码To https://github.com/depthlove/depthlove.github.io.git + f0b2e27...cd56463 master -&gt; master (forced update)分支 master 设置为跟踪来自 https://github.com/depthlove/depthlove.github.io.git 的远程分支 master。INFO  Deploy done: git</code></pre><p>现在，就可以在浏览器中输入 <a href="http://depthlove.github.io">http://depthlove.github.io</a> ，访问我的hexo博客了</p><p><code>注意：每次修改本地文件后，都要在hexo博客所在的目录下，执行命令 hexo generate 保存；想要上传文件到Github时，就应该在hexo博客所在的目录下先执行命令 hexo generate 保存之后，再执行命令 hexo deploy</code></p><h4 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h4><p>hexo现在支持更加简单的命令格式了，比如：</p><p>hexo g == hexo generate</p><p>hexo d == hexo deploy</p><p>hexo s == hexo server</p><p>hexo n == hexo new</p>]]></content>
      
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>笔谈cocoapods的安装与使用</title>
      <link href="/2015/05/11/talk-about-cocoapods-install-and-use/"/>
      <url>/2015/05/11/talk-about-cocoapods-install-and-use/</url>
      
        <content type="html"><![CDATA[<p>　　因为要重构播放器库，所以就需要参考网上的开源项目，在播放器开源项目这块，kxmovie开源项目是值得参考的一个项目。在github下载下来后，运行该工程，发现其用到了cocoapods来管理第三方库，以前我做项目都是将第三方库直接下载然后将源文件导入到工程，这种做法有其好处也存在一定的弊端，好处是便于项目的维护，方便的知道过去使用的第三方库是个什么情况，还可以根据实际需求修改，弊端就是第三方库的更新需要自己下载最新的再将旧的替换（手动更新）。通过cocoapods来管理第三方库，可以获取到最新的第三库将其引用到项目中，而且不需要自己手动去添加该第三方库的依赖库，虽然cocoapods用起来方便，但是也不一定全好，因为项目运行链接第三方库的时候，比如之前自己改过cocoapods引用进来的第三方库，这时就悲剧了，加载的第三方库是重新从网络上获取的，网上一些开发者也提到了，通过cocoapods管理项目中的第三方库不便于项目回滚。所以，是否选择cocoapods要根据实际情况来定。</p><a id="more"></a><p>　　要使用cocoapods，对于之前没有安装过cocoapods的开发者来说，首先就是要在Mac上安装cocoapods，在Mac终端执行命令 <strong>sudo gem install cocoapods</strong>，执行结果如下<br>　　<br><img src="http://images.cnitblog.com/blog2015/499497/201505/111557198605907.png" alt="终端执行结果"></p><p>　　但是没有发现cocoapods源，因为ruby的软件源rubygems.org使用的亚马逊的云服务，被墙了，需要更新一下ruby的源，使用其他能支持的源—-&gt;国内淘宝的源：</p><pre><code>gem sources --remove https://rubygems.org/gem sources -a http://ruby.taobao.org/gem sources -l</code></pre><p>　　执行上面的命令结果如下：</p><p><img src="http://images.cnitblog.com/blog2015/499497/201505/111601220012200.png" alt="淘宝源执行结果"></p><p>　　现在，更新源成功了，可以进行安装了，继续在Mac终端执行命令 <strong>sudo gem install cocoapods</strong>，执行结果如下：</p><p><img src="http://images.cnitblog.com/blog2015/499497/201505/111605066427802.png" alt="终端执行结果"></p><p>………….</p><p>………….</p><p>　　接下来在Mac终端输入以下命令：<strong>pod setup</strong>　　</p><p>注意：This process will likely take a while as this command clones the CocoaPods Specs repository </p><p>into ~/.cocoapods/ on your computer.</p><p><img src="http://images.cnitblog.com/blog2015/499497/201505/111655319395424.png" alt="终端执行结果"></p><p> 　　来看看我们安装的cocoapods的版本信息，在Mac终端上执行命令 <strong>pod –version</strong>，执行结果如下：</p><p><img src="http://images.cnitblog.com/blog2015/499497/201505/111608117677679.png" alt="终端执行结果"></p><p>　　OK，cocoapods安装成功了。</p><p>　　若要卸载cocoapods， 就在Mac终端执行命令 <strong>sudo gem uninstall cocoapods</strong></p><p>　　参考文章：<a href="http://www.devtang.com/blog/2014/05/25/use-cocoapod-to-manage-ios-lib-dependency/" target="_blank" rel="noopener">用CocoaPods做iOS程序的依赖管理</a></p><p>　　　　　　　<a href="http://www.cnblogs.com/cwgk/p/3370949.html" target="_blank" rel="noopener">iOS.CocoaPods.0</a></p><p>　　　　　　  <a href="http://blog.csdn.net/dqjyong/article/details/37958067" target="_blank" rel="noopener">OS X升级到10.10之后使用pod出现问题的解决方法</a></p><p>　　　　　　  <a href="http://blog.csdn.net/feixiang_song/article/details/40392629?utm_source=tuicool" target="_blank" rel="noopener">osx升级到10.10后，用pod install报错最终解决办法</a></p><p>　　cocoapods安装好了，接下来就该用它来做事了。使用CocoaPods管理第三方库的例子如下：</p><p>　　使用Xcode,在工程根目录下，新建立一个空白的Podfile文档，然后在里面添加以下内容</p><pre><code>platform:ios,&apos;6.0&apos;pod &apos;FMDB&apos;, &apos;~&gt; 2.0&apos;pod &apos;AFNetworking&apos;, &apos;~&gt; 1.1.0&apos;pod &apos;JSONKit&apos;,&apos;~&gt;1.4&apos;</code></pre><p> 　  保存，然后配置工程， 在系统终端中，使用cd命令切换到项目根目录下，输入命令： <strong>pod install</strong></p><p>　　执行完之后，CocoaPods在工程目录下创建了一个文件夹“Pods”，该文件夹存放所有依赖的库，另外还创建了一个.xcworkspace文件，配置完之后需使用.xcworkspace文件打开工程。</p><p>　　参考文章：<a href="http://www.cnblogs.com/crazypebble/p/3597419.html" target="_blank" rel="noopener">CocoaPods安装和使用教程</a></p><p>　　　　　　  <a href="http://jishu.zol.com.cn/207731.html" target="_blank" rel="noopener">iOS系列译文：深入理解 CocoaPods</a></p><p>　　对于kxmoive这个工程，它使用cocoapods就引用了一个库，对于我而言，就因为引用一个库反复折腾cocoapods，肯定不爽，浪费时间。所以，我就想删掉kxmoive工程中cocoapods的所有相关东西。但是，删除cocoapods后，出现了如下错误：</p><p>　　<strong>diff: /../Podfile.lock: No such file or directory diff: /Manifest.lock: No such file or directory error: The sandbox is not in sync with the Podfile.lock. Run ‘pod install’ or update your CocoaPods installation.</strong></p><p>　　我参考文章 <a href="http://blog.csdn.net/freedom2028/article/details/10244819" target="_blank" rel="noopener">从工程中删除Cocoapods</a> ，顺利解决了这个问题。对于上面的这个报错，当工程中有使用cocoapods的时候，运行项目也可能会出现这个问题，那就按照报错提示，重新更新pod，即在Mac终端执行pod install，参考文章 <a href="http://www.cnblogs.com/ios-wmm/p/3360958.html" target="_blank" rel="noopener">Xcode工程使用CocoaPods管理第三方库新建工程时出现错误</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> iOS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>笔谈FFmpeg（二）</title>
      <link href="/2015/04/28/talk-about-FFmpeg-part2/"/>
      <url>/2015/04/28/talk-about-FFmpeg-part2/</url>
      
        <content type="html"><![CDATA[<p>　　经过前面的学习对FFmpeg的基本流程已经很熟悉了，现在到了掌握其中细节的时候了，用FFmpeg做播放器解码操作中，涉及到了一些结构体，这些结构之间到底有什么关系，它们是怎样协同工作的呢。文章 FFMPEG中最关键的结构体之间的关系 对这些结构间的关系进行了分析，详细内容如下：</p><p>　　FFMPEG中结构体很多。最关键的结构体可以分成以下几类：<br>　　<br><a id="more"></a></p><h4 id="a-解协议（http-rtsp-rtmp-mms）"><a href="#a-解协议（http-rtsp-rtmp-mms）" class="headerlink" title="a) 解协议（http,rtsp,rtmp,mms）"></a>a) 解协议（http,rtsp,rtmp,mms）</h4><p>AVIOContext，URLProtocol，URLContext主要存储视音频使用的协议的类型以及状态。URLProtocol存储输入视音频使用的封装格式。每种协议都对应一个URLProtocol结构。（注意：FFMPEG中文件也被当做一种协议“file”）</p><h4 id="b-解封装（flv-avi-rmvb-mp4）"><a href="#b-解封装（flv-avi-rmvb-mp4）" class="headerlink" title="b) 解封装（flv,avi,rmvb,mp4）"></a>b) 解封装（flv,avi,rmvb,mp4）</h4><p>AVFormatContext主要存储视音频封装格式中包含的信息；AVInputFormat存储输入视音频使用的封装格式。每种视音频封装格式都对应一个AVInputFormat 结构。</p><h4 id="c-解码（h264-mpeg2-aac-mp3）"><a href="#c-解码（h264-mpeg2-aac-mp3）" class="headerlink" title="c) 解码（h264,mpeg2,aac,mp3）"></a>c) 解码（h264,mpeg2,aac,mp3）</h4><p>每个AVStream存储一个视频/音频流的相关数据；每个AVStream对应一个AVCodecContext，存储该视频/音频流使用解码方式的相关数据；每个AVCodecContext中对应一个AVCodec，包含该视频/音频对应的解码器。每种解码器都对应一个AVCodec结构。</p><h4 id="d-存数据"><a href="#d-存数据" class="headerlink" title="d)存数据"></a>d)存数据</h4><p>视频的话，每个结构一般是存一帧；音频可能有好几帧</p><p>解码前数据：AVPacket</p><p>解码后数据：AVFrame</p><p>　　他们之间的对应关系如下所示：</p><p><img src="http://img.blog.csdn.net/20130914204051125?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGVpeGlhb2h1YTEwMjA=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="流程图"></p><p>　　上面提到的这些结构到底是干嘛用的，中国传媒大学的一个博士写了一系列的结构体的分析的文章，在这里列一个列表，需要好好看下：</p><h5 id="FFMPEG结构体分析：AVFrame"><a href="#FFMPEG结构体分析：AVFrame" class="headerlink" title="FFMPEG结构体分析：AVFrame"></a><a href="http://blog.csdn.net/leixiaohua1020/article/details/14214577" target="_blank" rel="noopener">FFMPEG结构体分析：AVFrame</a></h5><h5 id="FFMPEG结构体分析：AVFormatContext"><a href="#FFMPEG结构体分析：AVFormatContext" class="headerlink" title="FFMPEG结构体分析：AVFormatContext"></a><a href="http://blog.csdn.net/leixiaohua1020/article/details/14214705" target="_blank" rel="noopener">FFMPEG结构体分析：AVFormatContext</a></h5><h5 id="FFMPEG结构体分析：AVCodecContext"><a href="#FFMPEG结构体分析：AVCodecContext" class="headerlink" title="FFMPEG结构体分析：AVCodecContext"></a><a href="http://blog.csdn.net/leixiaohua1020/article/details/14214859" target="_blank" rel="noopener">FFMPEG结构体分析：AVCodecContext</a></h5><h5 id="FFMPEG结构体分析：AVIOContext"><a href="#FFMPEG结构体分析：AVIOContext" class="headerlink" title="FFMPEG结构体分析：AVIOContext"></a><a href="http://blog.csdn.net/leixiaohua1020/article/details/14215369" target="_blank" rel="noopener">FFMPEG结构体分析：AVIOContext</a></h5><h5 id="FFMPEG结构体分析：AVCodec"><a href="#FFMPEG结构体分析：AVCodec" class="headerlink" title="FFMPEG结构体分析：AVCodec"></a><a href="http://blog.csdn.net/leixiaohua1020/article/details/14215833" target="_blank" rel="noopener">FFMPEG结构体分析：AVCodec</a></h5><h5 id="FFMPEG结构体分析：AVStream"><a href="#FFMPEG结构体分析：AVStream" class="headerlink" title="FFMPEG结构体分析：AVStream"></a><a href="http://blog.csdn.net/leixiaohua1020/article/details/14215821" target="_blank" rel="noopener">FFMPEG结构体分析：AVStream</a></h5><h5 id="FFMPEG结构体分析：AVPacket"><a href="#FFMPEG结构体分析：AVPacket" class="headerlink" title="FFMPEG结构体分析：AVPacket"></a><a href="http://blog.csdn.net/leixiaohua1020/article/details/14215755" target="_blank" rel="noopener">FFMPEG结构体分析：AVPacket</a></h5>]]></content>
      
      
      
        <tags>
            
            <tag> 音视频处理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>笔谈FFmpeg（一）</title>
      <link href="/2015/04/27/talk-about-FFmpeg-part1/"/>
      <url>/2015/04/27/talk-about-FFmpeg-part1/</url>
      
        <content type="html"><![CDATA[<p>　　现在的工作是播放器库的开发，可不是调用iOS系统自带的播放器框架进行一些简单的功能和界面定制，这些没什么含量。涉及iOS开发有3个年头了，现在的工作算是有点含金量了。涉及播放器的开发，FFmpeg的架构和功能是必须清楚的。FFmpeg自带的三个工程：ffplay， ffmpeg， ffprobe。这三个工程的代码量太大，如何切入进去，一窥其中的奥秘为自己所用呢？从核心切入，编码和解码。编码和解码的核心API接口就那十几个，通过这些深入然后剖析源代码，目标就明确了。</p><p>　　就我个人而言，首先要了解FFmpeg整个的运行机制，哪一部分工作需要调用FFmpeg的哪一块，这个必须清楚。播放器库的开发，解码播放这就是核心，我就需要从FFmpeg的解码流程入手了。FFmpeg源代码结构图 - 解码 这篇文章太好了，看得我两眼放光，精华。这篇文章读透了，完全可以把控FFmpeg的使用。我接下来的学习任务，那就是认真研读和敲代码研习，光看是不顶用的，需要动手写。<br>　　<br><a id="more"></a></p><p>　　<a href="http://blog.csdn.net/leixiaohua1020/article/details/44220151" target="_blank" rel="noopener">FFmpeg源代码结构图 - 解码</a>中包含的信息太多了，对于在音视频领域中的初学者来说，首先要看<a href="http://blog.csdn.net/leixiaohua1020/article/details/44220151" target="_blank" rel="noopener">FFmpeg源代码结构图 - 解码</a> 中提到的<a href="http://blog.csdn.net/leixiaohua1020/article/details/38868499" target="_blank" rel="noopener">简单的基于FFMPEG+SDL的视频播放器 ver2 （采用SDL2.0）</a>入手。心急吃不了热豆腐，心急就不能静下心来搞懂深层次的问题。FFmpeg的解码过程调用的API依次为：</p><p>　　　　　　　　　　　　　　　　　　开始—-&gt;</p><p>　　　　　　　　　　　　　　　　　　av_register_all();</p><p>　　　　　　　　　　　　　　　　　　avformat_open_input()；</p><p>　　　　　　　　　　　　　　　　　　av_find_stream_info();</p><p>　　　　　　　　　　　　　　　　　　avcodec_find_decoder();</p><p>　　　　　　　　　　　　　　　　　　av_read_frame();</p><p>　　　　　　　　　　　　　　　　　　获取到packet—-&gt;</p><p>　　　　　　　　　　　　　　　　　　avcodec_decode_video2();</p><p>　　对于FFmpeg的解码流程，先知道了有上面那些方法，但是这些方法是用来做什么，从方法名上能看出其功能，要深入的理解才行。借鉴别人的经验，收集有效的资源是非常重要的。对FFmpeg解码流程讲解的比较好的一篇博文是 <a href="http://www.cnblogs.com/moonvan/archive/2011/10/22/2221263.html" target="_blank" rel="noopener">FFMpeg的解码流程</a> ，配合文章  <a href="http://blog.csdn.net/ownwell/article/details/8113980" target="_blank" rel="noopener">ffmpeg解码流程</a> 一起服下，效果更好。因为当当看 <a href="http://blog.csdn.net/leixiaohua1020/article/details/38868499" target="_blank" rel="noopener">简单的基于FFMPEG+SDL的视频播放器 ver2 （采用SDL2.0）</a> 还不足以搞透整个流程。通过研习这三篇文章，整个流程和方法功能应该就吃透了。</p><p>　　学习任何东西什么时候该从局部把控全局，那就是有了自己的切入点之后，在这个点上摸爬滚打搞得比较熟练之后，就需要把控全局，对FFmpeg框架的整体要有把控。对于FFmpeg框架讲解的比较好的入门读物是 <a href="http://blog.csdn.net/wstarx/article/details/1572393" target="_blank" rel="noopener">FFMpeg框架代码阅读</a> 。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 音视频处理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>谈一谈做iOS播放器库开发所涉及的知识点</title>
      <link href="/2015/04/22/talk-about-knowledge-points-of-developing-iOS-player/"/>
      <url>/2015/04/22/talk-about-knowledge-points-of-developing-iOS-player/</url>
      
        <content type="html"><![CDATA[<p>　　在自己研究生毕业的时候，想着能找上一份做视频编解码的工作，可惜没有如愿，最后到了一家iOS游戏渠道公司去做游戏支付业务的SDK开发，我的iOS正式开发生涯就这么开始了。</p><p>　　在那家iOS游戏渠道没做上一年，就离职了，至于怎么离职的，后续文章会谈一谈，以此来梳理下自己的职业规划。说了这多了，进入正题吧，今年3月份找上了一家做音视频服务的公司，做iOS播放器的开发，职位是播放器开发工程师，就是我现在所在的公司咯。</p><p>　　要开发一套属于自己的播放器库，不利用移动设备上自带的播放器来播放音频、视频，要用到哪些知识点呢，下面以我熟悉公司播放器库的前提下，说一说我的看法。</p><a id="more"></a><p>　　任何客户端只要跟服务器打交道，少不了通讯协议。音视频这块涉及的实时流相关协议很多，有RTSP、RTMP、MMS、HLS、RTP、RTCP、SDP、TCP、UDP、HTTP等。</p><p>　　客户端从服务器上获取到的音视频数据，要知道容器与编码方式的区别，封装音视频数据的容器类型主要有AVI(.avi), MPG(.mpg/.mpeg/.dat), VOB(.vob), MP4, 3GP, ASF(.wmv/.asf), RM(.rm/.rmvb), MOV(.mov), MKV, WAV, TS。</p><p>　　客户端从服务器上获取到了音视频数据，该如何进行解码显示，首先要知道音频、视频的的编码方式，客户端要显示音视频数据需要根据编码的方式进行相应的解码操作，目前常见的编码类型有MPEG系列、H.26X系列、微软windows media系列、Real Media系列、QuickTime系列。</p><p>　　上面说到了一些流媒体协议、流媒体数据的封装类型以及编码方式。而我们要做一款播放器首先是要对以上知识要了解的。</p><p>　　公司的业务涉及最多的是rtsp这块。服务器端为rtsp流媒体服务器，客户端也就是播放器库采用FFMpeg进行解码、OPenGL ES进行YUV视频数据渲染。</p><p>　　播放器库与服务器端进行交互，涉及到RTSP协议的请求，传输层协议采用的TCP、UDP协议，所以要对TCP连接的三次握手要熟悉，这其中也就涉及到网络编程中的SOCKET编程知识了，BSD socket编程是需要掌握的。</p><p>　　播放器库对从服务器上请求到的音频、视频rtp包，要进行解包，就是去掉一些协议的头获取到音视频数据段。获取到这些数据后，不能直接播放，需要进行解码操作。视频解码出来一般为Planar 4:2:0 YUV格式。要显示YUV视频图像就需要利用OPenGL ES进行渲染了。</p><p>　　播放器在工作时，视频数据要进行解码放入数据缓存区，数据缓存区的解码后的数据被取出交给OpenGL进行渲染，所以多线程是必不可少的环节了。开辟2个线程，一个线程进行解码处理，另一个线程进行视频数据的渲染。多线程中常使用的是POSIX thread多线程编程。</p><p>　　虽然开发的iOS播放器库，但是底层的东西大部分是c语言的东西，比如用到开源库FFMpeg，以及一些上层的对FFMpeg的封装，数据缓存区，所以c语言和数据结构的基础要扎实，什么函数指针，内存分配与管理，数据结构中的单链表那得玩得比较溜。</p><p>　　总结一下，需要具备的知识有</p><ul><li><p>rtsp、sdp、tcp、udp、ip协议（rtsp的DESCRIBE、OPTION、SETUP、PLAY、PAUSE、TEARDOWN；tcp连接的三次握手／断开的四次握手）</p></li><li><p>socket（bsd socket）</p></li><li><p>多线程（posix thread）</p></li><li><p>opengl es</p></li><li><p>FFmpeg（知道用它来解码）</p></li><li><p>YUV420（知道它的原理与格式）</p></li><li><p>音视频同步（时间戳的处理）</p></li><li><p>C语言指针（void *、函数指针、回调函数）</p></li><li><p>内存管理（堆区、栈区、静态区、内存对齐）</p></li><li><p>数据结构（单链表）</p></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> 音视频处理 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
